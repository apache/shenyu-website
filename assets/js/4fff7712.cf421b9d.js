"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[43374],{23342(e,n,i){i.r(n),i.d(n,{assets:()=>t,contentTitle:()=>d,default:()=>a,frontMatter:()=>r,metadata:()=>s,toc:()=>h});const s=JSON.parse('{"id":"plugin-center/cache/cache-plugin","title":"Cache Plugin","description":"Cache Plugin","source":"@site/versioned_docs/version-2.7.0/plugin-center/cache/cache-plugin.md","sourceDirName":"plugin-center/cache","slug":"/plugin-center/cache/cache-plugin","permalink":"/docs/2.7.0/plugin-center/cache/cache-plugin","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.7.0/plugin-center/cache/cache-plugin.md","tags":[],"version":"2.7.0","frontMatter":{"title":"Cache Plugin","keywords":["Cache"],"description":"Cache Plugin"},"sidebar":"tutorialSidebar","previous":{"title":"GeneralContext Plugin","permalink":"/docs/2.7.0/plugin-center/common/general-context-plugin"},"next":{"title":"Mock Plugin","permalink":"/docs/2.7.0/plugin-center/mock/mock-plugin"}}');var c=i(74848),l=i(28453);const r={title:"Cache Plugin",keywords:["Cache"],description:"Cache Plugin"},d="1. Overview",t={},h=[{value:"1.1 Plugin Name",id:"11-plugin-name",level:2},{value:"1.2 Appropriate Scenario",id:"12-appropriate-scenario",level:2},{value:"1.3 Plugin functionality",id:"13-plugin-functionality",level:2},{value:"1.4 Plugin code",id:"14-plugin-code",level:2},{value:"1.5 Added Since Which shenyu version",id:"15-added-since-which-shenyu-version",level:2},{value:"2.1 Plugin-use procedure chart",id:"21-plugin-use-procedure-chart",level:2},{value:"2.2 Import pom",id:"22-import-pom",level:2},{value:"2.3 Enable plugin",id:"23-enable-plugin",level:2},{value:"2.4 Config plugin",id:"24-config-plugin",level:2},{value:"2.4.1 Plugin Config",id:"241-plugin-config",level:3},{value:"2.4.2 Selector Config",id:"242-selector-config",level:3},{value:"2.4.3 Rule Config",id:"243-rule-config",level:3},{value:"2.5 Examples",id:"25-examples",level:2},{value:"2.5.1 Use redis cache request result",id:"251-use-redis-cache-request-result",level:3},{value:"2.5.1.1 Plugin Config",id:"2511-plugin-config",level:4},{value:"2.5.1.2 Selector Config",id:"2512-selector-config",level:4},{value:"2.5.1.3 Rule Config",id:"2513-rule-config",level:4},{value:"2.5.1.4 Send Request",id:"2514-send-request",level:4},{value:"2.5.1.5 Check Result",id:"2515-check-result",level:4}];function o(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"1-overview",children:"1. Overview"})}),"\n",(0,c.jsx)(n.h2,{id:"11-plugin-name",children:"1.1 Plugin Name"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Cache Plugin"}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"12-appropriate-scenario",children:"1.2 Appropriate Scenario"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"Situation where data is not updated frequently and a large number of calls are required."}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"For Situation where data consistency is not required."}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"13-plugin-functionality",children:"1.3 Plugin functionality"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["The ",(0,c.jsx)(n.code,{children:"Cache"})," plugin is able to cache the results of the target service, allowing the user to configure the expiration\ntime of the cached results."]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"14-plugin-code",children:"1.4 Plugin code"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Core Module ",(0,c.jsx)(n.code,{children:"shenyu-plugin-cache-handler"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Core Module ",(0,c.jsx)(n.code,{children:"shenyu-plugin-cache-redis"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Core Module ",(0,c.jsx)(n.code,{children:"shenyu-plugin-cache-memory"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Core Class ",(0,c.jsx)(n.code,{children:"org.apache.shenyu.plugin.cache.CachePlugin"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Core Class ",(0,c.jsx)(n.code,{children:"org.apache.shenyu.plugin.cache.redis.RedisCache"})]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:["Core Class ",(0,c.jsx)(n.code,{children:"org.apache.shenyu.plugin.cache.memory.MemoryCache"})]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"15-added-since-which-shenyu-version",children:"1.5 Added Since Which shenyu version"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Since 2.4.3"}),"\n"]}),"\n",(0,c.jsx)(n.h1,{id:"2-how-to-use-plugin",children:"2. How to use plugin"}),"\n",(0,c.jsx)(n.h2,{id:"21-plugin-use-procedure-chart",children:"2.1 Plugin-use procedure chart"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(36867).A+"",width:"343",height:"964"})}),"\n",(0,c.jsx)(n.h2,{id:"22-import-pom",children:"2.2 Import pom"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Import cache plugin dependency in ",(0,c.jsx)(n.code,{children:"ShenYu Bootstrap"}),"."]}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-xml",children:"\x3c!--shenyu cache plugin start--\x3e\n<dependency>\n  <groupId>org.apache.shenyu</groupId>\n  <artifactId>shenyu-spring-boot-starter-plugin-cache</artifactId>\n  <version>${project.version}</version>\n</dependency>\n\x3c!--shenyu cache plugin end--\x3e\n"})}),"\n",(0,c.jsx)(n.h2,{id:"23-enable-plugin",children:"2.3 Enable plugin"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["In shenyu-admin --\x3e BasicConfig --\x3e Plugin --\x3e ",(0,c.jsx)(n.code,{children:"cache"})," set Status enabled."]}),"\n"]}),"\n",(0,c.jsx)(n.h2,{id:"24-config-plugin",children:"2.4 Config plugin"}),"\n",(0,c.jsx)(n.h3,{id:"241-plugin-config",children:"2.4.1 Plugin Config"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(85750).A+"",width:"2256",height:"1279"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"cacheType"}),": Cache currently supports two modes of caching data."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"memory\uff1alocal memory mode"}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsx)(n.p,{children:"redis\uff1aredis mode"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:["The current default is ",(0,c.jsx)(n.code,{children:"local memory mode"}),", the results of the target service are stored in the local memory, if the\ngateway is deployed by way of cluster, it is not recommended to use ",(0,c.jsx)(n.code,{children:"local memory mode"}),", it is recommended to\nuse ",(0,c.jsx)(n.code,{children:"redis mode"}),", the data of the target service are cached in redis."]}),"\n",(0,c.jsxs)(n.p,{children:["If you are using ",(0,c.jsx)(n.code,{children:"local memory mode"}),", you only need to select memory in cacheType, no other configuration is needed."]}),"\n",(0,c.jsxs)(n.p,{children:["If you are using ",(0,c.jsx)(n.code,{children:"redis mode"}),", select redis in cacheType, and the parameters are as follows"]}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"database"}),": which database the cache results are stored in, the default is index database 0."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"master"}),": default is master."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"mode"}),": the working mode of redis, the default is single-point mode: ",(0,c.jsx)(n.code,{children:"standalone"}),", in addition to cluster\nmode: ",(0,c.jsx)(n.code,{children:"cluster"}),", sentinel mode: ",(0,c.jsx)(n.code,{children:"sentinel"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"url"}),": configure the IP and port of the redis database, configured by colon connection, example: ",(0,c.jsx)(n.code,{children:"192.168.1.1:6379"}),"."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"password"}),": the password of the redis database, if not, you can not configure."]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"maxldle"}),": the maximum free connections in the connection pool"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"minldle"}),": minimum idle connections in the connection pool"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"maxActive"}),": the maximum number of connections in the connection pool"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"maxWait"}),": the maximum blocking wait time for the connection pool (use negative values to indicate no limit) default -1"]}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"242-selector-config",children:"2.4.2 Selector Config"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["Selectors and rules, please refer to: ",(0,c.jsx)(n.a,{href:"../../user-guide/admin-usage/selector-and-rule",children:"Selector And Rule Config"})," ."]}),"\n"]}),"\n",(0,c.jsx)(n.h3,{id:"243-rule-config",children:"2.4.3 Rule Config"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(80122).A+"",width:"992",height:"552"})}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Only matching requests will be cached by the Cache plugin for the results of the target service."}),"\n"]}),"\n",(0,c.jsxs)(n.p,{children:[(0,c.jsx)(n.code,{children:"timeoutSecods"}),": the value is the target service result data cache time, the default is 60, in ",(0,c.jsx)(n.code,{children:"seconds"}),"."]}),"\n",(0,c.jsx)(n.p,{children:"Notice: The current version of the Cache plugin uses the url as a unique key to identify the same request."}),"\n",(0,c.jsx)(n.h2,{id:"25-examples",children:"2.5 Examples"}),"\n",(0,c.jsx)(n.h3,{id:"251-use-redis-cache-request-result",children:"2.5.1 Use redis cache request result"}),"\n",(0,c.jsx)(n.h4,{id:"2511-plugin-config",children:"2.5.1.1 Plugin Config"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(56965).A+"",width:"2256",height:"1279"})}),"\n",(0,c.jsx)(n.p,{children:"select redis cache type, config redis database, url, mode, password"}),"\n",(0,c.jsx)(n.h4,{id:"2512-selector-config",children:"2.5.1.2 Selector Config"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(74141).A+"",width:"2256",height:"1279"})}),"\n",(0,c.jsx)(n.h4,{id:"2513-rule-config",children:"2.5.1.3 Rule Config"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(80122).A+"",width:"992",height:"552"})}),"\n",(0,c.jsx)(n.h4,{id:"2514-send-request",children:"2.5.1.4 Send Request"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"send http request to cache result."}),"\n"]}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-http",metastring:'title="request"',children:"### shengyu getway proxy orderSave\nGET http://localhost:9195/http/order/findById?id=123\nAccept: application/json\nContent-Type: application/json\n"})}),"\n",(0,c.jsx)(n.h4,{id:"2515-check-result",children:"2.5.1.5 Check Result"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(25817).A+"",width:"1624",height:"568"})}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.img,{src:i(67085).A+"",width:"2161",height:"508"})}),"\n",(0,c.jsx)(n.h1,{id:"3-how-to-disable-plugin",children:"3. How to disable plugin"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:["In ",(0,c.jsx)(n.code,{children:"shenyu-admin"})," --\x3e BasicConfig --\x3e Plugin --\x3e ",(0,c.jsx)(n.code,{children:"cache"})," set Status disable."]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(o,{...e})}):o(e)}},25817(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/cache-result-6cf64e74954ad4fb3bbd1f0bae2cfc9b.jpg"},28453(e,n,i){i.d(n,{R:()=>r,x:()=>d});var s=i(96540);const c={},l=s.createContext(c);function r(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:r(e.components),s.createElement(l.Provider,{value:n},e.children)}},36867(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/plugin_use_en-8b5661551cdf92fdabc9cb2e7947cffc.jpg"},56965(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/cache-plugin-config-example-en-51e820d0cd6ca19fb8ebea5ee045352d.png"},67085(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/cache-result-check-0070758c84d5ab1ba0d88d4bab73fe92.png"},74141(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/cache-plugin-selector-en-a4d58981c816f3776646f74865ae102c.png"},80122(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/cache-plugin-rule-en-f87256d214b81b378f155e1cf02b6fdf.png"},85750(e,n,i){i.d(n,{A:()=>s});const s=i.p+"assets/images/cache-plugin-config-en-a94429e8eb8d41ab800b4cf63f83ebd6.png"}}]);