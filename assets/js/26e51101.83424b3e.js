"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[60398],{20143:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>u,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var t=s(74848),i=s(28453);const r={sidebar_position:6,title:"Use Different Data-Sync Strategy",keywords:["soul"],description:"use different data-sync strategy"},l=void 0,c={id:"users-guide/use-data-sync",title:"Use Different Data-Sync Strategy",description:"use different data-sync strategy",source:"@site/versioned_docs/version-2.3.0-Legacy/users-guide/use-data-sync.md",sourceDirName:"users-guide",slug:"/users-guide/use-data-sync",permalink:"/docs/2.3.0-Legacy/users-guide/use-data-sync",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.3.0-Legacy/users-guide/use-data-sync.md",tags:[],version:"2.3.0-Legacy",sidebarPosition:6,frontMatter:{sidebar_position:6,title:"Use Different Data-Sync Strategy",keywords:["soul"],description:"use different data-sync strategy"},sidebar:"tutorialSidebar",previous:{title:"Sofa RPC Proxy",permalink:"/docs/2.3.0-Legacy/users-guide/sofa-rpc-proxy"},next:{title:"Register Center Access",permalink:"/docs/2.3.0-Legacy/register-center/register-center-access"}},a={},o=[{value:"Features",id:"features",level:2},{value:"Websocket sync\uff08default method\uff0crecommend\uff09",id:"websocket-syncdefault-methodrecommend",level:2},{value:"Zookeeper Sync",id:"zookeeper-sync",level:2},{value:"Http long-polling sync",id:"http-long-polling-sync",level:2},{value:"Nacos sync",id:"nacos-sync",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Data synchronization is the key of gateway high performance, which is to sync 'soul-admin' config data into the JVM memory of soul cluster."}),"\n",(0,t.jsxs)(n.li,{children:["Implementation principles, pls refer to\uff1a",(0,t.jsx)(n.a,{href:"../design/data-sync",children:"dataSync"}),"\u3002"]}),"\n",(0,t.jsxs)(n.li,{children:["In the article, the gateway is the environment you setup. please refer to\uff1a",(0,t.jsx)(n.a,{href:"../users-guide/soul-set-up",children:"Environment Setup"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"websocket-syncdefault-methodrecommend",children:"Websocket sync\uff08default method\uff0crecommend\uff09"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["gateway setting\uff08note",":restart","\uff09"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add these dependencies in ",(0,t.jsx)(n.code,{children:"pom.xml"}),"\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"\x3c!--soul data sync start use websocket--\x3e\n<dependency>\n  <groupId>org.dromara</groupId>\n  <artifactId>soul-spring-boot-starter-sync-data-websocket</artifactId>\n  <version>${last.version}</version>\n</dependency>\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"add these config values in springboot yaml file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"soul :\n  sync:\n      websocket :\n        # urls: address of soul-admin\uff0cmulti-address will be splitted with (,).\n        urls: ws://localhost:9095/websocket\n        allowOrigin: ws://localhost:9195\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["soul-admin config, enable this parameter ",(0,t.jsx)(n.code,{children:"--soul.sync.websocket=''"})," in soul admin, then restart service."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"soul:\n  sync:\n     websocket:\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"When the connection is established, getting the full data once,then adding and upating data subsequently, which is a good performance."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Support disconnection and reconnection (default 30 sec)."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"zookeeper-sync",children:"Zookeeper Sync"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"gateway setting\uff08note: restart\uff09"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add these dependencies in ",(0,t.jsx)(n.code,{children:"pom.xml"}),":"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"\x3c!--soul data sync start use zookeeper--\x3e\n  <dependency>\n       <groupId>org.dromara</groupId>\n        <artifactId>soul-spring-boot-starter-sync-data-zookeeper</artifactId>\n        <version>${last.version}</version>\n  </dependency>\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"Add these dependencies in  springboot yaml file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"soul :\n  sync:\n      zookeeper:\n           url: localhost:2181\n           sessionTimeout: 5000\n           connectionTimeout: 2000\n#url: config with your zk address, used by the cluster environment, splitted with (,).\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["soul-admin config: configure the soul-admin's starting parameter with ",(0,t.jsx)(n.code,{children:"--soul.sync.zookeeper.url='your address'"}),",then restart the service."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"soul:\n  sync:\n    zookeeper:\n        url: localhost:2181\n        sessionTimeout: 5000\n        connectionTimeout: 2000\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"It is  good to use ZooKeeper synchronization mechanism with high timeliness, but we also have to deal with the unstable environment of ZK, cluster brain splitting and other\nproblems."}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"http-long-polling-sync",children:"Http long-polling sync"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["gateway setting\uff08note",":restart","\uff09"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add these dependencies in ",(0,t.jsx)(n.code,{children:"pom.xml"}),"\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"\x3c!--soul data sync start use http--\x3e\n  <dependency>\n       <groupId>org.dromara</groupId>\n        <artifactId>soul-spring-boot-starter-sync-data-http</artifactId>\n        <version>${last.version}</version>\n  </dependency>\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"add these config values in your springboot yaml file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"soul :\n    sync:\n        http:\n             url: http://localhost:9095\n#url: config with your soul-admin's ip and port url, pls use (,) to split multi-admin cluster environment.\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["soul-admin config, configure the soul-admin's starting parameter with ",(0,t.jsx)(n.code,{children:"--soul.sync.http=''"}),", then restart service."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"soul:\n  sync:\n     http:\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"HTTP long-polling makes the gateway lightweight, but less time-sensitive."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"It pulls according to the group key, if the data is too large, it will have some influences, a small change under a group will pull the entire group."}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"it may hit bug in soul-admin cluster."}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"nacos-sync",children:"Nacos sync"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["gateway setting\uff08note",":restart","\uff09"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Add these dependencies in your ",(0,t.jsx)(n.code,{children:"pom.xml"}),"\uff1a"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"\x3c!--soul data sync start use nacos--\x3e\n  <dependency>\n       <groupId>org.dromara</groupId>\n        <artifactId>soul-spring-boot-starter-sync-data-nacos</artifactId>\n        <version>${last.version}</version>\n  </dependency>\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"add these config values in the springboot yaml file:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:" soul :\n     sync:\n        nacos:\n             url: localhost:8848\n             namespace: 1c10d748-af86-43b9-8265-75f487d20c6c\n             acm:\n               enabled: false\n               endpoint: acm.aliyun.com\n               namespace:\n               accessKey:\n               secretKey:\n # url: config with your nacos address, pls use (,) to split your cluster environment.\n # other configure\uff0cpls refer to the naocs website.\n"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"soul-admin config: passing values one by one with '--' operator in the soul-Admin startup parameter."}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"soul :\n      sync:\n         nacos:\n              url: localhost:8848\n              namespace: 1c10d748-af86-43b9-8265-75f487d20c6c\n              acm:\n                enabled: false\n                endpoint: acm.aliyun.com\n                namespace:\n                accessKey:\n                secretKey:\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(d,{...e})}):d(e)}},28453:(e,n,s)=>{s.d(n,{R:()=>l,x:()=>c});var t=s(96540);const i={},r=t.createContext(i);function l(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);