"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[48528],{3942:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>l,contentTitle:()=>i,default:()=>u,frontMatter:()=>a,metadata:()=>c,toc:()=>o});var r=n(74848),s=n(28453);const a={description:"Etcd",title:"Etcd Example"},i=void 0,c={id:"etcd",title:"Etcd Example",description:"Etcd",source:"@site/shenyuClientGolang/etcd.md",sourceDirName:".",slug:"/etcd",permalink:"/shenyuClientGolang/next/etcd",draft:!1,unlisted:!1,tags:[],version:"current",lastUpdatedBy:"aias00",lastUpdatedAt:1765189310,formattedLastUpdatedAt:"Dec 8, 2025",frontMatter:{description:"Etcd",title:"Etcd Example"},sidebar:"community",previous:{title:"Consul Example",permalink:"/shenyuClientGolang/next/consul"},next:{title:"Http Example",permalink:"/shenyuClientGolang/next/http"}},l={},o=[{value:"The Etcd type Register",id:"the-etcd-type-register",level:2},{value:"Entire Success log",id:"entire-success-log",level:2}];function d(e){const t={code:"code",h2:"h2",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.h2,{id:"the-etcd-type-register",children:"The Etcd type Register"}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"1.Fist make sure your Etcd env is correct,the set this necessary param."})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'    //Create ShenYuEtcdClient  start\n    ecp := &etcd_client.EtcdClientParam{\n    EtcdServers: []string{"http://127.0.0.1:2379"}, // require user provider\n    UserName : "" // optional param etcd userName\n    Password : "" // optional param etcd pwd\n    TTL:    50, // optional param key live\n    }\n    \n    sdkClient := shenyu_sdk_client.GetFactoryClient(constants.ETCD_CLIENT)\n    client, createResult, err := sdkClient.NewClient(ecp)\n    if !createResult && err != nil {\n    logger.Fatal("Create ShenYuEtcdClient error : %v", err)\n    }\n    \n    etcd := client.(*etcd_client.ShenYuEtcdClient)\n    defer etcd.Close()  \n    //Create ShenYuEtcdClient end\n'})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"2. Prepare your service metaData to register"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'//metaData is necessary param, this will be register to shenyu gateway to use\n    metaData1 := &model.MetaDataRegister{\n        AppName: "testMetaDataRegister1", //require user provide\n        Path:    "your/path1",            //require user provide\n        Enabled: true,                    //require user provide\n        Host:    "127.0.0.1",             //require user provide\n        Port:    "8080",                  //require user provide\n    }\n\n    metaData2 := &model.MetaDataRegister{\n        AppName: "testMetaDataRegister2", //require user provide\n        Path:    "your/path2",            //require user provide\n        Enabled: true,                    //require user provide\n        Host:    "127.0.0.1",             //require user provide\n        Port:    "8181",                  //require user provide\n    }\n'})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"3.use client to invoke RegisterServiceInstance"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'   //register multiple metaData\n    registerResult1, err := etcd.RegisterServiceInstance(metaData1)\n        if !registerResult1 && err != nil {\n        logger.Fatal("Register etcd Instance error : %v", err)\n    }\n\n    registerResult2, err := etcd.RegisterServiceInstance(metaData2)\n        if !registerResult2 && err != nil {\n        logger.Fatal("Register etcd Instance error : %v", err)\n    }\n    //do your logic\n'})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"4.use client to invoke DeregisterServiceInstance"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:"    //your can chose to invoke,not require\n    deRegisterResult1, err := etcd.DeregisterServiceInstance(metaData1)\n        if err != nil {\n        panic(err)\n        }\n\n    deRegisterResult2, err := etcd.DeregisterServiceInstance(metaData2)\n        if err != nil {\n        panic(err)\n        }\n"})}),"\n",(0,r.jsx)(t.p,{children:(0,r.jsx)(t.strong,{children:"5.use client to GetServiceInstanceInfo"})}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'    //GetServiceInstanceInfo start\n    instanceDetail, err := etcd.GetServiceInstanceInfo(metaData1)\n        nodes1, ok := instanceDetail.([]*model.MetaDataRegister)\n        if !ok {\n        logger.Fatal("get etcd client metaData error %v:", err)\n     }\n    \n    //range nodes\n    for index, node := range nodes1 {\n        nodeJson, err := json.Marshal(node)\n        if err == nil {\n        logger.Info("GetNodesInfo ,success Index", index, string(nodeJson))\n        }\n    }\n    \n    instanceDetail2, err := etcd.GetServiceInstanceInfo(metaData2)\n        nodes2, ok := instanceDetail2.([]*model.MetaDataRegister)\n        if !ok {\n            logger.Fatal("get etcd client metaData error %v:", err)\n    }\n    //GetServiceInstanceInfo end\n\n'})}),"\n",(0,r.jsx)(t.h2,{id:"entire-success-log",children:"Entire Success log"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-go",children:'2022-08-16 10:18:55 [INFO] [github.com/shenyu-client-golang/clients/etcd_client/etcd_client.go:66] Create customer etcd client success!\n2022-08-16 10:18:55 [INFO] [github.com/shenyu-client-golang/clients/etcd_client/etcd_client.go:142] RegisterServiceInstance,result:true\n2022-08-16 10:18:55 [INFO] [github.com/shenyu-client-golang/clients/etcd_client/etcd_client.go:142] RegisterServiceInstance,result:true\n2022-08-16 10:18:56 [INFO] [github.com/shenyu-client-golang/example/etcd_client/etcd_client.go:71] GetNodesInfo ,success Index 0 {"appName":"testMetaDataRegister1","path":"your/path1","contextPath":"","ruleName":"","rpcType":"","enabled":true,"host":"127.0.0.1","port":"8080","pluginNames":null,"registerMetaData":false,"timeMillis":0}\n2022-08-16 10:18:56 [INFO] [github.com/shenyu-client-golang/example/etcd_client/etcd_client.go:85] GetNodesInfo ,success Index 0 {"appName":"testMetaDataRegister2","path":"your/path2","contextPath":"","ruleName":"","rpcType":"","enabled":true,"host":"127.0.0.1","port":"8181","pluginNames":null,"registerMetaData":false,"timeMillis":0}\n2022-08-16 10:18:56 [INFO] [github.com/shenyu-client-golang/example/etcd_client/etcd_client.go:89] > DeregisterServiceInstance start\n2022-08-16 10:19:33 [INFO] [github.com/shenyu-client-golang/example/etcd_client/etcd_client.go:101] DeregisterServiceInstance success !\n'})})]})}function u(e={}){const{wrapper:t}={...(0,s.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},28453:(e,t,n)=>{n.d(t,{R:()=>i,x:()=>c});var r=n(96540);const s={},a=r.createContext(s);function i(e){const t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function c(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:i(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);