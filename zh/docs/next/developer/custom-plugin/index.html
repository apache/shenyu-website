<!doctype html>
<html lang="zh" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/zh/blog/rss.xml" title="Apache ShenYu Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/blog/atom.xml" title="Apache ShenYu Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache ShenYu" href="/zh/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/zh/news/rss.xml" title="Apache ShenYu Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/zh/news/atom.xml" title="Apache ShenYu Blog Atom Feed"><title data-react-helmet="true">æ’ä»¶æ‰©å±• | Apache ShenYu</title><meta data-react-helmet="true" property="og:url" content="https://shenyu.apache.org//zh/docs/next/developer/custom-plugin"><meta data-react-helmet="true" name="docsearch:language" content="zh"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="æ’ä»¶æ‰©å±• | Apache ShenYu"><meta data-react-helmet="true" name="description" content="æ’ä»¶æ‰©å±•"><meta data-react-helmet="true" property="og:description" content="æ’ä»¶æ‰©å±•"><meta data-react-helmet="true" name="keywords" content="æ‰©å±•"><link data-react-helmet="true" rel="shortcut icon" href="/zh/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://shenyu.apache.org//zh/docs/next/developer/custom-plugin"><link data-react-helmet="true" rel="alternate" href="https://shenyu.apache.org//docs/next/developer/custom-plugin" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://shenyu.apache.org//zh/docs/next/developer/custom-plugin" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://shenyu.apache.org//docs/next/developer/custom-plugin" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/zh/assets/css/styles.cc2d0c98.css">
<link rel="preload" href="/zh/assets/js/runtime~main.2931e5df.js" as="script">
<link rel="preload" href="/zh/assets/js/main.3174866a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/zh/"><img src="/zh/img/logo.svg" alt="Apache ShenYu Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/zh/img/logo-light.svg" alt="Apache ShenYu Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/zh/download">ä¸‹è½½</a><a class="navbar__item navbar__link" href="/zh/document">æ–‡æ¡£</a><a class="navbar__item navbar__link" href="/zh/community/contributor-guide">ç¤¾åŒº</a><a class="navbar__item navbar__link" href="/zh/team">å›¢é˜Ÿ</a><a class="navbar__item navbar__link" href="/zh/event">äº‹ä»¶</a><a class="navbar__item navbar__link" href="/zh/news">æ–°é—»</a><a class="navbar__item navbar__link" href="/zh/blog">åšå®¢</a><a class="navbar__item navbar__link" href="/zh/users">ç”¨æˆ·</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">åŸºé‡‘ä¼š</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">è®¸å¯</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">æ´»åŠ¨</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">å®‰å…¨</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">èµåŠ©</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">éšç§</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">è‡´è°¢</a></li></ul></div><a href="https://github.com/apache/shenyu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg t="1631348384596" class="icon" viewBox="0 0 1024 1024" version="1.1" style="vertical-align:text-bottom;margin-right:5px" p-id="557" width="20" height="20"><path d="M547.797333 638.208l-104.405333-103.168 1.237333-1.28a720.170667 720.170667 0 0 0 152.490667-268.373333h120.448V183.082667h-287.744V100.906667H347.605333v82.218666H59.818667V265.386667h459.178666a648.234667 648.234667 0 0 1-130.304 219.946666 643.242667 643.242667 0 0 1-94.976-137.728H211.541333a722.048 722.048 0 0 0 122.453334 187.434667l-209.194667 206.378667 58.368 58.368 205.525333-205.525334 127.872 127.829334 31.232-83.84m231.424-208.426667h-82.218666l-184.96 493.312h82.218666l46.037334-123.306667h195.242666l46.464 123.306667h82.218667l-185.002667-493.312m-107.690666 287.744l66.56-178.005333 66.602666 178.005333z" fill="currentColor" p-id="558"></path></svg><span>ç®€ä½“ä¸­æ–‡</span></span></a><ul class="dropdown__menu"><li><a href="/docs/next/developer/custom-plugin" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">English</a></li><li><a href="/zh/docs/next/developer/custom-plugin" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ğŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ğŸŒ</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_Bc3W"><button type="button" class="DocSearch DocSearch-Button" aria-label="æœç´¢ (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">æœç´¢</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/zh/docs/next/index">Apache ShenYu ä»‹ç»</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è®¾è®¡æ–‡æ¡£</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">è¿ç»´éƒ¨ç½²</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">å¿«é€Ÿå¼€å§‹</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ç”¨æˆ·æŒ‡å—</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">æ’ä»¶é›†åˆ</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">å¼€å‘è€…æ–‡æ¡£</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">SPI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/custom-filter">è‡ªå®šä¹‰Filter</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/custom-jwt-covert-algorithm">è‡ªå®šä¹‰JWTæ’ä»¶è½¬åŒ–ç®—æ³•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/custom-parsing-ip-and-host">æ­£ç¡®è·å–IPä¸Host</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/zh/docs/next/developer/custom-plugin">æ’ä»¶æ‰©å±•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/custom-result">è‡ªå®šä¹‰è¿”å›ç»“æœ</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/custom-sign-algorithm">è‡ªå®šä¹‰signæ’ä»¶æ£€éªŒç®—æ³•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/developer-shenyu-client">å¤šè¯­è¨€Httpå®¢æˆ·ç«¯</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/file-and-image">æ–‡ä»¶ä¸Šä¼ ä¸‹è½½</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/integration-test">æœ¬åœ°è¿è¡Œé›†æˆæµ‹è¯•</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/local-model">æœ¬åœ°æ¨¡å¼</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/notice-alert">å‘Šè­¦é€šçŸ¥</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/shenyu-optimize">ShenYu æ€§èƒ½ä¼˜åŒ–</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/zh/docs/next/developer/thread-model">çº¿ç¨‹æ¨¡å‹</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">åŸºå‡†æµ‹è¯•</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Apache ShenYu <b>å½“å‰ç‰ˆæœ¬</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/zh/docs/developer/custom-plugin">latest version</a></b> (2.7.0.1).</div></div><div class="docItemContainer_oiyr"><article><span class="badge badge--secondary">Version: å½“å‰ç‰ˆæœ¬</span><div class="tocCollapsible_aw-L tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_dC7a">æ’ä»¶æ‰©å±•</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è¯´æ˜"></a>è¯´æ˜<a class="hash-link" href="#è¯´æ˜" title="Direct link to heading">#</a></h2><ul><li>æ’ä»¶æ˜¯ <code>Apache ShenYu</code> ç½‘å…³çš„æ ¸å¿ƒæ‰§è¡Œè€…ï¼Œæ¯ä¸ªæ’ä»¶åœ¨å¼€å¯çš„æƒ…å†µä¸‹ï¼Œéƒ½ä¼šå¯¹åŒ¹é…çš„æµé‡ï¼Œè¿›è¡Œè‡ªå·±çš„å¤„ç†ã€‚</li><li>åœ¨ <code>Apache ShenYu</code> ç½‘å…³é‡Œé¢ï¼Œæ’ä»¶åˆ†ä¸ºä¸¤ç±»ã€‚<ul><li>ä¸€ç±»æ˜¯å•ä¸€èŒè´£çš„è°ƒç”¨é“¾ï¼Œä¸èƒ½å¯¹æµé‡è¿›è¡Œè‡ªå®šä¹‰çš„ç­›é€‰ã€‚</li><li>ä¸€ç±»æ˜¯èƒ½å¯¹åŒ¹é…çš„æµé‡ï¼Œæ‰§è¡Œè‡ªå·±çš„èŒè´£è°ƒç”¨é“¾ã€‚</li></ul></li><li>ç”¨æˆ·å¯ä»¥å‚è€ƒ <a href="https://github.com/apache/shenyu/tree/master/shenyu-plugin" target="_blank" rel="noopener noreferrer">shenyu-plugin</a> æ¨¡å—ï¼Œæ–°å¢è‡ªå·±çš„æ’ä»¶å¤„ç†ï¼Œå¦‚æœæœ‰å¥½çš„å…¬ç”¨æ’ä»¶ï¼Œå¯ä»¥å‘å®˜ç½‘æäº¤<code>pr</code>ã€‚</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="å•ä¸€èŒè´£æ’ä»¶"></a>å•ä¸€èŒè´£æ’ä»¶<a class="hash-link" href="#å•ä¸€èŒè´£æ’ä»¶" title="Direct link to heading">#</a></h2><ul><li>å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.shenyu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">shenyu-plugin-api</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ç”¨æˆ·æ–°å¢ä¸€ä¸ªç±» <code>MyShenyuPlugin</code>ï¼Œç›´æ¥å®ç° <code>org.apache.shenyu.plugin.api.ShenyuPlugin</code></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public interface ShenyuPlugin {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Process the Web request and (optionally) delegate to the next</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * {@code WebFilter} through the given {@link ShenyuPluginChain}.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param exchange the current server exchange</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param chain    provides a way to delegate to the next filter</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return {@code Mono&lt;Void&gt;} to indicate when request processing is complete</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    Mono&lt;Void&gt; execute(ServerWebExchange exchange, ShenyuPluginChain chain);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * return plugin order .</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * This attribute To determine the plugin execution order in the same type plugin.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return int order</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    int getOrder();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * acquire plugin name.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * this is plugin name define you must Provide the right name.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * if you impl AbstractShenyuPlugin this attribute not use.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return plugin name.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default String named() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * plugin is execute.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * if return true this plugin can not execute.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param exchange the current server exchange</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return default false.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default Boolean skip(ServerWebExchange exchange) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li><p>æ¥å£æ–¹æ³•è¯¦ç»†è¯´æ˜</p><ul><li><p><code>execute()</code> æ–¹æ³•ä¸ºæ ¸å¿ƒçš„æ‰§è¡Œæ–¹æ³•ï¼Œç”¨æˆ·å¯ä»¥åœ¨é‡Œé¢è‡ªç”±çš„å®ç°è‡ªå·±æƒ³è¦çš„åŠŸèƒ½ã€‚</p></li><li><p><code>getOrder()</code> æŒ‡å®šæ’ä»¶çš„æ’åºã€‚</p></li><li><p><code>named()</code> æŒ‡å®šæ’ä»¶çš„åç§°ï¼Œå‘½åé‡‡ç”¨<code>Camel Case</code>ï¼Œå¦‚ï¼š<code>dubbo</code>ã€<code>springCloud</code>ã€‚</p></li><li><p><code>skip()</code> åœ¨ç‰¹å®šçš„æ¡ä»¶ä¸‹ï¼Œè¯¥æ’ä»¶æ˜¯å¦è¢«è·³è¿‡ã€‚</p></li></ul></li></ul><ul><li>æ³¨å†Œæˆ<code>Spring</code>çš„<code>bean</code>ï¼Œå‚è€ƒå¦‚ä¸‹ï¼Œæˆ–è€…ç›´æ¥åœ¨å®ç°ç±»ä¸ŠåŠ  <code>@Component</code> æ³¨è§£ã€‚</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ShenyuPlugin myShenyuPlugin() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new MyShenyuPlugin();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="å•ä¸€èŒè´£æ’ä»¶ä¸å¤šè¯­è¨€"></a>å•ä¸€èŒè´£æ’ä»¶ä¸å¤šè¯­è¨€<a class="hash-link" href="#å•ä¸€èŒè´£æ’ä»¶ä¸å¤šè¯­è¨€" title="Direct link to heading">#</a></h2><ul><li>ä¸Šè¿°ç”¨javaå†™å•ä¸€èŒè´£æ’ä»¶ï¼Œå¦‚æœæƒ³ç”¨å…¶ä»–è¯­è¨€å†™æ’ä»¶ï¼Œè‡³å°‘éœ€è¦ä½ æ“…é•¿çš„è¯­è¨€æ”¯æŒ<code>WASM</code>ï¼Œä½ å¯ä»¥åœ¨<a href="https://shenyu.apache.org/zh/docs/next/design/wasm-plugin-design/" target="_blank" rel="noopener noreferrer">è¿™é‡Œ</a> æ‰¾åˆ°ä¸€äº›èµ„æ–™ã€‚åœ¨ä½ äº†è§£è¿‡<code>WASM</code>åï¼Œæˆ‘ä»¬å¼•å…¥ä»¥ä¸‹ä¾èµ–æ¥æ„å»ºæ’ä»¶çš„javaéƒ¨åˆ†ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.shenyu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">shenyu-plugin-wasm-api</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ç”¨æˆ·æ–°å¢ä¸€ä¸ªç±» <code>MyShenyuWasmPlugin</code>ï¼Œç›´æ¥ç»§æ‰¿ <code>org.apache.shenyu.plugin.wasm.api.AbstractWasmPlugin</code></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">package x.y.z;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public class MyShenyuWasmPlugin extends AbstractWasmPlugin {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    private static final Map&lt;Long, String&gt; RESULTS = new ConcurrentHashMap&lt;&gt;();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int getOrder() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // ä½ çš„æ’ä»¶é¡ºåº</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String named() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;ä½ çš„æ’ä»¶åç§°&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected Mono&lt;Void&gt; doExecute(final ServerWebExchange exchange, final ShenyuPluginChain chain, final Long argumentId) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        final String result = RESULTS.remove(argumentId);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // è°ƒç”¨å…¶ä»–è¯­è¨€è¿”å›çš„ç»“æœ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return chain.execute(exchange);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected Long getArgumentId(final ServerWebExchange exchange, final ShenyuPluginChain chain) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        // éœ€è¦æ ¹æ®exchangeå’Œchainç”Ÿæˆå‚æ•°çš„å”¯ä¸€id</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 0L;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected Map&lt;String, Func&gt; initWasmCallJavaFunc(final Store&lt;Void&gt; store) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        Map&lt;String, Func&gt; funcMap = new HashMap&lt;&gt;();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        funcMap.put(&quot;get_args&quot;, WasmFunctions.wrap(store, WasmValType.I64, WasmValType.I64, WasmValType.I32, WasmValType.I32,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            (argId, addr, len) -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                // å…¶ä»–è¯­è¨€ä»javaè·å–å‚æ•°çš„å›è°ƒ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                String config = &quot;hello from java &quot; + argId;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                LOG.info(&quot;java side-&gt;&quot; + config);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                ByteBuffer buf = super.getBuffer();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                for (int i = 0; i &lt; len &amp;&amp; i &lt; config.length(); i++) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    buf.put(addr.intValue() + i, (byte) config.charAt(i));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                return Math.min(config.length(), len);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            }));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        funcMap.put(&quot;put_result&quot;, WasmFunctions.wrap(store, WasmValType.I64, WasmValType.I64, WasmValType.I32, WasmValType.I32,</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            (argId, addr, len) -&gt; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                // å…¶ä»–è¯­è¨€æŠŠè°ƒç”¨ç»“æœä¼ ç»™javaçš„å›è°ƒ</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                ByteBuffer buf = super.getBuffer();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                byte[] bytes = new byte[len];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                for (int i = 0; i &lt; len; i++) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                    bytes[i] = buf.get(addr.intValue() + i);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                String result = new String(bytes, StandardCharsets.UTF_8);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                RESULTS.put(argId, result);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                LOG.info(&quot;java side-&gt;&quot; + result);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">                return 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">            }));</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return funcMap;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>åˆ›å»ºå…¶ä»–è¯­è¨€çš„é¡¹ç›®ï¼Œä¸‹é¢ä»¥rustè¯­è¨€ä¸ºä¾‹ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token builtin class-name">cd</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">shenyu</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/shenyu-plugin/</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">your_plugin_moodule</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">/src/main</span></span><span class="token-line" style="color:#393A34"><span class="token plain">cargo new --lib your_plugin_name</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>åœ¨<code>lib.rs</code>ä¸­æ–°å¢<code>execute</code>æ–¹æ³•ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI rust"><pre tabindex="0" class="prism-code language-rust codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#[link(wasm_import_module = &quot;shenyu&quot;)]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">extern &quot;C&quot; {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn get_args(arg_id: i64, addr: i64, len: i32) -&gt; i32;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    fn put_result(arg_id: i64, addr: i64, len: i32) -&gt; i32;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">// åŠ ä¸Š`#[no_mangle]`ä»¥é˜²æ­¢rustç¼–è¯‘å™¨ä¿®æ”¹æ–¹æ³•åï¼Œè¿™æ˜¯å¿…é¡»çš„</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#[no_mangle]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">pub unsafe extern &quot;C&quot; fn execute(arg_id: i64) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let mut buf = [0u8; 32];</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let buf_ptr = buf.as_mut_ptr() as i64;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    eprintln!(&quot;rust side-&gt; buffer base address: {}&quot;, buf_ptr);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // ä»javaé‚£è¾¹è·å–å‚æ•°</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let len = get_args(arg_id, buf_ptr, buf.len() as i32);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let java_arg = std::str::from_utf8(&amp;buf[..len as usize]).unwrap();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    eprintln!(&quot;rust side-&gt; recv:{}&quot;, java_arg);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // è¿™é‡Œæ·»åŠ rustéƒ¨åˆ†çš„æ’ä»¶é€»è¾‘ï¼Œæ¯”å¦‚rpcè°ƒç”¨ç­‰ç­‰</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    // æŠŠrustçš„è°ƒç”¨ç»“æœä¼ ç»™java</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let rust_result = &quot;rust result&quot;.as_bytes();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    let result_ptr = rust_result.as_ptr() as i64;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    _ = put_result(arg_id, result_ptr, rust_result.len() as i32);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>åœ¨<code>Cargo.toml</code>ä¸­æ–°å¢<code>[lib]</code>å¹¶æŠŠ<code>crate-type</code>æ”¹ä¸º<code>[&quot;cdylib&quot;]</code>ï¼Œæœ€ç»ˆä½ çš„<code>Cargo.toml</code>åº”è¯¥åƒè¿™æ ·ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI toml"><pre tabindex="0" class="prism-code language-toml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">[package]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">name = &quot;your_plugin_name&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">version = &quot;0.1.0&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">edition = &quot;2021&quot;</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[dependencies]</span></span><span class="token-line" style="color:#393A34"><span class="token plain"># ......</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">[lib]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">crate-type = [&quot;cdylib&quot;]</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ç”Ÿæˆwasmæ–‡ä»¶ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI shell"><pre tabindex="0" class="prism-code language-shell codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">cargo build --target wasm32-wasi --release</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ä½ å°†çœ‹åˆ°<code>{shenyu}/shenyu-plugin/{your_plugin_moodule}/src/main/{your_plugin_name}/target/wasm32-wasi/release/{your_plugin_name}.wasm</code>ï¼Œé‡å‘½åwasmæ–‡ä»¶ï¼Œç»“åˆ<code>x.y.z.MyShenyuWasmPlugin</code>çš„ç±»è·¯å¾„ï¼Œwasmæ–‡ä»¶åæ˜¯<code>x.y.z.MyShenyuWasmPlugin.wasm</code>ï¼Œæœ€åæŠŠwasmæ–‡ä»¶æ”¾åˆ°ä½ æ’ä»¶æ¨¡å—çš„<code>resources</code>æ–‡ä»¶å¤¹ä¸‹ã€‚</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="åŒ¹é…æµé‡å¤„ç†æ’ä»¶"></a>åŒ¹é…æµé‡å¤„ç†æ’ä»¶<a class="hash-link" href="#åŒ¹é…æµé‡å¤„ç†æ’ä»¶" title="Direct link to heading">#</a></h2><ul><li>å¼•å…¥å¦‚ä¸‹ä¾èµ–ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.shenyu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">shenyu-plugin-base</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li><p>æ–°å¢ä¸€ä¸ªç±» <code>CustomPlugin</code>ï¼Œç»§æ‰¿ <code>org.apache.shenyu.plugin.base.AbstractShenyuPlugin</code></p></li><li><p>ä»¥ä¸‹æ˜¯å‚è€ƒï¼š</p></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">/**</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * This is your custom plugin.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * He is running in after before plugin, implement your own functionality.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * extends AbstractShenyuPlugin so you must user shenyu-admin And add related plug-in development.</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> *</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> * @author xiaoyu(Myth)</span></span><span class="token-line" style="color:#393A34"><span class="token plain"> */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public class CustomPlugin extends AbstractShenyuPlugin {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * return plugin order .</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * The same plugin he executes in the same order.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return int</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public int getOrder() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 0;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * acquire plugin name.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * return you custom plugin name.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * It must be the same name as the plug-in you added in the admin background.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return plugin name.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public String named() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return &quot;shenYu&quot;;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * plugin is execute.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Do I need to skip.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * if you need skip return true.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param exchange the current server exchange</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return default false.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public Boolean skip(final ServerWebExchange exchange) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return false;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * this is Template Method child has Implement your own logic.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param exchange exchange the current server exchange</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param chain    chain the current chain</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param selector selector</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param rule     rule</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return {@code Mono&lt;Void&gt;} to indicate when request handling is complete</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    @Override</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    protected abstract Mono&lt;Void&gt; doExecute(ServerWebExchange exchange, ShenyuPluginChain chain, SelectorData selector, RuleData rule) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        LOGGER.debug(&quot;.......... function plugin start..............&quot;);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        /*</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         * Processing after your selector matches the rule.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         * rule.getHandle() is you Customize the json string to be processed.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         * for this example.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         * Convert your custom json string pass to an entity class.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        final String ruleHandle = rule.getHandle();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        final Test test = GsonUtils.getInstance().fromJson(ruleHandle, Test.class);</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        /*</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         * Then do your own business processing.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         * The last execution  chain.execute(exchange).</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         * Let it continue on the chain until the end.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">         */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        System.out.println(test.toString());</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return chain.execute(exchange);</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li><p>è¯¦ç»†è®²è§£ï¼š</p><ul><li><p>ç»§æ‰¿è¯¥ç±»çš„æ’ä»¶ï¼Œæ’ä»¶ä¼šè¿›è¡Œé€‰æ‹©å™¨è§„åˆ™åŒ¹é…ã€‚</p></li><li><p>é¦–å…ˆåœ¨ <code>shenyu-admin</code> åå°ç®¡ç†ç³»ç»Ÿ --&gt; åŸºç¡€é…ç½® --&gt; æ’ä»¶ç®¡ç† ä¸­ï¼Œæ–°å¢ä¸€ä¸ªæ’ä»¶ï¼Œæ³¨æ„ åç§°ä¸ ä½ è‡ªå®šä¹‰æ’ä»¶çš„ <code>named()</code> æ–¹æ³•è¦ä¸€è‡´ã€‚</p></li><li><p>é‡æ–°ç™»é™†  <code>shenyu-admin</code> åå°ï¼Œå¯ä»¥çœ‹è§åˆšæ–°å¢çš„æ’ä»¶ï¼Œç„¶åå°±å¯ä»¥è¿›è¡Œé€‰æ‹©å™¨è§„åˆ™åŒ¹é…ã€‚</p></li><li><p>åœ¨è§„åˆ™ä¸­ï¼Œæœ‰ä¸ª <code>handler</code> å­—æ®µï¼Œæ˜¯è‡ªå®šä¹‰å¤„ç†æ•°æ®ï¼Œåœ¨ <code>doExecute()</code> æ–¹æ³•ä¸­ï¼Œé€šè¿‡ <code>final String ruleHandle = rule.getHandle();</code> è·å–ï¼Œç„¶åè¿›è¡Œä½ çš„æ“ä½œã€‚</p></li></ul></li><li><p>æ³¨å†Œæˆ<code>Spring</code>çš„<code>bean</code>ï¼Œå‚è€ƒå¦‚ä¸‹æˆ–è€…ç›´æ¥åœ¨å®ç°ç±»ä¸ŠåŠ  <code>@Component</code> æ³¨è§£ã€‚</p></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">    @Bean</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    public ShenyuPlugin customPlugin() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        return new CustomPlugin();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="åŒ¹é…æµé‡å¤„ç†æ’ä»¶ä¸å¤šè¯­è¨€"></a>åŒ¹é…æµé‡å¤„ç†æ’ä»¶ä¸å¤šè¯­è¨€<a class="hash-link" href="#åŒ¹é…æµé‡å¤„ç†æ’ä»¶ä¸å¤šè¯­è¨€" title="Direct link to heading">#</a></h2><ul><li>å¤§ä½“é€»è¾‘ä¸<a href="#%E5%8D%95%E4%B8%80%E8%81%8C%E8%B4%A3%E6%8F%92%E4%BB%B6%E4%B8%8E%E5%A4%9A%E8%AF%AD%E8%A8%80">å•ä¸€èŒè´£æ’ä»¶ä¸å¤šè¯­è¨€</a> ç±»ä¼¼ï¼Œä½†javaéƒ¨åˆ†çš„ä¾èµ–ã€å…¶ä»–è¯­è¨€éœ€è¦æ–°å¢çš„æ–¹æ³•ä¸<code>å•ä¸€èŒè´£æ’ä»¶ä¸å¤šè¯­è¨€</code>ä¸åŒã€‚ä»¥ä¸‹æ˜¯<code>å¤šè¯­è¨€åŒ¹é…æµé‡å¤„ç†æ’ä»¶</code>javaéƒ¨åˆ†æ‰€éœ€è¦çš„ä¾èµ–ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.shenyu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">shenyu-plugin-wasm-base</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ä»¥ä¸‹æ˜¯å¿…é¡»æ–°å¢çš„æ–¹æ³•(ä»¥rustè¯­è¨€ä¸ºä¾‹)ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI rust"><pre tabindex="0" class="prism-code language-rust codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#[no_mangle]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">pub unsafe extern &quot;C&quot; fn doExecute(arg_id: i64) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //......</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li>ä»¥ä¸‹æ˜¯å¯é€‰çš„æ–¹æ³•(ä»¥rustè¯­è¨€ä¸ºä¾‹)ï¼š</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI rust"><pre tabindex="0" class="prism-code language-rust codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">#[no_mangle]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">pub unsafe extern &quot;C&quot; fn before(arg_id: i64) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //......</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">#[no_mangle]</span></span><span class="token-line" style="color:#393A34"><span class="token plain">pub unsafe extern &quot;C&quot; fn after(arg_id: i64) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    //......</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="è®¢é˜…ä½ çš„æ’ä»¶æ•°æ®è¿›è¡Œè‡ªå®šä¹‰çš„å¤„ç†"></a>è®¢é˜…ä½ çš„æ’ä»¶æ•°æ®ï¼Œè¿›è¡Œè‡ªå®šä¹‰çš„å¤„ç†<a class="hash-link" href="#è®¢é˜…ä½ çš„æ’ä»¶æ•°æ®è¿›è¡Œè‡ªå®šä¹‰çš„å¤„ç†" title="Direct link to heading">#</a></h2><ul><li>æ–°å¢ä¸€ä¸ªç±» <code>PluginDataHandler</code>ï¼Œå®ç° <code>org.apache.shenyu.plugin.base.handler.PluginDataHandler</code></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">public interface PluginDataHandler {</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Handler plugin.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pluginData the plugin data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default void handlerPlugin(PluginData pluginData) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Remove plugin.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param pluginData the plugin data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default void removePlugin(PluginData pluginData) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Handler selector.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param selectorData the selector data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default void handlerSelector(SelectorData selectorData) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Remove selector.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param selectorData the selector data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default void removeSelector(SelectorData selectorData) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Handler rule.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param ruleData the rule data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default void handlerRule(RuleData ruleData) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Remove rule.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @param ruleData the rule data</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    default void removeRule(RuleData ruleData) {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    }</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    /**</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * Plugin named string.</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     *</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     * @return the string</span></span><span class="token-line" style="color:#393A34"><span class="token plain">     */</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    String pluginNamed();</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><ul><li><p>æ³¨æ„ <code>pluginNamed()</code> è¦å’Œä½ è‡ªå®šä¹‰çš„æ’ä»¶åç§°ç›¸åŒã€‚</p></li><li><p>æ³¨å†Œæˆ<code>Spring</code>çš„<code>bean</code>ï¼Œå‚è€ƒå¦‚ä¸‹æˆ–è€…ç›´æ¥åœ¨å®ç°ç±»ä¸ŠåŠ  <code>@Component</code> æ³¨è§£ã€‚</p></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI java"><pre tabindex="0" class="prism-code language-java codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">@Bean</span></span><span class="token-line" style="color:#393A34"><span class="token plain">public PluginDataHandler pluginDataHandler() {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    return new PluginDataHandler();</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="åŠ¨æ€åŠ è½½è‡ªå®šä¹‰æ’ä»¶"></a>åŠ¨æ€åŠ è½½è‡ªå®šä¹‰æ’ä»¶<a class="hash-link" href="#åŠ¨æ€åŠ è½½è‡ªå®šä¹‰æ’ä»¶" title="Direct link to heading">#</a></h2><ul><li><p>å½“ä½¿ç”¨æ­¤åŠŸèƒ½æ—¶å€™ï¼Œä¸Šè¿°æ‰©å±• <code>ShenyuPlugin</code>, <code>PluginDataHandler</code>, ä¸ç”¨æˆä¸º <code>spring bean</code>ã€‚åªéœ€è¦æ„å»ºå‡ºæ‰©å±•é¡¹ç›®çš„jaråŒ…å³å¯ã€‚</p></li><li><p>ä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š</p></li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI yaml"><pre tabindex="0" class="prism-code language-yaml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token key atrule" style="color:#00a4db">shenyu</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token key atrule" style="color:#00a4db">extPlugin</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">path</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain">  //åŠ è½½æ‰©å±•æ’ä»¶jaråŒ…è·¯å¾„</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">enabled</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> true //æ˜¯å¦å¼€å¯</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">threads</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 1  //åŠ è½½æ’ä»¶çº¿ç¨‹æ•°é‡</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">scheduleTime</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 300 //é—´éš”æ—¶é—´ï¼ˆå•ä½ï¼šç§’ï¼‰</span></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token key atrule" style="color:#00a4db">scheduleDelay</span><span class="token punctuation" style="color:#393A34">:</span><span class="token plain"> 30 //ç½‘å…³å¯åŠ¨åå»¶è¿Ÿå¤šä¹…åŠ è½½ï¼ˆå•ä½ï¼šç§’ï¼‰</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æ’ä»¶åŠ è½½è·¯å¾„è¯¦è§£"></a>æ’ä»¶åŠ è½½è·¯å¾„è¯¦è§£<a class="hash-link" href="#æ’ä»¶åŠ è½½è·¯å¾„è¯¦è§£" title="Direct link to heading">#</a></h4><ul><li><p>æ­¤è·¯å¾„æ˜¯ä¸ºå­˜æ”¾æ‰©å±•æ’ä»¶jaråŒ…çš„ç›®å½•ã€‚</p></li><li><p>å¯ä»¥ä½¿ç”¨ <code>-Dplugin-ext=xxxx</code> æŒ‡å®šï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <code>shenyu.extPlugin.path</code>é…ç½®æ–‡ä»¶æŒ‡å®šï¼Œå¦‚æœéƒ½æ²¡é…ç½®ï¼Œé»˜è®¤ä¼šåŠ è½½ç½‘å…³å¯åŠ¨è·¯å¾„ä¸‹çš„ <code>ext-lib</code>ç›®å½•ã€‚</p></li><li><p>ä¼˜å…ˆçº§ ï¼š<code>-Dplugin-ext=xxxx</code> &gt; <code>shenyu.extPlugin.path</code> &gt; <code>ext-lib(default)</code></p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="æ’ä»¶jaråŒ…ä¸Šä¼ "></a>æ’ä»¶jaråŒ…ä¸Šä¼ <a class="hash-link" href="#æ’ä»¶jaråŒ…ä¸Šä¼ " title="Direct link to heading">#</a></h2><ul><li>å½“ä½¿ç”¨è¿™ä¸ªåŠŸèƒ½æ—¶å€™, éœ€è¦æŠŠä¸Šè¿°æ‰©å±•çš„<code>ShenyuPlugin</code> æ‰“åŒ…æˆè‡ªå®šä¹‰çš„ ShenyuPlugin Jar åŒ…</li><li>å¹¶ä¸”åœ¨ ShenyuAdmin è¿›è¡Œé…ç½®<ul><li>è¿›å…¥ ShenyuAdmin - BasicConfig - Plugin è¿›è¡Œæ·»åŠ  plugin åœ¨ pluginJar ä¸­å¯ä»¥æ·»åŠ è‡ªå®šä¹‰çš„ plugin Jar åŒ…</li></ul></li><li>è‡ªå®šä¹‰çš„ ShenyuPlugin å¦‚æœä¾èµ–äº†å…¶ä»–çš„ç¬¬ä¸‰æ–¹åŒ…å¯ä»¥ ShenyuBootstrap å¯åŠ¨æ—¶åŠ è½½åˆ° -cp çš„ç¬¬ä¸‰æ–¹jaråŒ…ç›®å½•</li></ul><p>æ³¨æ„:</p><p>ä¸Šä¼ jaråŒ…æ’ä»¶æ”¯æŒçƒ­åŠ è½½
å¦‚æœä½ éœ€è¦åœ¨çº¿ä¿®æ”¹jaråŒ…. ä½ å¯ä»¥é‡æ–°æ‰“ä¸€ä¸ªjaråŒ…. å¹¶ä¸”æå‡ç‰ˆæœ¬å·, ä¾‹å¦‚ <code>1.0.1</code> å‡é«˜è‡³ <code>1.0.2</code></p></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/apache/shenyu-website/edit/main/i18n/zh/docusaurus-plugin-content-docs/current/developer/custom-plugin.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>ç¼–è¾‘æœ¬æ–‡æ¡£</a></div><div class="col lastUpdated_wj+Z"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/zh/docs/next/developer/custom-parsing-ip-and-host"><div class="pagination-nav__sublabel">ä¸Šä¸€ç¯‡</div><div class="pagination-nav__label">Â« æ­£ç¡®è·å–IPä¸Host</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/zh/docs/next/developer/custom-result"><div class="pagination-nav__sublabel">ä¸‹ä¸€ç¯‡</div><div class="pagination-nav__label">è‡ªå®šä¹‰è¿”å›ç»“æœ Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#è¯´æ˜" class="table-of-contents__link">è¯´æ˜</a></li><li><a href="#å•ä¸€èŒè´£æ’ä»¶" class="table-of-contents__link">å•ä¸€èŒè´£æ’ä»¶</a></li><li><a href="#å•ä¸€èŒè´£æ’ä»¶ä¸å¤šè¯­è¨€" class="table-of-contents__link">å•ä¸€èŒè´£æ’ä»¶ä¸å¤šè¯­è¨€</a></li><li><a href="#åŒ¹é…æµé‡å¤„ç†æ’ä»¶" class="table-of-contents__link">åŒ¹é…æµé‡å¤„ç†æ’ä»¶</a></li><li><a href="#åŒ¹é…æµé‡å¤„ç†æ’ä»¶ä¸å¤šè¯­è¨€" class="table-of-contents__link">åŒ¹é…æµé‡å¤„ç†æ’ä»¶ä¸å¤šè¯­è¨€</a></li><li><a href="#è®¢é˜…ä½ çš„æ’ä»¶æ•°æ®è¿›è¡Œè‡ªå®šä¹‰çš„å¤„ç†" class="table-of-contents__link">è®¢é˜…ä½ çš„æ’ä»¶æ•°æ®ï¼Œè¿›è¡Œè‡ªå®šä¹‰çš„å¤„ç†</a></li><li><a href="#åŠ¨æ€åŠ è½½è‡ªå®šä¹‰æ’ä»¶" class="table-of-contents__link">åŠ¨æ€åŠ è½½è‡ªå®šä¹‰æ’ä»¶</a></li><li><a href="#æ’ä»¶jaråŒ…ä¸Šä¼ " class="table-of-contents__link">æ’ä»¶jaråŒ…ä¸Šä¼ </a></li></ul></div></div></div></div></main></div></div></div>
<script src="/zh/assets/js/runtime~main.2931e5df.js"></script>
<script src="/zh/assets/js/main.3174866a.js"></script>
</body>
</html>