"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[27071],{1733:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/add-selector-basic-en-13721a2c3d5b2ff3eb923d6022249766.png"},3844:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/add-selector-local-en-a27bc0cf61e1caca2e35bf405bf14079.png"},4890:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/add-selector-under-plugin-discovery-en-bdd4aaafdff4e9cce7a2df86d5472e85.png"},18423:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/edit-zk-upstream-en-003302d02022263db95f1e68110f441f.png"},28072:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>c,contentTitle:()=>r,default:()=>h,frontMatter:()=>o,metadata:()=>l,toc:()=>d});var s=i(74848),t=i(28453);const o={title:"Discovery",keywords:["Discovery"],description:"Discovery"},r="Discovery",l={id:"user-guide/discovery/discovery-mode",title:"Discovery",description:"Discovery",source:"@site/docs/user-guide/discovery/discovery-mode.md",sourceDirName:"user-guide/discovery",slug:"/user-guide/discovery/discovery-mode",permalink:"/docs/next/user-guide/discovery/discovery-mode",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/shenyu-website/edit/main/docs/user-guide/discovery/discovery-mode.md",tags:[],version:"current",frontMatter:{title:"Discovery",keywords:["Discovery"],description:"Discovery"},sidebar:"tutorialSidebar",previous:{title:"Using Zookeeper with Shenyu-SDK",permalink:"/docs/next/user-guide/sdk-usage/shenyu-sdk-zookeeper"},next:{title:"Dubbo Proxy",permalink:"/docs/next/user-guide/proxy/dubbo-proxy"}},c={},d=[{value:"1. Overview",id:"1-overview",level:2},{value:"1.1 Module Name",id:"11-module-name",level:3},{value:"1.2 Design",id:"12-design",level:3},{value:"1.3 Module Functionality",id:"13-module-functionality",level:3},{value:"1.4 Listening Mode",id:"14-listening-mode",level:3},{value:"1.5 Scope of Effect",id:"15-scope-of-effect",level:3},{value:"2. Usage",id:"2-usage",level:2},{value:"2.1 Plugin-Level Configuration",id:"21-plugin-level-configuration",level:3},{value:"2.1.1 Service Discovery Configuration",id:"211-service-discovery-configuration",level:4},{value:"2.1.2 Usage within Selectors",id:"212-usage-within-selectors",level:4},{value:"2.2 Selector-Level Configuration",id:"22-selector-level-configuration",level:3},{value:"3. Configuration in Different Modes",id:"3-configuration-in-different-modes",level:2},{value:"3.1 Local Mode",id:"31-local-mode",level:3},{value:"3.2 ZooKeeper/Nacos/Eureka/Etcd Modes",id:"32-zookeepernacoseurekaetcd-modes",level:3},{value:"4. Using Shenyu-client",id:"4-using-shenyu-client",level:2},{value:"4.1 Introduction",id:"41-introduction",level:3},{value:"4.2 Local Mode Example",id:"42-local-mode-example",level:3},{value:"4.2.1 Using Shenyu-client",id:"421-using-shenyu-client",level:4},{value:"4.2.2 Without Using Shenyu-client",id:"422-without-using-shenyu-client",level:4},{value:"4.2 Zookeeper Mode Example",id:"42-zookeeper-mode-example",level:3},{value:"4.3 Etcd Mode Example",id:"43-etcd-mode-example",level:3},{value:"4.4 Eureka Mode Example",id:"44-eureka-mode-example",level:3},{value:"4.5 Nacos Mode Example",id:"45-nacos-mode-example",level:3},{value:"5. Considerations",id:"5-considerations",level:2},{value:"6. Test Report",id:"6-test-report",level:2}];function a(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,t.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"discovery",children:"Discovery"}),"\n",(0,s.jsx)(n.h2,{id:"1-overview",children:"1. Overview"}),"\n",(0,s.jsx)(n.h3,{id:"11-module-name",children:"1.1 Module Name"}),"\n",(0,s.jsx)(n.p,{children:"Discovery"}),"\n",(0,s.jsx)(n.h3,{id:"12-design",children:"1.2 Design"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Module Design Diagram"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"discovery-design.png",src:i(55112).A+"",width:"1005",height:"638"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Database Design"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"db-design.png",src:i(30756).A+"",width:"494",height:"412"})}),"\n",(0,s.jsx)(n.h3,{id:"13-module-functionality",children:"1.3 Module Functionality"}),"\n",(0,s.jsxs)(n.p,{children:["The Discovery module endows the ShenYu Gateway with the ability to actively perceive and respond to changes in the list of services being proxied.\nBy actively listening to the admin service of the Discovery Gateway, the ShenYu Gateway can promptly track changes in the services being proxied.\nThis functionality is designed to be flexible and can be configured at either ",(0,s.jsx)(n.strong,{children:"the selector level or the plugin level"}),", as needed.\nCurrently, plugins that have incorporated the Discovery feature include TCP, Divide, Websocket and gRPC plugins."]}),"\n",(0,s.jsx)(n.h3,{id:"14-listening-mode",children:"1.4 Listening Mode"}),"\n",(0,s.jsx)(n.p,{children:"LOCAL, ZOOKEEPER, NACOS, EUREKA, ETCD"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"LOCAL Mode: Primarily relies on manual maintenance of the upstream list and pushing it to the gateway."}),"\n",(0,s.jsx)(n.li,{children:"ZOOKEEPER Mode: Monitors changes in ephemeral nodes under a specified node in ZooKeeper to obtain data."}),"\n",(0,s.jsx)(n.li,{children:"NACOS Mode: Listens for changes in instances under a specified service name in Nacos to obtain data."}),"\n",(0,s.jsx)(n.li,{children:"EUREKA Mode: Listens for changes in instances under a specified service name in Eureka to obtain data."}),"\n",(0,s.jsx)(n.li,{children:"ETCD Mode: Obtains data by monitoring changes in key-value pairs under specified nodes in etcd."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"15-scope-of-effect",children:"1.5 Scope of Effect"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Plugin Level: Impacts the entire plugin,\nand all selectors under that plugin will default to the current listening mode."}),"\n",(0,s.jsx)(n.li,{children:"Selector Level: Applies to the current selector,\nallowing different selectors under the same plugin to use different listening modes."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"2-usage",children:"2. Usage"}),"\n",(0,s.jsx)(n.h3,{id:"21-plugin-level-configuration",children:"2.1 Plugin-Level Configuration"}),"\n",(0,s.jsx)(n.h4,{id:"211-service-discovery-configuration",children:"2.1.1 Service Discovery Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:['In plugins that support the Discovery module (currently, only the TCP plugin supports plugin-level discovery\nconfiguration on the admin console page; other plugins can configure plugin-level discovery through shenyu-client,\nas described in the "Using Shenyu-client" section below), click on ',(0,s.jsx)(n.code,{children:"Discovery Configuration"}),". In the popup form,\nselect the desired listening mode and fill in the service discovery name, registration server URL, registry configuration parameters, etc.:"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"config-discovery-plugin-en.png",src:i(64202).A+"",width:"3004",height:"1640"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"config-discovery-plugin-modal-en.png",src:i(39086).A+"",width:"3018",height:"1646"})}),"\n",(0,s.jsx)(n.h4,{id:"212-usage-within-selectors",children:"2.1.2 Usage within Selectors"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["To add a new selector, click on ",(0,s.jsx)(n.code,{children:"Add Selector"}),". In the new selector page, you will notice that the ",(0,s.jsx)(n.code,{children:"Type"})," field enforces the previously configured plugin-level listening mode,\nindicating that the added selector will also adopt the same configuration.\nAt this point, simply input the desired ",(0,s.jsx)(n.code,{children:"ListeningNode"}),":"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"add-selector-under-plugin-discovery-en.png",src:i(4890).A+"",width:"3010",height:"1644"})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["The ",(0,s.jsx)(n.code,{children:"Handler"})," here refers to ShenYu's specified JSON format for transmitting upstream registration data,\nas shown below:"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"url: URL of the upstream"}),"\n",(0,s.jsx)(n.li,{children:"protocol: communication protocol of the upstream"}),"\n",(0,s.jsx)(n.li,{children:"status: status of the upstream node (0 for healthy, 1 for unhealthy)"}),"\n",(0,s.jsx)(n.li,{children:"weight: Used for load balancing calculations"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-json",children:'{\n    "url": "127.0.0.1::6379", \n    "protocol": "tcp",\n    "status": 0, \n    "weight": 10\n}\n'})}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["If your service alias does not match ShenYu's defined JSON format,\nyou can perform alias mapping in ",(0,s.jsx)(n.code,{children:"Handler"}),".\nFor example, as shown in the above image,\nif you need to change ",(0,s.jsx)(n.code,{children:"status"}),' to "healthy" while keeping other keys unchanged,\nfollow these steps: create a new alias, map ',(0,s.jsx)(n.code,{children:"status"})," to ",(0,s.jsx)(n.code,{children:"healthy"}),",\nand retain the original JSON keys' format."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Configure the remaining properties for the selector according to the specific plugin's documentation."}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"22-selector-level-configuration",children:"2.2 Selector-Level Configuration"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In plugins that support the Discovery module, click on ",(0,s.jsx)(n.code,{children:"Add Selector"}),".\nIn the ",(0,s.jsx)(n.code,{children:"Discovery Config"})," tab, configure the fields such as type,\nlistening node, server URL list, and registry properties.\nThis configuration only applies to the current selector and must be reconfigured each time a new selector is added."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"add-selector-en.png",src:i(75070).A+"",width:"2826",height:"1458"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["For the Divide, gRPC, and Websocket plugins,\nthe ",(0,s.jsx)(n.code,{children:"Import Background Discovery Config"})," function on the selector creation page\nallows you to import and use the backend configuration if the service connecting to the ShenYu Gateway\nwas configured with shenyu-discovery-related properties (see usage with shenyu-client).\nAs shown in the following image, click ",(0,s.jsx)(n.code,{children:"Import Background Discovery Config"})," to view the backend configuration:"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"config-import-en.png",src:i(76869).A+"",width:"2820",height:"1454"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If you confirm the import, clicking the ",(0,s.jsx)(n.code,{children:"Import"})," button in the backend configuration popup will automatically populate the form with the backend service discovery properties.\nAt this point, you only need to configure the listening node:"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"after-import-en.png",src:i(78057).A+"",width:"2826",height:"1458"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),": If you confirm importing the backend configuration,\nthe backend service discovery properties will be automatically filled in the form and will continue to use the previous discovery object.\nIn this case, modifying service discovery properties in the form will be ineffective, and the backend configuration will be retained."]}),"\n"]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"If you choose the LOCAL mode, there is no need to connect to a registry, and users must manually maintain the upstream list."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"3-configuration-in-different-modes",children:"3. Configuration in Different Modes"}),"\n",(0,s.jsx)(n.h3,{id:"31-local-mode",children:"3.1 Local Mode"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Local mode only supports configuration at the ",(0,s.jsx)(n.strong,{children:"selector level"}),".\nThere is no need to connect to a registry, and users must manually maintain the upstream list.\nThis list is an editable table. Click the ",(0,s.jsx)(n.code,{children:"Edit"})," button for each row in the table to modify each parameter of the upstream:"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"local-selector-en.png",src:i(52358).A+"",width:"2818",height:"1456"})}),"\n",(0,s.jsx)(n.h3,{id:"32-zookeepernacoseurekaetcd-modes",children:"3.2 ZooKeeper/Nacos/Eureka/Etcd Modes"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"In the ZooKeeper/Nacos/Eureka/Etcd modes, service discovery configuration is supported at both the plugin level and the selector level."}),"\n",(0,s.jsxs)(n.li,{children:["For each registry property under these modes, taking ZooKeeper as an example, users can go to ",(0,s.jsx)(n.code,{children:"shenyu-admin"})," --\x3e ",(0,s.jsx)(n.code,{children:"BasicConfig"})," --\x3e ",(0,s.jsx)(n.code,{children:"Dictionary"}),',\nsearch for the dictionary name "zookeeper", and edit the dictionary values corresponding to the default properties\n(',(0,s.jsx)(n.strong,{children:"Note"}),": You cannot modify the dictionary type and dictionary name)."]}),"\n",(0,s.jsx)(n.li,{children:"In these modes, the gateway dynamically retrieves service instance information from the registry. Additions, removals, modifications,\nand other changes to service instances will be displayed in real-time in the upstream list."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"zk_dict_en.png",src:i(39494).A+"",width:"1834",height:"859"})}),"\n",(0,s.jsx)(n.h2,{id:"4-using-shenyu-client",children:"4. Using Shenyu-client"}),"\n",(0,s.jsx)(n.h3,{id:"41-introduction",children:"4.1 Introduction"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"To use Shenyu-client, you need to depend on the corresponding mode's registry middleware: ZooKeeper, Nacos, Etcd, Eureka.\nThese modes can automatically detect service up and down events through ShenYu Admin."}),"\n",(0,s.jsx)(n.li,{children:"Additionally, if you are using the local mode, you will need to manually maintain the upstream list."}),"\n",(0,s.jsx)(n.li,{children:"For detailed instructions on using Shenyu-client, refer to the Shenyu-client module documentation."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"42-local-mode-example",children:"4.2 Local Mode Example"}),"\n",(0,s.jsx)(n.h4,{id:"421-using-shenyu-client",children:"4.2.1 Using Shenyu-client"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Shenyu-client defaults to the Local mode, so there is no need for any special discovery configuration.\nIt will automatically register the current service."}),"\n",(0,s.jsx)(n.li,{children:"For services that are automatically registered, you can manually add, modify,\nor delete them in the upstream list on the page:"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"local-selector-en.png",src:i(52358).A+"",width:"2818",height:"1456"})}),"\n",(0,s.jsx)(n.h4,{id:"422-without-using-shenyu-client",children:"4.2.2 Without Using Shenyu-client"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If you are not using Shenyu-client, you can manually add, modify,\nor delete service information on the ",(0,s.jsx)(n.code,{children:"Discovery Config"})," tab under ",(0,s.jsx)(n.code,{children:"Add Selector"}),":"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"add-selector-local-en.png",src:i(3844).A+"",width:"3024",height:"1648"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configure other selector information:"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"add-selector-basic-en.png",src:i(1733).A+"",width:"2808",height:"1446"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Configure rules:"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"rule-en.png",src:i(28095).A+"",width:"2828",height:"1456"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Test Connection"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"curl http://localhost:9195/http/hello\n\nhello! I'm Shenyu-Gateway System. Welcome!% \n"})}),"\n",(0,s.jsx)(n.h3,{id:"42-zookeeper-mode-example",children:"4.2 Zookeeper Mode Example"}),"\n",(0,s.jsx)(n.p,{children:"(Taking the Divide plugin as an example)"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add Dependencies"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<dependencies>\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-discovery-zookeeper</artifactId>\n    <version>${project.version}</version>\n  </dependency>\n\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-spring-boot-starter-client-http</artifactId>\n  </dependency>\n</dependencies>\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add the Following Configuration in application.yml"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"shenyu:\n   discovery:\n      enable: true\n      type: zookeeper\n      serverList: ${your.zookeeper.ip}:{your.zookeeper.port}\n      registerPath: /shenyu/discovery/demo_http_common\n      props:\n         baseSleepTimeMilliseconds: 1000\n         maxRetries: 4\n         maxSleepTimeMilliseconds: 5000\n         connectionTimeoutMilliseconds: 60000\n         sessionTimeoutMilliseconds: 8\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Start the shenyu-examples-http service."}),"\n",(0,s.jsx)(n.li,{children:"Once the service registration is successful,\nyou can view the list of automatically registered service instances on the selector page:"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"zk-selector-en.png",src:i(74566).A+"",width:"3024",height:"1646"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Users can click on ",(0,s.jsx)(n.code,{children:"Edit"})," in the service instance list to edit the service instance information\n(Note that in non-Local mode, the URL is maintained by the registry and cannot be manually edited):"]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"edit-zk-upstream-en.png",src:i(18423).A+"",width:"2996",height:"1650"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Test Connection"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"curl http://localhost:9195/http/hello\n\nhello! I'm Shenyu-Gateway System. Welcome!% \n"})}),"\n",(0,s.jsx)(n.h3,{id:"43-etcd-mode-example",children:"4.3 Etcd Mode Example"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add Dependencies"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<dependencies>\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-discovery-etcd</artifactId>\n    <version>${project.version}</version>\n  </dependency>\n\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-spring-boot-starter-client-http</artifactId>\n  </dependency>\n</dependencies>\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add the Following Configuration in application.yml"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"shenyu:\n   discovery:\n      enable: true\n      protocol: http://\n      type: etcd\n      serverList: http://${your.etcd.host}:${your.etcd.port}\n      registerPath: /shenyu/test/http_common\n      props:\n         etcdTimeout: 3000\n         etcdTTL: 5\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Start the shenyu-examples-http service. Similarly, on the selector page,\nyou can see the list of automatically registered service instances and edit them as needed:\n",(0,s.jsx)(n.img,{alt:"etcd-selector-en.png",src:i(94789).A+"",width:"3024",height:"1650"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Test Connection"}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"curl http://localhost:9195/http/hello\n\nhello! I'm Shenyu-Gateway System. Welcome!% \n"})}),"\n",(0,s.jsx)(n.h3,{id:"44-eureka-mode-example",children:"4.4 Eureka Mode Example"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add Dependencies"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<dependencies>\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-discovery-eureka</artifactId>\n    <version>${project.version}</version>\n  </dependency>\n\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-spring-boot-starter-client-http</artifactId>\n  </dependency>\n</dependencies>\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add the Following Configuration in application.yml\n(in this context, ",(0,s.jsx)(n.code,{children:"registerPath"})," can be understood as the name of the service to be monitored):"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"shenyu:\n   discovery:\n      enable: true\n      protocol: http://\n      type: eureka\n      serverList: http://${your.eureka.host}:${your.eureka.port}/eureka\n      registerPath: shenyu_discovery_demo_http_common\n      props:\n         eurekaClientRefreshInterval: 10\n         eurekaClientRegistryFetchIntervalSeconds: 10\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Start the shenyu-examples-http service. Similarly, on the selector page,\nyou can see the list of automatically registered service instances and edit them as needed:"}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"eureka-selector-en.png",src:i(95842).A+"",width:"3024",height:"1648"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Test Connection"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"curl http://localhost:9195/http/hello\n\nhello! I'm Shenyu-Gateway System. Welcome!% \n"})}),"\n",(0,s.jsx)(n.h3,{id:"45-nacos-mode-example",children:"4.5 Nacos Mode Example"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Add Dependencies"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"<dependencies>\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-discovery-eureka</artifactId>\n    <version>${project.version}</version>\n  </dependency>\n\n  <dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-spring-boot-starter-client-http</artifactId>\n  </dependency>\n</dependencies>\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add the Following Configuration in application.yml\n(Here, ",(0,s.jsx)(n.code,{children:"registerPath"})," can also be understood as the name of the service to be monitored.)"]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"shenyu:\n   discovery:\n      enable: true\n      protocol: http://\n      type: nacos\n      serverList: ${your.nacos.host}:${your.nacos.port}\n      registerPath: shenyu_discovery_demo_http_common\n      props:\n         groupName: SHENYU_GROUP\n"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Start the shenyu-examples-http service. Similarly, on the selector page,\nyou can view the list of automatically registered service instances and edit them as needed."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"nacos-selector-en.png",src:i(32147).A+"",width:"3022",height:"1648"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Test Connection"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-text",children:"curl http://localhost:9195/http/hello\n\nhello! I'm Shenyu-Gateway System. Welcome!% \n"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),"\uff1aConfiguring service discovery using Shenyu-client essentially configures service discovery at the plugin level.\nUnder the same service discovery mode, there is, in fact, only one discovery object\n(meaning you can only configure the same set of type, server URL, and service discovery parameters), while multiple listening nodes can be configured."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"ws-selector-en.png",src:i(99981).A+"",width:"2992",height:"1648"})}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.strong,{children:"Note"}),"\uff1aIn the Divide and gRPC plugins, you can modify the protocol by configuring the protocol in the application.yml file.\nThe default protocol for the Websocket plugin is 'ws'."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"5-considerations",children:"5. Considerations"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"In local mode, you can manually modify all parameters of the upstream on the service list page."}),"\n",(0,s.jsx)(n.li,{children:"In non-local modes, you can manually modify parameters other than URL and start time."}),"\n",(0,s.jsx)(n.li,{children:"Manually changing the status (open/close) and weight of service instances only affects the current plugin."}),"\n",(0,s.jsx)(n.li,{children:"For the same plugin, when configuring discovery-related parameters through Shenyu-client in the backend, it essentially configures service discovery at the plugin level. Although you can manually add selectors on the console page to configure selector-level service discovery, in reality, there is only one discovery object (meaning you can only configure the same set of type, server URL, and service discovery parameters), while multiple listening nodes can be configured."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"6-test-report",children:"6. Test Report"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.a,{href:"https://www.yuque.com/eureca/pgotw1/hkqkk5laubspgwl3#UojLR",children:"Test Report"})})]})}function h(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(a,{...e})}):a(e)}},28095:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/rule-en-95ac5e751ee513a5e2f1f6df880bf892.png"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>l});var s=i(96540);const t={},o=s.createContext(t);function r(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),s.createElement(o.Provider,{value:n},e.children)}},30756:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/db-design-ace76c69c809afe5bf47464fc1b0209c.png"},32147:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/nacos-selector-en-848290702d46c73d029d688e3c3c1a03.png"},39086:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/config-discovery-plugin-modal-en-5922e43048c244e8dcd8b3eab8ad8d9b.png"},39494:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/zk_dict_en-fd86f5888a94e38c84a97588ff295e79.png"},52358:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/local-selector-en-94c6799b40684d6d04f8fc1cd8943fd2.png"},55112:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/discovery-design-3081f14fec1ef9322d39bd1b998f42a3.png"},64202:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/config-discovery-plugin-en-03817c824ab97b6f6144141cfbb5750f.png"},74566:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/zk-selector-en-7d96c81ae13fa7c6e837c5adf35d28d7.png"},75070:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/add-selector-en-f69527e00c21591f8f22a3c8c46c1dbb.png"},76869:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/config-import-en-520151b4311fdd295879ae00da086657.png"},78057:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/after-import-en-1080a3e988b4efde089dddc3366ec4d0.png"},94789:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/etcd-selector-en-32149574a23a9f958f3c51f5a4e17800.png"},95842:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/eureka-selector-en-438b997614fcd24234dc72ee81d35be6.png"},99981:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/ws-selector-en-0646fe75699ac938f415edfc2f5fcc09.png"}}]);