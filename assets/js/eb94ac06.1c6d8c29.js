"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[96251],{28453(e,n,r){r.d(n,{R:()=>i,x:()=>l});var s=r(96540);const t={},o=s.createContext(t);function i(e){const n=s.useContext(o);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:i(e.components),s.createElement(o.Provider,{value:n},e.children)}},29077(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>d,frontMatter:()=>i,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"user-guide/kubernetes-controller/build-deploy","title":"Build And Deploy Kubernetes Controller","description":"Build And Deploy Kubernetes Controller","source":"@site/versioned_docs/version-2.7.0/user-guide/kubernetes-controller/build-deploy.md","sourceDirName":"user-guide/kubernetes-controller","slug":"/user-guide/kubernetes-controller/build-deploy","permalink":"/docs/2.7.0/user-guide/kubernetes-controller/build-deploy","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.7.0/user-guide/kubernetes-controller/build-deploy.md","tags":[],"version":"2.7.0","frontMatter":{"title":"Build And Deploy Kubernetes Controller","description":"Build And Deploy Kubernetes Controller"},"sidebar":"tutorialSidebar","previous":{"title":"Websocket Proxy","permalink":"/docs/2.7.0/user-guide/proxy/websocket-proxy"},"next":{"title":"Kubernetes Controller Config","permalink":"/docs/2.7.0/user-guide/kubernetes-controller/config"}}');var t=r(74848),o=r(28453);const i={title:"Build And Deploy Kubernetes Controller",description:"Build And Deploy Kubernetes Controller"},l=void 0,a={},c=[{value:"Construct",id:"construct",level:2},{value:"deployment",id:"deployment",level:2}];function u(e){const n={a:"a",code:"code",h2:"h2",p:"p",pre:"pre",...(0,o.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.p,{children:"This article introduces how to use ShenYu Ingress Controller."}),"\n",(0,t.jsx)(n.h2,{id:"construct",children:"Construct"}),"\n",(0,t.jsxs)(n.p,{children:["It is recommended to refer to ",(0,t.jsx)(n.a,{href:"/docs/2.7.0/deployment/deployment-custom",children:"Custom Deployment"})," to build a custom gateway, add the shenyu-kubernetes-controller dependency to the Maven dependency of the gateway, and the gateway can integrate the kubernetes controller."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"         <dependency>\n             <groupId>org.apache.shenyu</groupId>\n             <artifactId>shenyu-spring-boot-starter-k8s</artifactId>\n             <version>${project.version}</version>\n         </dependency>\n"})}),"\n",(0,t.jsx)(n.p,{children:"You can also directly use the officially built docker image (TODO, unfinished)"}),"\n",(0,t.jsx)(n.h2,{id:"deployment",children:"deployment"}),"\n",(0,t.jsx)(n.p,{children:"K8s deployment files can refer to:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'apiVersion: v1\nkind: Namespace\nmetadata:\n  name: shenyu-ingress\n---\napiVersion: v1\nautomountServiceAccountToken: true\nkind: ServiceAccount\nmetadata:\n  name: shenyu-ingress-controller\n  namespace: shenyu-ingress\n---\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: shenyu-ingress-controller\n  namespace: shenyu-ingress\n  labels:\n    app: shenyu-ingress-controller\n    all: shenyu-ingress-controller\nspec:\n  replicas: 1\n  selector:\n    matchLabels:\n      app: shenyu-ingress-controller\n  template:\n    metadata:\n      labels:\n        app: shenyu-ingress-controller\n    spec:\n      containers:\n      - name: shenyu-ingress-controller\n        image: apache/shenyu-integrated-test-k8s-ingress:latest\n        ports:\n        - containerPort: 9195\n        imagePullPolicy: IfNotPresent\n      serviceAccountName: shenyu-ingress-controller\n---\napiVersion: v1\nkind: Service\nmetadata:\n  name: shenyu-ingress-controller\n  namespace: shenyu-ingress\nspec:\n  selector:\n    app: shenyu-ingress-controller\n  type: NodePort\n  ports:\n    - port: 9195\n      targetPort: 9195\n      nodePort: 30095\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n  name: shenyu-ingress-controller\nrules:\n- apiGroups:\n  - ""\n  resources:\n  - namespaces\n  - services\n  - endpoints\n  - secrets\n  - pods\n  verbs:\n  - get\n  - list\n  - watch\n- apiGroups:\n  - networking.k8s.io\n  resources:\n  - ingresses\n  verbs:\n  - get\n  - list\n  - watch\n---\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRoleBinding\nmetadata:\n  name: shenyu-ingress-controller\n  namespace: shenyu-ingress\nroleRef:\n  apiGroup: rbac.authorization.k8s.io\n  kind: ClusterRole\n  name: shenyu-ingress-controller\nsubjects:\n- kind: ServiceAccount\n  name: shenyu-ingress-controller\n  namespace: shenyu-ingress\n'})}),"\n",(0,t.jsxs)(n.p,{children:["Among them, Service can be changed to ",(0,t.jsx)(n.code,{children:"LoadBalancer"})," type according to the actual situation."]})]})}function d(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(u,{...e})}):u(e)}}}]);