"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[13133],{7978(e,n,r){r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>p,frontMatter:()=>s,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"user-guide/proxy/mcp-tool-proxy","title":"McpTool Service Integration","description":"McpTool Service Integration","source":"@site/versioned_docs/version-2.7.0.3/user-guide/proxy/mcp-tool-proxy.md","sourceDirName":"user-guide/proxy","slug":"/user-guide/proxy/mcp-tool-proxy","permalink":"/docs/user-guide/proxy/mcp-tool-proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.7.0.3/user-guide/proxy/mcp-tool-proxy.md","tags":[],"version":"2.7.0.3","frontMatter":{"title":"McpTool Service Integration","keywords":["Mcp"],"description":"McpTool Service Integration"},"sidebar":"tutorialSidebar","previous":{"title":"Http Proxy","permalink":"/docs/user-guide/proxy/http-proxy"},"next":{"title":"Motan Proxy","permalink":"/docs/user-guide/proxy/motan-proxy"}}');var i=r(74848),t=r(28453);const s={title:"McpTool Service Integration",keywords:["Mcp"],description:"McpTool Service Integration"},c=void 0,a={},l=[{value:"Add mcpServer and proxy plugins in gateway",id:"add-mcpserver-and-proxy-plugins-in-gateway",level:2},{value:"Integrate mcpTool with the gateway (for springMvc)",id:"integrate-mcptool-with-the-gateway-for-springmvc",level:2},{value:"Example 1",id:"example-1",level:3},{value:"Example 2",id:"example-2",level:3},{value:"Example 3",id:"example-3",level:3},{value:"McpTool integration with gateway (Other Languages, Non-SpringMvc)",id:"mcptool-integration-with-gateway-other-languages-non-springmvc",level:2},{value:"User requests",id:"user-requests",level:2}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h2:"h2",h3:"h3",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["This document is intended to help the ",(0,i.jsx)(n.code,{children:"mcpTool"})," service access the ",(0,i.jsx)(n.code,{children:"Apache ShenYu"})," gateway. The ",(0,i.jsx)(n.code,{children:"Apache ShenYu"})," gateway uses the ",(0,i.jsx)(n.code,{children:"mcpServer"})," plugin to connect with ",(0,i.jsx)(n.code,{children:"mcpTool"})," services."]}),"\n",(0,i.jsxs)(n.p,{children:["Before the connection, start ",(0,i.jsx)(n.code,{children:"shenyu-admin"})," correctly, start  ",(0,i.jsx)(n.code,{children:"mcpServer"})," plugin and add related dependencies on the gateway and ",(0,i.jsx)(n.code,{children:"mcpTool"})," application client service side. You can refer to the previous ",(0,i.jsx)(n.a,{href:"../../quick-start/quick-start-McpServer",children:"Quick Start with McpServer"}),"."]}),"\n",(0,i.jsxs)(n.p,{children:["For details about client access configuration, see ",(0,i.jsx)(n.a,{href:"/docs/user-guide/property-config/register-center-access",children:"Application Client Access Config"})," ."]}),"\n",(0,i.jsxs)(n.p,{children:["For details about data synchronization configurations, see ",(0,i.jsx)(n.a,{href:"/docs/user-guide/property-config/use-data-sync",children:"Data Synchronization Config"})," ."]}),"\n",(0,i.jsx)(n.h2,{id:"add-mcpserver-and-proxy-plugins-in-gateway",children:"Add mcpServer and proxy plugins in gateway"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Add the following dependencies to the gateway\u2019s ",(0,i.jsx)(n.code,{children:"pom.xml"})," file:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"    \x3c!--Mcp Server Plugin Start--\x3e\n    <dependency>\n        <groupId>org.apache.shenyu</groupId>\n        <artifactId>shenyu-spring-boot-starter-plugin-mcp-server</artifactId>\n        <version>${project.version}</version>\n    </dependency>\n    \x3c!--Mcp Server Plugin End--\x3e\n"})}),"\n",(0,i.jsx)(n.h2,{id:"integrate-mcptool-with-the-gateway-for-springmvc",children:"Integrate mcpTool with the gateway (for springMvc)"}),"\n",(0,i.jsxs)(n.p,{children:["Refer to the example project: ",(0,i.jsx)(n.a,{href:"https://github.com/apache/shenyu/tree/master/shenyu-examples/shenyu-examples-mcp",children:"shenyu-examples-mcp"})]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"SpringBoot"})," Users"]}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:["Add the following dependencies to your ",(0,i.jsx)(n.code,{children:"mcpTool"})," service\u2019s ",(0,i.jsx)(n.code,{children:"pom.xml"})," file:"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-spring-boot-starter-client-mcp</artifactId>\n    <version>${shenyu.version}</version>\n</dependency>\n"})}),"\n",(0,i.jsxs)(n.ol,{start:"2",children:["\n",(0,i.jsxs)(n.li,{children:["Add the following configuration in ",(0,i.jsx)(n.code,{children:"application.yaml"}),":"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"shenyu:\n  register:\n    registerType: http #zookeeper #etcd #nacos #consul\n    serverLists: http://localhost:9095 #localhost:2181 #http://localhost:2379 #localhost:8848\n    props:\n      username: admin\n      password: 123456\n  client:\n    mcp:\n      props:\n        contextPath: /mcp\n        appName: mcp\n"})}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"Spring"})," Users"]}),"\n",(0,i.jsxs)(n.p,{children:["Add the following dependencies to your HTTP service\u2019s ",(0,i.jsx)(n.code,{children:"pom.xml"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-client-mcp</artifactId>\n    <version>${shenyu.version}</version>\n</dependency>\n"})}),"\n",(0,i.jsx)(n.p,{children:"Then add the following bean definitions to your XML configuration file:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:'<bean id="clientConfig" class="org.apache.shenyu.register.common.config.PropertiesConfig">\n    <property name="props">\n      <map>\n        <entry key="contextPath" value="/yourContextPath"/>\n        <entry key="appName" value="yourAppName"/>\n      </map>\n    </property>\n</bean>\n\n<bean id="shenyuRegisterCenterConfig" class="org.apache.shenyu.register.common.config.ShenyuRegisterCenterConfig">\n   <property name="registerType" value="http"/>\n   <property name="serverList" value="http://localhost:9095"/>\n</bean>\n\n<bean id="shenyuClientRegisterRepository" class="org.apache.shenyu.client.core.register.ShenyuClientRegisterRepositoryFactory" factory-method="newInstance">\n       <property name="shenyuRegisterCenterConfig" ref="shenyuRegisterCenterConfig"/>\n </bean>\n\n<bean id="McpServiceEventListener" class="org.apache.shenyu.client.mcp.McpServiceEventListener">\n   <constructor-arg name="clientConfig" ref="clientConfig"/>\n   <constructor-arg name="shenyuClientRegisterRepository" ref="shenyuClientRegisterRepository"/>\n   <constructor-arg name="env" ref="environment"/>  \n</bean>\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Add the ",(0,i.jsx)(n.code,{children:"@ShenyuMcpTool"})," annotations to your controller interfaces."]}),"\n",(0,i.jsxs)(n.p,{children:["You need to add the ",(0,i.jsx)(n.code,{children:"@ShenyuMcpTool"})," annotation on the ",(0,i.jsx)(n.code,{children:"Controller"})," class. Only controllers annotated with ",(0,i.jsx)(n.code,{children:"@ShenyuMcpTool"})," will be recognized as ",(0,i.jsx)(n.code,{children:"mcpTool"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h3,{id:"example-1",children:"Example 1"}),"\n",(0,i.jsx)(n.p,{children:"This example demonstrates full McpTool configuration. You can fully customize your configuration by annotations, including parameter information defined in the operation."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@GetMapping("/findById")\n@ShenyuMcpTool(\n        operation = @Operation(\n                method = "GET", description = "find order by id"\n        ),\n        requestConfig = @ShenyuMcpRequestConfig(\n                bodyToJson = "false",\n                headers = {\n                        @ShenyuMcpHeader(key = "aaa", value = "bbb")\n                }\n        ),\n        enabled = true, toolName = "findOrderById"\n)\n@ApiDoc(desc = "findById")\npublic OrderDTO findById(@ShenyuMcpToolParam(\n        parameter = @Parameter(\n                name = "id",\n                in = ParameterIn.PATH,\n                description = "the id of order",\n                required = true,\n                schema = @Schema(\n                        type = "string",\n                        defaultValue = "1"\n                )\n        )\n) @RequestParam("id") final String id) {\n        OrderDTO dto = new OrderDTO();\n        dto.setId(id);\n        return dto;\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-2",children:"Example 2"}),"\n",(0,i.jsx)(n.p,{children:"This example shows the configuration for a McpTool function without parameters."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@GetMapping("/findAll")\n@ShenyuMcpTool(\n        operation = @Operation(\n                method = "GET", description = "find all order"\n        ),\n        requestConfig = @ShenyuMcpRequestConfig(\n                bodyToJson = "false",\n                headers = {\n                        @ShenyuMcpHeader(key = "aaa", value = "bbb")\n                }\n        ),\n        enabled = true, toolName = "findAllOrder"\n)\n@ApiDoc(desc = "findAll")\npublic String findAll() {\n        return "hello apache shenyu , mcp findAll success";\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"example-3",children:"Example 3"}),"\n",(0,i.jsxs)(n.p,{children:["This is a simplified usage that requires only a simple annotation to register the ",(0,i.jsx)(n.code,{children:"McpTool"})," to the gateway."]}),"\n",(0,i.jsxs)(n.blockquote,{children:["\n",(0,i.jsxs)(n.p,{children:["Special note: Currently only supports ",(0,i.jsx)(n.code,{children:"@RequestMapping"}),", ",(0,i.jsx)(n.code,{children:"@GetMapping"}),", ",(0,i.jsx)(n.code,{children:"@PostMapping"}),", ",(0,i.jsx)(n.code,{children:"@DeleteMapping"}),", and ",(0,i.jsx)(n.code,{children:"@PutMapping"})," annotations. Only the first path of the ",(0,i.jsx)(n.code,{children:"@XXXMapping"})," annotation is effective."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:'@GetMapping("/findByName")\n@ShenyuMcpTool\n@ApiDoc(desc = "findName")\npublic OrderDTO findByName(@ShenyuMcpToolParam final String name) {\n        OrderDTO dto = new OrderDTO();\n        dto.setName(name);\n        return dto;\n}\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["Start your project. Your service interfaces will be connected to the gateway. In the ",(0,i.jsx)(n.code,{children:"shenyu-admin"})," backend management system, go to ",(0,i.jsx)(n.code,{children:"Plugin List -> HTTP process -> mcpServer"}),", and you will see the automatically created endpoints and Tools."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"mcptool-integration-with-gateway-other-languages-non-springmvc",children:"McpTool integration with gateway (Other Languages, Non-SpringMvc)"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["First, find the ",(0,i.jsx)(n.code,{children:"mcpServer"})," plugin in ",(0,i.jsx)(n.code,{children:"shenyu-admin"}),", then add selectors and rules to filter traffic accordingly."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If you are unsure how to configure, please refer to ",(0,i.jsx)(n.a,{href:"../admin-usage/selector-and-rule",children:"Selector and Rule Management"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"user-requests",children:"User requests"}),"\n",(0,i.jsxs)(n.p,{children:["After your ",(0,i.jsx)(n.code,{children:"mcpTool"})," service is connected to the ",(0,i.jsx)(n.code,{children:"Apache ShenYu"})," gateway, you can use the ",(0,i.jsx)(n.code,{children:"endPoint"})," configured in the ",(0,i.jsx)(n.code,{children:"Selector"})," as the request interface for your ",(0,i.jsx)(n.code,{children:"McpClient"}),"."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Firstly, the domain name of your previous ",(0,i.jsx)(n.code,{children:"endPoint"})," was your own service; now it should be replaced with the gateway\u2019s domain name."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Secondly, the ",(0,i.jsx)(n.code,{children:"Apache ShenYu"})," gateway requires a route prefix configured as the ",(0,i.jsx)(n.code,{children:"contextPath"})," in your integration project."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["In the ",(0,i.jsx)(n.code,{children:"mcpServer"})," plugin, this ",(0,i.jsx)(n.code,{children:"contextPath"})," corresponds to your ",(0,i.jsx)(n.code,{children:"endPoint"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["For example, if you configured ",(0,i.jsx)(n.code,{children:"contextPath"})," as ",(0,i.jsx)(n.code,{children:"mcp"}),", then your ",(0,i.jsx)(n.code,{children:"endPoint"})," should be configured as: ",(0,i.jsx)(n.code,{children:"http://localhost:9195/mcp/sse"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Here, ",(0,i.jsx)(n.code,{children:"localhost:9195"})," is the IP and port of your gateway (default port is ",(0,i.jsx)(n.code,{children:"9195"}),"), and ",(0,i.jsx)(n.code,{children:"/mcp"})," is the ",(0,i.jsx)(n.code,{children:"contextPath"})," configured during integration."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["Third, the mcpServer plugin does not include request forwarding functionality. To perform remote tool invocation, please enable the corresponding proxy plugin for proxying. You can refer to ",(0,i.jsx)(n.a,{href:"../../quick-start/quick-start-McpServer",children:"Quick Start with McpServer"}),"."]}),"\n"]}),"\n"]}),"\n",(0,i.jsxs)(n.p,{children:["Then you can invoke tools via the ",(0,i.jsx)(n.code,{children:"mcpClient"})," through the gateway easily."]})]})}function p(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},28453(e,n,r){r.d(n,{R:()=>s,x:()=>c});var o=r(96540);const i={},t=o.createContext(i);function s(e){const n=o.useContext(t);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),o.createElement(t.Provider,{value:n},e.children)}}}]);