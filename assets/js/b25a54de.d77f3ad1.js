"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[57519],{2776:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/jwt-plugin-close_en-47c04e90a85f27746b2a9b3e771de5a9.jpg"},15108:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/jwt-plugin-selector-config-en-73506b6e96a35eac7fe268145cebbc3b.jpg"},28453:(e,n,i)=>{i.d(n,{R:()=>r,x:()=>c});var t=i(96540);const s={},l=t.createContext(s);function r(e){const n=t.useContext(l);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),t.createElement(l.Provider,{value:n},e.children)}},30286:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/jwt-plugin-config-en-41fdb635e52370b6882c09741a0c29aa.jpg"},36867:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/plugin_use_en-8b5661551cdf92fdabc9cb2e7947cffc.jpg"},65790:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/jwt-web-428e7d369c17035e0daa838740150227.jpg"},87741:(e,n,i)=>{i.d(n,{A:()=>t});const t=i.p+"assets/images/jwt-plugin-rule-handle-en-3efcc377c242e0047edd129a535d50d5.jpg"},99830:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>u,frontMatter:()=>l,metadata:()=>c,toc:()=>o});var t=i(74848),s=i(28453);const l={title:"JWT plugin",keywords:["JWT"],description:"JWT plugin"},r="1. Overview",c={id:"plugin-center/security/jwt-plugin",title:"JWT plugin",description:"JWT plugin",source:"@site/versioned_docs/version-2.7.0.3/plugin-center/security/jwt-plugin.md",sourceDirName:"plugin-center/security",slug:"/plugin-center/security/jwt-plugin",permalink:"/docs/plugin-center/security/jwt-plugin",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.7.0.3/plugin-center/security/jwt-plugin.md",tags:[],version:"2.7.0.3",frontMatter:{title:"JWT plugin",keywords:["JWT"],description:"JWT plugin"},sidebar:"tutorialSidebar",previous:{title:"CryptorResponse plugin",permalink:"/docs/plugin-center/security/cryptor-response-plugin"},next:{title:"OAuth2 Plugin",permalink:"/docs/plugin-center/security/oauth2-plugin"}},d={},o=[{value:"1.1 Plugin Name",id:"11-plugin-name",level:2},{value:"1.2 Appropriate Scenario",id:"12-appropriate-scenario",level:2},{value:"1.3 Plugin functionality",id:"13-plugin-functionality",level:2},{value:"1.4 Plugin code",id:"14-plugin-code",level:2},{value:"1.5 Added Since Which shenyu version",id:"15-added-since-which-shenyu-version",level:2},{value:"2.1 Plugin-use procedure chart",id:"21-plugin-use-procedure-chart",level:2},{value:"2.2 Import pom",id:"22-import-pom",level:2},{value:"2.3 Enable plugin",id:"23-enable-plugin",level:2},{value:"2.4 Config plugin",id:"24-config-plugin",level:2},{value:"2.4.1 Config plugin in ShenYu-Admin",id:"241-config-plugin-in-shenyu-admin",level:3},{value:"2.4.2 Selector config",id:"242-selector-config",level:3},{value:"2.4.3 Rule Config",id:"243-rule-config",level:3},{value:"2.5 Examples",id:"25-examples",level:2},{value:"2.5.1 Use jwt token for authentication judgment",id:"251-use-jwt-token-for-authentication-judgment",level:3},{value:"2.5.1.1 Config jwt-plugin",id:"2511-config-jwt-plugin",level:4},{value:"2.5.1.2 Config selector match service",id:"2512-config-selector-match-service",level:4},{value:"2.5.1.3 Config rule match service",id:"2513-config-rule-match-service",level:4},{value:"2.5.1.4 Generate json web token(jwt) with website",id:"2514-generate-json-web-tokenjwt-with-website",level:4},{value:"2.5.1.5 Generate json web token(jwt) with java code",id:"2515-generate-json-web-tokenjwt-with-java-code",level:4},{value:"2.5.1.6 Request Service",id:"2516-request-service",level:4},{value:"2.5.1.6.1 Request service with token",id:"25161-request-service-with-token",level:5},{value:"2.5.1.6.2 Request service Authorization",id:"25162-request-service-authorization",level:5},{value:"2.5.1.7 Validate request result",id:"2517-validate-request-result",level:4}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.h1,{id:"1-overview",children:"1. Overview"}),"\n",(0,t.jsx)(n.h2,{id:"11-plugin-name",children:"1.1 Plugin Name"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"jwt"})," plugin"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"12-appropriate-scenario",children:"1.2 Appropriate Scenario"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Requires unified authentication by jwt at the gateway."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"13-plugin-functionality",children:"1.3 Plugin functionality"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["The ",(0,t.jsx)(n.code,{children:"jwt"})," plug-in is for the ",(0,t.jsx)(n.code,{children:"token"})," attribute or ",(0,t.jsx)(n.code,{children:"authorization"})," of the http request header to carry the attribute value for authentication judgment and judge ",(0,t.jsx)(n.code,{children:"OAuth2.0"})," ."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"14-plugin-code",children:"1.4 Plugin code"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Core module is ",(0,t.jsx)(n.code,{children:"shenyu-plugin-jwt"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Core class is ",(0,t.jsx)(n.code,{children:"org.apache.shenyu.plugin.jwt.JwtPlugin"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"15-added-since-which-shenyu-version",children:"1.5 Added Since Which shenyu version"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Since ShenYu 2.4.0"}),"\n"]}),"\n",(0,t.jsx)(n.h1,{id:"2how-to-use-plugin",children:"2.How to use plugin"}),"\n",(0,t.jsx)(n.h2,{id:"21-plugin-use-procedure-chart",children:"2.1 Plugin-use procedure chart"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(36867).A+"",width:"343",height:"964"})}),"\n",(0,t.jsx)(n.h2,{id:"22-import-pom",children:"2.2 Import pom"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-xml",children:"<dependency>\n    <groupId>org.apache.shenyu</groupId>\n    <artifactId>shenyu-spring-boot-starter-plugin-jwt</artifactId>\n    <version>${project.version}</version>\n</dependency>\n"})}),"\n",(0,t.jsx)(n.h2,{id:"23-enable-plugin",children:"2.3 Enable plugin"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"In shenyu-admin --\x3e BasicConfig --\x3e Plugin --\x3e jwt set Status enable."}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"24-config-plugin",children:"2.4 Config plugin"}),"\n",(0,t.jsx)(n.h3,{id:"241-config-plugin-in-shenyu-admin",children:"2.4.1 Config plugin in ShenYu-Admin"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Config secretKey of jwt-plugin in shenyu-admin, the secretKey must more than 256 bit."}),"\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.code,{children:"secretKey"}),": The private key when using ",(0,t.jsx)(n.code,{children:"jwt"})," to generate ",(0,t.jsx)(n.code,{children:"token"}),", it is required."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(30286).A+"",width:"2256",height:"1279"})}),"\n",(0,t.jsx)(n.h3,{id:"242-selector-config",children:"2.4.2 Selector config"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Selector and rule Config. Please refer: ",(0,t.jsx)(n.a,{href:"/docs/user-guide/admin-usage/selector-and-rule",children:"Selector and rule config"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"243-rule-config",children:"2.4.3 Rule Config"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(87741).A+"",width:"2256",height:"1279"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"convert means jwt converter"}),"\n",(0,t.jsx)(n.li,{children:"jwtVal: jwt of body name"}),"\n",(0,t.jsx)(n.li,{children:"headerVal: jwt header name"}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["custom covert algorithm\uff1a",(0,t.jsx)(n.a,{href:"/docs/developer/custom-jwt-covert-algorithm",children:"custom-jwt-covert-algorithm"})]}),"\n",(0,t.jsx)(n.h2,{id:"25-examples",children:"2.5 Examples"}),"\n",(0,t.jsx)(n.h3,{id:"251-use-jwt-token-for-authentication-judgment",children:"2.5.1 Use jwt token for authentication judgment"}),"\n",(0,t.jsx)(n.h4,{id:"2511-config-jwt-plugin",children:"2.5.1.1 Config jwt-plugin"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(30286).A+"",width:"2256",height:"1279"})}),"\n",(0,t.jsx)(n.h4,{id:"2512-config-selector-match-service",children:"2.5.1.2 Config selector match service"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(15108).A+"",width:"2256",height:"1279"})}),"\n",(0,t.jsx)(n.h4,{id:"2513-config-rule-match-service",children:"2.5.1.3 Config rule match service"}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(87741).A+"",width:"2256",height:"1279"})}),"\n",(0,t.jsx)(n.h4,{id:"2514-generate-json-web-tokenjwt-with-website",children:"2.5.1.4 Generate json web token(jwt) with website"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["You can open ",(0,t.jsx)(n.code,{children:"https://jwt.io/"})," in your browser and fill in the corresponding parameters."]}),"\n",(0,t.jsxs)(n.li,{children:["Config jwt header ",(0,t.jsx)(n.code,{children:"HEADER"})," in ",(0,t.jsx)(n.code,{children:"https://jwt.io/"})]}),"\n",(0,t.jsxs)(n.li,{children:["Config jwt body ",(0,t.jsx)(n.code,{children:"PAYLOAD"})," in ",(0,t.jsx)(n.code,{children:"https://jwt.io/"})]}),"\n",(0,t.jsxs)(n.li,{children:["Config jwt signature ",(0,t.jsx)(n.code,{children:"VERIFY SIGNATURE"})," in ",(0,t.jsx)(n.code,{children:"https://jwt.io/"})]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(65790).A+"",width:"2230",height:"1279"})}),"\n",(0,t.jsx)(n.h4,{id:"2515-generate-json-web-tokenjwt-with-java-code",children:"2.5.1.5 Generate json web token(jwt) with java code"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-java",children:'public final class JwtPluginTest {\n    \n  public void generateJwtCode() {\n    final String secreteKey = "shenyu-test-shenyu-test-shenyu-test";\n    Map<String, String> map = new HashMap<>();\n    map.put("id", "1");\n    map.put("name", "xiaoming");\n    Date date = new Date();\n    date.setTime(1655524800000L);\n    String token = Jwts.builder()\n            .setIssuedAt(date)\n            .setExpiration(new Date())\n            .setClaims(map)\n            .signWith(Keys.hmacShaKeyFor(secreteKey.getBytes(StandardCharsets.UTF_8)), SignatureAlgorithm.HS256)\n            .compact();\n    System.out.println(token);\n  }\n}\n'})}),"\n",(0,t.jsx)(n.h4,{id:"2516-request-service",children:"2.5.1.6 Request Service"}),"\n",(0,t.jsx)(n.h5,{id:"25161-request-service-with-token",children:"2.5.1.6.1 Request service with token"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["request your service with jwt token ",(0,t.jsx)(n.code,{children:"token: eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoieGlhb21pbmciLCJpZCI6IjEifQ.LdRzGlB49alhq204chwF7pf3C0z8ZpuowPvoQdJmSRw"})," in your request header."]}),"\n"]}),"\n",(0,t.jsx)(n.h5,{id:"25162-request-service-authorization",children:"2.5.1.6.2 Request service Authorization"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["request your service with Authorization ",(0,t.jsx)(n.code,{children:"Authorization: Bearer eyJhbGciOiJIUzI1NiJ9.eyJuYW1lIjoieGlhb21pbmciLCJpZCI6IjEifQ.LdRzGlB49alhq204chwF7pf3C0z8ZpuowPvoQdJmSRw"})," in your request header."]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"2517-validate-request-result",children:"2.5.1.7 Validate request result"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"error token request result"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'{\n  "code": 401,\n  "message": "Illegal authorization"\n}\n'})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"normal token request result"}),"\n"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{children:'{\n  "id": "123",\n  "name": "hello world save order"\n}\n'})}),"\n",(0,t.jsx)(n.h1,{id:"3-how-to-disable-plugin",children:"3. How to disable plugin"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["In ",(0,t.jsx)(n.code,{children:"shenyu-admin"})," --\x3e BasicConfig --\x3e Plugin --\x3e ",(0,t.jsx)(n.code,{children:"jwt"})," set Status disable."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(2776).A+"",width:"2256",height:"1279"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(h,{...e})}):h(e)}}}]);