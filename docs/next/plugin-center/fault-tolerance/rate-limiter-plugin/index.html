<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.4">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Apache ShenYu Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Apache ShenYu Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Apache ShenYu" href="/opensearch.xml">
<link rel="alternate" type="application/rss+xml" href="/news/rss.xml" title="Apache ShenYu Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/news/atom.xml" title="Apache ShenYu Blog Atom Feed"><title data-react-helmet="true">RateLimiter Plugin | Apache ShenYu</title><meta data-react-helmet="true" property="og:url" content="https://shenyu.apache.org//docs/next/plugin-center/fault-tolerance/rate-limiter-plugin"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="RateLimiter Plugin | Apache ShenYu"><meta data-react-helmet="true" name="description" content="rateLimiter plugin"><meta data-react-helmet="true" property="og:description" content="rateLimiter plugin"><meta data-react-helmet="true" name="keywords" content="rateLimiter"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.svg"><link data-react-helmet="true" rel="canonical" href="https://shenyu.apache.org//docs/next/plugin-center/fault-tolerance/rate-limiter-plugin"><link data-react-helmet="true" rel="alternate" href="https://shenyu.apache.org//docs/next/plugin-center/fault-tolerance/rate-limiter-plugin" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://shenyu.apache.org//zh/docs/next/plugin-center/fault-tolerance/rate-limiter-plugin" hreflang="zh"><link data-react-helmet="true" rel="alternate" href="https://shenyu.apache.org//docs/next/plugin-center/fault-tolerance/rate-limiter-plugin" hreflang="x-default"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link rel="stylesheet" href="/assets/css/styles.6bd5fa92.css">
<link rel="preload" href="/assets/js/runtime~main.8000fcde.js" as="script">
<link rel="preload" href="/assets/js/main.841fc6e2.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><img src="/img/logo.svg" alt="Apache ShenYu Logo" class="themedImage_TMUO themedImage--light_4Vu1 navbar__logo"><img src="/img/logo-light.svg" alt="Apache ShenYu Logo" class="themedImage_TMUO themedImage--dark_uzRr navbar__logo"></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/download">Download</a><a class="navbar__item navbar__link" href="/document">Docs</a><a class="navbar__item navbar__link" href="/community/contributor-guide">Community</a><a class="navbar__item navbar__link" href="/team">Team</a><a class="navbar__item navbar__link" href="/event">Event</a><a class="navbar__item navbar__link" href="/news">News</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a class="navbar__item navbar__link" href="/users">Users</a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a class="navbar__item navbar__link">ASF</a><ul class="dropdown__menu"><li><a href="https://www.apache.org/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Foundation</a></li><li><a href="https://www.apache.org/licenses/" target="_blank" rel="noopener noreferrer" class="dropdown__link">License</a></li><li><a href="https://www.apache.org/events/current-event" target="_blank" rel="noopener noreferrer" class="dropdown__link">Events</a></li><li><a href="https://www.apache.org/security/" target="_blank" rel="noopener noreferrer" class="dropdown__link">Security</a></li><li><a href="https://www.apache.org/foundation/sponsorship.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Sponsorship</a></li><li><a href="https://www.apache.org/foundation/policies/privacy.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Privacy</a></li><li><a href="https://www.apache.org/foundation/thanks.html" target="_blank" rel="noopener noreferrer" class="dropdown__link">Thanks</a></li></ul></div><a href="https://github.com/apache/shenyu" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="navbar__item dropdown dropdown--hoverable dropdown--right"><a href="#" class="navbar__item navbar__link"><span><svg t="1631348384596" class="icon" viewBox="0 0 1024 1024" version="1.1" style="vertical-align:text-bottom;margin-right:5px" p-id="557" width="20" height="20"><path d="M547.797333 638.208l-104.405333-103.168 1.237333-1.28a720.170667 720.170667 0 0 0 152.490667-268.373333h120.448V183.082667h-287.744V100.906667H347.605333v82.218666H59.818667V265.386667h459.178666a648.234667 648.234667 0 0 1-130.304 219.946666 643.242667 643.242667 0 0 1-94.976-137.728H211.541333a722.048 722.048 0 0 0 122.453334 187.434667l-209.194667 206.378667 58.368 58.368 205.525333-205.525334 127.872 127.829334 31.232-83.84m231.424-208.426667h-82.218666l-184.96 493.312h82.218666l46.037334-123.306667h195.242666l46.464 123.306667h82.218667l-185.002667-493.312m-107.690666 287.744l66.56-178.005333 66.602666 178.005333z" fill="currentColor" p-id="558"></path></svg><span>English</span></span></a><ul class="dropdown__menu"><li><a href="/docs/next/plugin-center/fault-tolerance/rate-limiter-plugin" target="_self" rel="noopener noreferrer" class="dropdown__link dropdown__link--active" style="text-transform:capitalize">English</a></li><li><a href="/zh/docs/next/plugin-center/fault-tolerance/rate-limiter-plugin" target="_self" rel="noopener noreferrer" class="dropdown__link" style="text-transform:capitalize">ç®€ä½“ä¸­æ–‡</a></li></ul></div><div class="react-toggle toggle_2i4l react-toggle--disabled"><div class="react-toggle-track" role="button" tabindex="-1"><div class="react-toggle-track-check"><span class="toggle_iYfV">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_iYfV">ðŸŒž</span></div><div class="react-toggle-thumb"></div></div><input type="checkbox" class="react-toggle-screenreader-only" aria-label="Switch between dark and light mode"></div><div class="searchBox_Bc3W"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper doc-page"><div class="docPage_lDyR"><button class="clean-btn backToTopButton_i9tI" type="button" title="Scroll to top"><svg viewBox="0 0 24 24" width="28"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z" fill="currentColor"></path></svg></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh menuWithAnnouncementBar_+O1J"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/docs/next/index">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Design</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Deployment</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quick Start</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">User Guide</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Plugin Center</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Http Process</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Proxy</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#" tabindex="0">Fault Tolerance</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/plugin-center/fault-tolerance/hystrix-plugin">Hystrix Plugin</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/docs/next/plugin-center/fault-tolerance/rate-limiter-plugin">RateLimiter Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/plugin-center/fault-tolerance/resilience4j-plugin">Resilience4j Plugin</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/next/plugin-center/fault-tolerance/sentinel-plugin">Sentinel Plugin</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Security</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Observability</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Common</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Cache</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Mock</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">discovery</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Developer</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Benchmark Test</a></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="alert alert--warning margin-bottom--md" role="alert"><div>This is unreleased documentation for Apache ShenYu <b>Next</b> version.</div><div class="margin-top--md">For up-to-date documentation, see the <b><a href="/docs/plugin-center/fault-tolerance/rate-limiter-plugin">latest version</a></b> (2.6.0).</div></div><div class="docItemContainer_oiyr"><article><span class="badge badge--secondary">Version: Next</span><div class="tocCollapsible_aw-L tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="markdown"><header><h1 class="h1Heading_dC7a">1. Overview</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="11-plugin-name"></a>1.1 Plugin Name<a class="hash-link" href="#11-plugin-name" title="Direct link to heading">#</a></h2><ul><li>RateLimiter Plugin</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="12-appropriate-scenario"></a>1.2 Appropriate Scenario<a class="hash-link" href="#12-appropriate-scenario" title="Direct link to heading">#</a></h2><ul><li>traffic control in gateway cluster environment</li><li>rate limiting according to specific rules</li><li>You can set to the interface level, or the parameter level. How to use it depends on your traffic configuration.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="13-plugin-functionality"></a>1.3 Plugin functionality<a class="hash-link" href="#13-plugin-functionality" title="Direct link to heading">#</a></h2><ul><li>use redis to control gateway traffic</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="14-plugin-code"></a>1.4 Plugin code<a class="hash-link" href="#14-plugin-code" title="Direct link to heading">#</a></h2><ul><li><p>Core Module <code>shenyu-plugin-ratelimiter</code>.</p></li><li><p>Core Class <code>org.apache.shenyu.plugin.ratelimiter.RateLimiterPlugin</code></p></li><li><p>Core Class <code>org.apache.shenyu.plugin.ratelimiter.executor.RedisRateLimiter</code></p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="15-added-since-which-shenyu-version"></a>1.5 Added Since Which shenyu version<a class="hash-link" href="#15-added-since-which-shenyu-version" title="Direct link to heading">#</a></h2><ul><li>Since ShenYu 2.4.0</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="16-technical-solution"></a>1.6 Technical Solution<a class="hash-link" href="#16-technical-solution" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="161-using-redis-token-bucket-algorithm-to-limit-traffic"></a>1.6.1 Using redis token bucket algorithm to limit traffic.<a class="hash-link" href="#161-using-redis-token-bucket-algorithm-to-limit-traffic" title="Direct link to heading">#</a></h3><ul><li>The system generates the token at a constant rate, and then puts the token into the token bucket.</li><li>The token bucket&#x27;s capacity. When the bucket is full, the token put into it will be discarded.</li><li>Each time requests come, you need to obtain a token from the token bucket. If there are tokens, the service will be provided; if there are no tokens, the service will be rejected.</li></ul><ul><li>Flow Diagramï¼š
<img src="/assets/images/tokenbucket-a11a51776844dc57cb9ba82904dc4ca6.png"></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="162-using-redis-leaky-bucket-algorithm-to-limit-traffic"></a>1.6.2 Using redis leaky bucket algorithm to limit traffic.<a class="hash-link" href="#162-using-redis-leaky-bucket-algorithm-to-limit-traffic" title="Direct link to heading">#</a></h3><ul><li>water (request) go to the leaky bucket first. The leaky bucket goes out at a fixed speed. When the flow speed is too fast, it will overflow directly (reject service)</li></ul><ul><li>Flow Diagramï¼š
<img src="/assets/images/leakybucket-cc829d5529e0847152a90793867e9f96.png"></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="163-using-redis-sliding-time-window-algorithm-to-limit-traffic"></a>1.6.3 Using redis sliding time window algorithm to limit traffic.<a class="hash-link" href="#163-using-redis-sliding-time-window-algorithm-to-limit-traffic" title="Direct link to heading">#</a></h3><ul><li>The sliding time window maintains the count value of unit time. Whenever a requests pass, the count value will be increased by 1. When the count value exceeds the preset threshold, other requests in unit time will be rejected. If the unit time has ended, clear the counter to zero and start the next round counting.</li></ul><ul><li>Flow Diagramï¼š
<img src="/assets/images/sldingwindow-c529b50727afb275845585edb72b0215.png"></li></ul><header><h1 class="h1Heading_dC7a">2. How to use plugin</h1></header><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="21-plugin-use-procedure"></a>2.1 Plugin-use procedure<a class="hash-link" href="#21-plugin-use-procedure" title="Direct link to heading">#</a></h2><p><img src="/assets/images/plugin_use_en-8b5661551cdf92fdabc9cb2e7947cffc.jpg"></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="22-import-pom"></a>2.2 Import pom<a class="hash-link" href="#22-import-pom" title="Direct link to heading">#</a></h2><ul><li>Add <code>rateLimiter</code> dependency in <code>pom.xml</code> file of the gateway.</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI xml"><pre tabindex="0" class="prism-code language-xml codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- apache shenyu ratelimiter plugin start--&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">org.apache.shenyu</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">groupId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">shenyu-spring-boot-starter-plugin-ratelimiter</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">artifactId</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain">${project.version}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">version</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">dependency</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">&lt;!-- apache shenyu ratelimiter plugin end--&gt;</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="23-enable-plugin"></a>2.3 Enable plugin<a class="hash-link" href="#23-enable-plugin" title="Direct link to heading">#</a></h2><ul><li>In <code>shenyu-admin</code>--&gt; BasicConfig --&gt; Plugin --&gt; <code>rateLimiter</code> set to enable.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="24-config-plugin"></a>2.4 Config plugin<a class="hash-link" href="#24-config-plugin" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="241-plugin-config"></a>2.4.1 Plugin Config<a class="hash-link" href="#241-plugin-config" title="Direct link to heading">#</a></h3><p><img src="/assets/images/ratelimiter-plugin-en-db82d697a0e4dedda72274a7f72a80f3.png"></p><ul><li><p><code>mode</code>: the working mode of redis, the default is single-point mode: <code>standalone</code>, in addition to cluster
mode: <code>cluster</code>, sentinel mode: <code>sentinel</code>.</p></li><li><p><code>master</code>: default is master.</p></li><li><p><code>url</code>: configure the IP and port of the redis database, configured by colon connection, example: <code>192.168.1.1:6379</code>.</p></li><li><p><code>password</code>: the password of the redis database, if not, you can not configure.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="242-selector-config"></a>2.4.2 Selector Config<a class="hash-link" href="#242-selector-config" title="Direct link to heading">#</a></h3><ul><li>Selectors and rules, please refer to: <a href="/docs/next/user-guide/admin-usage/selector-and-rule">Selector And Rule Config</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="243-rule-config"></a>2.4.3 Rule Config<a class="hash-link" href="#243-rule-config" title="Direct link to heading">#</a></h3><p><img src="/assets/images/ratelimiter-plugin-rule-en-c977fc7840a3952eb0da74183290dedd.png"></p><ul><li><p>TokenBucket/Concurrent</p><ul><li><p><code>algorithmName</code>: <code>tokenBucket</code>/<code>concurrent</code>.</p></li><li><p><code>replenishRate</code>: It is how many requests you allow users to execute per second, while not discarding any requests. This is the filling rate of token bucket.</p></li><li><p><code>burstCapacity</code>: it is the maximum number of requests that users are allowed to execute in one second. This is token bucket can save the number of token.</p></li><li><p><code>keyResolverName</code>: <code>whole</code> indicates that the traffic is limited by gateway per second, and <code>remoteAddress</code> indicates that the traffic is limited by IP per second.</p></li></ul></li><li><p>LeakyBucket</p><ul><li><p><code>algorithmName</code>: <code>leakyBucket</code>.</p></li><li><p><code>replenishRate</code>: The rate at which requests are executed per unit time, and the rate at which water droplets leak out of the leaky bucket.</p></li><li><p><code>burstCapacity</code>: The maximum number of requests that users are allowed to execute in one second. This is the amount of water in the bucket.</p></li><li><p><code>keyResolverName</code>: <code>whole</code> indicates that the traffic is limited by gateway per second, and <code>remoteAddress</code> indicates that the traffic is limited by IP per second.</p></li></ul></li><li><p>SlidingWindow</p><ul><li><p><code>algorithmName</code>: <code>slidingWindow</code>.</p></li><li><p><code>replenishRate</code>: The rate of requests per unit time, used to calculate the size of the time window.</p></li><li><p><code>burstCapacity</code>: The maximum number of requests in the time window (per unit time).</p></li><li><p><code>keyResolverName</code>: <code>whole</code> indicates that the traffic is limited by gateway per second, and <code>remoteAddress</code> indicates that the traffic is limited by IP per second.</p></li></ul></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="25-examples"></a>2.5 Examples<a class="hash-link" href="#25-examples" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="251-limit-traffic-with-ratelimiter-plugin-in-gateway-cluster-environment"></a>2.5.1 Limit traffic with <code>RateLimiter</code> plugin in gateway cluster environment<a class="hash-link" href="#251-limit-traffic-with-ratelimiter-plugin-in-gateway-cluster-environment" title="Direct link to heading">#</a></h3><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="2511-preparation"></a>2.5.1.1 Preparation<a class="hash-link" href="#2511-preparation" title="Direct link to heading">#</a></h4><ul><li>Start ShenYu Admin on <code>10.10.10.10:9095</code></li><li>Start two ShenYu Bootstrap on <code>10.10.10.20:9195</code> and <code>10.10.10.30:9195</code>, and config data sync center on <code>10.10.10.10:9095</code></li><li>config nginx, for example:</li></ul><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI nginx"><pre tabindex="0" class="prism-code language-nginx codeBlock_rtdJ thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#393A34"><span class="token plain">upstream shenyu_gateway_cluster {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  ip_hash;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  server 10.1.1.1:9195 max_fails=3 fail_timeout=10s weight=50;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  server 10.1.1.2:9195 max_fails=3 fail_timeout=10s weight=50;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></span><span class="token-line" style="color:#393A34"><span class="token plain">server {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  location / {</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_pass http://shenyu_gateway_cluster;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_set_header HOST $host;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_read_timeout 10s;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">        proxy_connect_timeout 10s;</span></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="2512-pluginselectorrule-configuration"></a>2.5.1.2 Plugin/Selector/Rule Configuration<a class="hash-link" href="#2512-pluginselectorrule-configuration" title="Direct link to heading">#</a></h4><ul><li><p>config redis configuration with ratelimiter plugin</p></li><li><p>config selector</p></li><li><p>config rule</p></li></ul><p><img src="/assets/images/rule-example-en-77a21daeb9fb7e26a8cf802f41b2587d.png"></p><p>replenishRate is 3, burstCapacity is 10</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="2513-send-request-to-nginx-by-apache-jmeter"></a>2.5.1.3 Send Request to <code>Ngin</code>x by <code>Apache Jmeter</code><a class="hash-link" href="#2513-send-request-to-nginx-by-apache-jmeter" title="Direct link to heading">#</a></h4><ul><li>jmeter thread group configuration</li></ul><p><img src="/assets/images/jmeter-thread-group-d9b10e917818cec79120a61e3c3451b6.png"></p><ul><li>jmeter http request configuration</li></ul><p><img src="/assets/images/jmeter-http-request-0023ff8824d62685af80b3c2de6d40e4.png"></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_WiXH" id="2514-check-result"></a>2.5.1.4 Check Result<a class="hash-link" href="#2514-check-result" title="Direct link to heading">#</a></h4><p><img src="/assets/images/jmeter-result-cc7f6f7a1d678078ae3d3058b6d0afff.png"></p><header><h1 class="h1Heading_dC7a">3. How to disable plugin</h1></header><ul><li>In <code>shenyu-admin</code> --&gt; BasicConfig --&gt; Plugin --&gt; <code>rateLimiter</code> set Status disable.</li></ul></div><footer class="row docusaurus-mt-lg"><div class="col"><a href="https://github.com/apache/shenyu-website/edit/main/docs/plugin-center/fault-tolerance/rate-limiter-plugin.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_wj+Z"></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/next/plugin-center/fault-tolerance/hystrix-plugin"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Hystrix Plugin</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/next/plugin-center/fault-tolerance/resilience4j-plugin"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Resilience4j Plugin Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#11-plugin-name" class="table-of-contents__link">1.1 Plugin Name</a></li><li><a href="#12-appropriate-scenario" class="table-of-contents__link">1.2 Appropriate Scenario</a></li><li><a href="#13-plugin-functionality" class="table-of-contents__link">1.3 Plugin functionality</a></li><li><a href="#14-plugin-code" class="table-of-contents__link">1.4 Plugin code</a></li><li><a href="#15-added-since-which-shenyu-version" class="table-of-contents__link">1.5 Added Since Which shenyu version</a></li><li><a href="#16-technical-solution" class="table-of-contents__link">1.6 Technical Solution</a><ul><li><a href="#161-using-redis-token-bucket-algorithm-to-limit-traffic" class="table-of-contents__link">1.6.1 Using redis token bucket algorithm to limit traffic.</a></li><li><a href="#162-using-redis-leaky-bucket-algorithm-to-limit-traffic" class="table-of-contents__link">1.6.2 Using redis leaky bucket algorithm to limit traffic.</a></li><li><a href="#163-using-redis-sliding-time-window-algorithm-to-limit-traffic" class="table-of-contents__link">1.6.3 Using redis sliding time window algorithm to limit traffic.</a></li></ul></li><li><a href="#21-plugin-use-procedure" class="table-of-contents__link">2.1 Plugin-use procedure</a></li><li><a href="#22-import-pom" class="table-of-contents__link">2.2 Import pom</a></li><li><a href="#23-enable-plugin" class="table-of-contents__link">2.3 Enable plugin</a></li><li><a href="#24-config-plugin" class="table-of-contents__link">2.4 Config plugin</a><ul><li><a href="#241-plugin-config" class="table-of-contents__link">2.4.1 Plugin Config</a></li><li><a href="#242-selector-config" class="table-of-contents__link">2.4.2 Selector Config</a></li><li><a href="#243-rule-config" class="table-of-contents__link">2.4.3 Rule Config</a></li></ul></li><li><a href="#25-examples" class="table-of-contents__link">2.5 Examples</a><ul><li><a href="#251-limit-traffic-with-ratelimiter-plugin-in-gateway-cluster-environment" class="table-of-contents__link">2.5.1 Limit traffic with <code>RateLimiter</code> plugin in gateway cluster environment</a></li></ul></li></ul></div></div></div></div></main></div></div></div>
<script src="/assets/js/runtime~main.8000fcde.js"></script>
<script src="/assets/js/main.841fc6e2.js"></script>
</body>
</html>