"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[89772],{10035(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/rule-list-9a66ac71f764e2766fb7880c1811bae2.png"},28453(e,n,t){t.d(n,{R:()=>o,x:()=>c});var i=t(96540);const r={},s=i.createContext(r);function o(e){const n=i.useContext(s);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:o(e.components),i.createElement(s.Provider,{value:n},e.children)}},28489(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/postman-test-1bd985bc5b3dbe25e90f5c01d2ee1094.png"},35910(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/idea-http-test-proxy-fc83eddb6fa4a74cc790258ac670a8ec.png"},38383(e,n,t){t.d(n,{A:()=>i});const i=t.p+"assets/images/idea-http-test-local-bd2ea4b9e8ab5d867edc120e3946e00c.png"},57408(e,n,t){t.r(n),t.d(n,{assets:()=>a,contentTitle:()=>c,default:()=>u,frontMatter:()=>o,metadata:()=>i,toc:()=>l});const i=JSON.parse('{"id":"quick-start/quick-start-springcloud","title":"Quick start with Spring Cloud","description":"Quick start with SpringCloud","source":"@site/docs/quick-start/quick-start-springcloud.md","sourceDirName":"quick-start","slug":"/quick-start/quick-start-springcloud","permalink":"/docs/next/quick-start/quick-start-springcloud","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/shenyu-website/edit/main/docs/quick-start/quick-start-springcloud.md","tags":[],"version":"current","frontMatter":{"title":"Quick start with Spring Cloud","description":"Quick start with SpringCloud"},"sidebar":"tutorialSidebar","previous":{"title":"Quick start with Sofa","permalink":"/docs/next/quick-start/quick-start-sofa"},"next":{"title":"Quick start with Tars","permalink":"/docs/next/quick-start/quick-start-tars"}}');var r=t(74848),s=t(28453);const o={title:"Quick start with Spring Cloud",description:"Quick start with SpringCloud"},c=void 0,a={},l=[{value:"Environment to prepare",id:"environment-to-prepare",level:2},{value:"Startup sequence",id:"startup-sequence",level:2},{value:"Run <code>shenyu-examples-springcloud</code>",id:"run-shenyu-examples-springcloud",level:2},{value:"Configure the registration center related information on the admin side",id:"configure-the-registration-center-related-information-on-the-admin-side",level:2},{value:"Run the shenyu-examples-springcloud project",id:"run-the-shenyu-examples-springcloud-project",level:2},{value:"Test",id:"test",level:2}];function d(e){const n={a:"a",code:"code",h2:"h2",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(n.p,{children:["This document introduces how to quickly access the Apache ShenYu gateway using Spring Cloud. You can get the code example of this document by clicking ",(0,r.jsx)(n.a,{href:"https://github.com/apache/shenyu/tree/master/shenyu-examples/shenyu-examples-springcloud",children:"here"})," ."]}),"\n",(0,r.jsx)(n.h2,{id:"environment-to-prepare",children:"Environment to prepare"}),"\n",(0,r.jsxs)(n.p,{children:["Please refer to the operation and maintenance deployment content and choose a way to start ",(0,r.jsx)(n.code,{children:"shenyu-admin"}),". For example, start the ",(0,r.jsx)(n.code,{children:"Apache ShenYu"})," backend management system through ",(0,r.jsx)(n.a,{href:"../deployment/deployment-local",children:"local deployment"}),"."]}),"\n",(0,r.jsxs)(n.p,{children:["To start the gateway, if it is through source code, directly run ",(0,r.jsx)(n.code,{children:"ShenyuBootstrapApplication"})," in ",(0,r.jsx)(n.code,{children:"shenyu-bootstrap"}),"."]}),"\n",(0,r.jsx)(n.h2,{id:"startup-sequence",children:"Startup sequence"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["Start ",(0,r.jsx)(n.code,{children:"shenyu-admin"})]}),"\n",(0,r.jsxs)(n.li,{children:["Start ",(0,r.jsx)(n.code,{children:"shenyu-bootstrap"})]}),"\n",(0,r.jsxs)(n.li,{children:["Start the registration center, such as the ",(0,r.jsx)(n.code,{children:"eureka"})," project under ",(0,r.jsx)(n.code,{children:"shenyu-examples"})]}),"\n",(0,r.jsxs)(n.li,{children:["Configure ",(0,r.jsx)(n.code,{children:"shenyu-examples-springcloud"})," registration discovery"]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"shenyu:\n  discovery:\n    enable: true\n    type: eureka\n    serverList: ${eureka.client.serviceUrl.defaultZone}\n    registerPath: ${spring.application.name}\n    props:\n      nacosNameSpace: ShenyuRegisterCenter\n"})}),"\n",(0,r.jsxs)(n.h2,{id:"run-shenyu-examples-springcloud",children:["Run ",(0,r.jsx)(n.code,{children:"shenyu-examples-springcloud"})]}),"\n",(0,r.jsx)(n.h2,{id:"configure-the-registration-center-related-information-on-the-admin-side",children:"Configure the registration center related information on the admin side"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Currently, the SpringCloudPlugin plugin on Shenyu implements support for service discovery of the registry center. However, it is not possible to dynamically switch the registry center. In order to allow users to use the plugin more clearly and switch the configuration of the registry center more conveniently, shenyu supports developers to configure and switch the registry center on the admin page, thereby reducing the user's usage cost and experience."}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Specific operation process:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"Start shenyu-admin"}),"\n",(0,r.jsx)(n.li,{children:"Start shenyu-bootstrap"}),"\n",(0,r.jsx)(n.li,{children:"Start the registry center, such as the eureka project under shenyu-examples"}),"\n",(0,r.jsx)(n.li,{children:"Start shenyu-examples-springcloud under shenyu-examples"}),"\n",(0,r.jsx)(n.li,{children:"Configure the relevant information of the registry center on the admin system interface and click Confirm"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Take the eureka registry center configuration as an example to show how to configure the relevant information of the registry center on the page:"}),"\n",(0,r.jsx)("img",{src:"/img/shenyu/quick-start/springcloud/springCloud-dynamic-register-operate-en.png",width:"60%",height:"50%"}),"\n",(0,r.jsx)(n.p,{children:"As shown in the figure above, registerType indicates the type of registration center, and the following registration centers are supported:"}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsx)(n.li,{children:"eureka"}),"\n",(0,r.jsx)(n.li,{children:"nacos"}),"\n",(0,r.jsx)(n.li,{children:"zookeeper"}),"\n",(0,r.jsx)(n.li,{children:"apollo"}),"\n",(0,r.jsx)(n.li,{children:"consul"}),"\n",(0,r.jsx)(n.li,{children:"etcd"}),"\n",(0,r.jsx)(n.li,{children:"polaris"}),"\n",(0,r.jsx)(n.li,{children:"kubernetes"}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"serverLists indicates the IP address of the registration center, and props is the additional configuration items for the registration center, such as namespace, username, etc. After clicking OK, eureka is used as the registration center of springCloudPlugin."}),"\n",(0,r.jsx)(n.h2,{id:"run-the-shenyu-examples-springcloud-project",children:"Run the shenyu-examples-springcloud project"}),"\n",(0,r.jsxs)(n.p,{children:["In the example project we used ",(0,r.jsx)(n.code,{children:"Eureka"})," as the registry for ",(0,r.jsx)(n.code,{children:"Spring Cloud"}),". You can use the local ",(0,r.jsx)(n.code,{children:"Eureka"})," or the application provided in the example."]}),"\n",(0,r.jsxs)(n.p,{children:["Download ",(0,r.jsx)(n.a,{href:"https://github.com/apache/shenyu/tree/master/shenyu-examples/shenyu-examples-eureka",children:"shenyu-examples-eureka"})," \u3001",(0,r.jsx)(n.a,{href:"https://github.com/apache/shenyu/tree/master/shenyu-examples/shenyu-examples-springcloud",children:"shenyu-examples-springcloud"})," ."]}),"\n",(0,r.jsxs)(n.p,{children:["Startup the Eureka service:\nExecute the ",(0,r.jsx)(n.code,{children:"org.apache.shenyu.examples.eureka.EurekaServerApplication"})," main method to start project."]}),"\n",(0,r.jsxs)(n.p,{children:["Startup the Spring Cloud service:\nExecute the ",(0,r.jsx)(n.code,{children:"org.apache.shenyu.examples.springcloud.ShenyuTestSpringCloudApplication"})," main method to start project."]}),"\n",(0,r.jsx)(n.p,{children:"The following log appears when the startup is successful:"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-shell",children:'2021-02-10 14:03:51.301  INFO 2860 --- [           main] o.s.s.concurrent.ThreadPoolTaskExecutor  : Initializing ExecutorService \'applicationTaskExecutor\'\n2021-02-10 14:03:51.669  INFO 2860 --- [pool-1-thread-1] o.d.s.client.common.utils.RegisterUtils  : springCloud client register success: {"appName":"springCloud-test","context":"/springcloud","path":"/springcloud/order/save","pathDesc":"","rpcType":"springCloud","ruleName":"/springcloud/order/save","enabled":true} \n2021-02-10 14:03:51.676  INFO 2860 --- [pool-1-thread-1] o.d.s.client.common.utils.RegisterUtils  : springCloud client register success: {"appName":"springCloud-test","context":"/springcloud","path":"/springcloud/order/path/**","pathDesc":"","rpcType":"springCloud","ruleName":"/springcloud/order/path/**","enabled":true} \n2021-02-10 14:03:51.682  INFO 2860 --- [pool-1-thread-1] o.d.s.client.common.utils.RegisterUtils  : springCloud client register success: {"appName":"springCloud-test","context":"/springcloud","path":"/springcloud/order/findById","pathDesc":"","rpcType":"springCloud","ruleName":"/springcloud/order/findById","enabled":true} \n2021-02-10 14:03:51.688  INFO 2860 --- [pool-1-thread-1] o.d.s.client.common.utils.RegisterUtils  : springCloud client register success: {"appName":"springCloud-test","context":"/springcloud","path":"/springcloud/order/path/**/name","pathDesc":"","rpcType":"springCloud","ruleName":"/springcloud/order/path/**/name","enabled":true} \n2021-02-10 14:03:51.692  INFO 2860 --- [pool-1-thread-1] o.d.s.client.common.utils.RegisterUtils  : springCloud client register success: {"appName":"springCloud-test","context":"/springcloud","path":"/springcloud/test/**","pathDesc":"","rpcType":"springCloud","ruleName":"/springcloud/test/**","enabled":true} \n2021-02-10 14:03:52.806  WARN 2860 --- [           main] ockingLoadBalancerClientRibbonWarnLogger : You already have RibbonLoadBalancerClient on your classpath. It will be used by default. As Spring Cloud Ribbon is in maintenance mode. We recommend switching to BlockingLoadBalancerClient instead. In order to use it, set the value of `spring.cloud.loadbalancer.ribbon.enabled` to `false` or remove spring-cloud-starter-netflix-ribbon from your project.\n2021-02-10 14:03:52.848  WARN 2860 --- [           main] iguration$LoadBalancerCaffeineWarnLogger : Spring Cloud LoadBalancer is currently working with default default cache. You can switch to using Caffeine cache, by adding it to the classpath.\n2021-02-10 14:03:52.921  INFO 2860 --- [           main] o.s.c.n.eureka.InstanceInfoFactory       : Setting initial instance status as: STARTING\n2021-02-10 14:03:52.949  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Initializing Eureka in region us-east-1\n2021-02-10 14:03:53.006  INFO 2860 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using JSON encoding codec LegacyJacksonJson\n2021-02-10 14:03:53.006  INFO 2860 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using JSON decoding codec LegacyJacksonJson\n2021-02-10 14:03:53.110  INFO 2860 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using XML encoding codec XStreamXml\n2021-02-10 14:03:53.110  INFO 2860 --- [           main] c.n.d.provider.DiscoveryJerseyProvider   : Using XML decoding codec XStreamXml\n2021-02-10 14:03:53.263  INFO 2860 --- [           main] c.n.d.s.r.aws.ConfigClusterResolver      : Resolving eureka endpoints via configuration\n2021-02-10 14:03:53.546  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Disable delta property : false\n2021-02-10 14:03:53.546  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Single vip registry refresh property : null\n2021-02-10 14:03:53.547  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Force full registry fetch : false\n2021-02-10 14:03:53.547  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Application is null : false\n2021-02-10 14:03:53.547  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Registered Applications size is zero : true\n2021-02-10 14:03:53.547  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Application version is -1: true\n2021-02-10 14:03:53.547  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Getting all instance registry info from the eureka server\n2021-02-10 14:03:53.754  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : The response status is 200\n2021-02-10 14:03:53.756  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Starting heartbeat executor: renew interval is: 30\n2021-02-10 14:03:53.758  INFO 2860 --- [           main] c.n.discovery.InstanceInfoReplicator     : InstanceInfoReplicator onDemand update allowed rate per min is 4\n2021-02-10 14:03:53.761  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Discovery Client initialized at timestamp 1612937033760 with initial instances count: 0\n2021-02-10 14:03:53.762  INFO 2860 --- [           main] o.s.c.n.e.s.EurekaServiceRegistry        : Registering application SPRINGCLOUD-TEST with eureka with status UP\n2021-02-10 14:03:53.763  INFO 2860 --- [           main] com.netflix.discovery.DiscoveryClient    : Saw local status change event StatusChangeEvent [timestamp=1612937033763, current=UP, previous=STARTING]\n2021-02-10 14:03:53.765  INFO 2860 --- [nfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_SPRINGCLOUD-TEST/host.docker.internal:springCloud-test:8884: registering service...\n2021-02-10 14:03:53.805  INFO 2860 --- [           main] o.s.b.w.embedded.tomcat.TomcatWebServer  : Tomcat started on port(s): 8884 (http) with context path \'\'\n2021-02-10 14:03:53.807  INFO 2860 --- [           main] .s.c.n.e.s.EurekaAutoServiceRegistration : Updating port to 8884\n2021-02-10 14:03:53.837  INFO 2860 --- [nfoReplicator-0] com.netflix.discovery.DiscoveryClient    : DiscoveryClient_SPRINGCLOUD-TEST/host.docker.internal:springCloud-test:8884 - registration status: 204\n2021-02-10 14:03:54.231  INFO 2860 --- [           main] o.d.s.e.s.ShenyuTestSpringCloudApplication : Started ShenyuTestSpringCloudApplication in 6.338 seconds (JVM running for 7.361) \n'})}),"\n",(0,r.jsxs)(n.ul,{children:["\n",(0,r.jsxs)(n.li,{children:["After starting ",(0,r.jsx)(n.code,{children:"shenyu-examples-springcloud"})]}),"\n",(0,r.jsxs)(n.li,{children:["You can see the newly registered data on the ",(0,r.jsx)(n.code,{children:"divide"})," plugin of the admin system"]}),"\n"]}),"\n",(0,r.jsx)(n.h2,{id:"test",children:"Test"}),"\n",(0,r.jsxs)(n.p,{children:["The ",(0,r.jsx)(n.code,{children:"shenyu-examples-springcloud"})," project will automatically register interface methods annotated with ",(0,r.jsx)(n.code,{children:"@ShenyuSpringMvcClient"})," in the Apache ShenYu gateway after successful startup."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:t(10035).A+"",width:"1697",height:"397"})}),"\n",(0,r.jsx)(n.p,{children:"Use PostMan to simulate HTTP to request your SpringCloud service:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:t(28489).A+"",width:"1071",height:"371"})}),"\n",(0,r.jsxs)(n.p,{children:["Use IDEA HTTP Client Plugin to simulate HTTP to request your SpringCloud service[local",":no"," Shenyu proxy]:"]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:t(38383).A+"",width:"1040",height:"662"})}),"\n",(0,r.jsx)(n.p,{children:"Use IDEA HTTP Client Plugin to simulate HTTP to request your SpringCloud service[Shenyu proxy]:"}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{src:t(35910).A+"",width:"1037",height:"645"})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}}}]);