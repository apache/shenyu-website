"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[29188],{28453(e,n,r){r.d(n,{R:()=>d,x:()=>t});var s=r(96540);const i={},l=s.createContext(i);function d(e){const n=s.useContext(l);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),s.createElement(l.Provider,{value:n},e.children)}},63352(e,n,r){r.r(n),r.d(n,{assets:()=>o,contentTitle:()=>t,default:()=>u,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"users-guide/spring-cloud-proxy","title":"SpringCloud Proxy","description":"springCloud with soul gateway","source":"@site/versioned_docs/version-2.3.0-Legacy/users-guide/spring-cloud-proxy.md","sourceDirName":"users-guide","slug":"/users-guide/spring-cloud-proxy","permalink":"/docs/2.3.0-Legacy/users-guide/spring-cloud-proxy","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.3.0-Legacy/users-guide/spring-cloud-proxy.md","tags":[],"version":"2.3.0-Legacy","sidebarPosition":4,"frontMatter":{"sidebar_position":4,"title":"SpringCloud Proxy","keywords":["soul"],"description":"springCloud with soul gateway"},"sidebar":"tutorialSidebar","previous":{"title":"Integrate dubbo with soul gateway","permalink":"/docs/2.3.0-Legacy/users-guide/dubbo-proxy"},"next":{"title":"Sofa RPC Proxy","permalink":"/docs/2.3.0-Legacy/users-guide/sofa-rpc-proxy"}}');var i=r(74848),l=r(28453);const d={sidebar_position:4,title:"SpringCloud Proxy",keywords:["soul"],description:"springCloud with soul gateway"},t=void 0,o={},a=[{value:"Features",id:"features",level:2},{value:"Configure soul gateway as Spring Cloud proxy",id:"configure-soul-gateway-as-spring-cloud-proxy",level:2},{value:"SpringCloud integration with gateway",id:"springcloud-integration-with-gateway",level:2},{value:"Plugin Setting",id:"plugin-setting",level:2},{value:"User Request",id:"user-request",level:2}];function c(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.h2,{id:"features",children:"Features"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"This article is a guide about how to integrate Spring Cloud with soul gateway quickly."}),"\n",(0,i.jsxs)(n.li,{children:["Please enable ",(0,i.jsx)(n.code,{children:"springCloud"})," plug-in in soul-admin background."]}),"\n",(0,i.jsxs)(n.li,{children:["Please start ",(0,i.jsx)(n.code,{children:"soul-admin"})," successfully before integrating and ",(0,i.jsx)(n.a,{href:"./soul-set-up",children:"Environment Setup"})," is Ok."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"configure-soul-gateway-as-spring-cloud-proxy",children:"Configure soul gateway as Spring Cloud proxy"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"add these dependencies in gateway's pom.xml:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"\x3c!--soul springCloud plugin start--\x3e\n<dependency>\n    <groupId>org.dromara</groupId>\n    <artifactId>soul-spring-boot-starter-plugin-springcloud</artifactId>\n    <version>${last.version}</version>\n</dependency>\n \x3c!--soul springCloud plugin end--\x3e\n\n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-commons</artifactId>\n    <version>2.2.0.RELEASE</version>\n</dependency> \n<dependency>\n    <groupId>org.springframework.cloud</groupId>\n    <artifactId>spring-cloud-starter-netflix-ribbon</artifactId>\n    <version>2.2.0.RELEASE</version>\n</dependency>\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["If you use ",(0,i.jsx)(n.code,{children:"eureka"})," as SpringCloud registry center."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"add these dependencies:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"  <dependency>\n       <groupId>org.springframework.cloud</groupId>\n       <artifactId>spring-cloud-starter-netflix-eureka-client</artifactId>\n       <version>2.2.0.RELEASE</version>\n  </dependency>\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"add these config values in gateway's yaml file:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"   eureka:\n     client:\n       serviceUrl:\n         defaultZone: http://localhost:8761/eureka/ #your eureka address\n     instance:\n       prefer-ip-address: true\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["if you use ",(0,i.jsx)(n.code,{children:"nacos"})," as Spring Cloud registry center."]}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"add these dependencies:"}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:" <dependency>\n       <groupId>com.alibaba.cloud</groupId>\n       <artifactId>spring-cloud-starter-alibaba-nacos-discovery</artifactId>\n       <version>2.1.0.RELEASE</version>\n </dependency>\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"add these config values in gateway's yaml file:"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"  spring:\n     cloud:\n       nacos:\n         discovery:\n            server-addr: 127.0.0.1:8848 # your nacos address\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"restart your gateway service."}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"springcloud-integration-with-gateway",children:"SpringCloud integration with gateway"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"add these dependencies in your project\uff1a"}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:" <dependency>\n      <groupId>org.dromara</groupId>\n      <artifactId>soul-spring-boot-starter-client-springcloud</artifactId>\n      <version>${last.version}</version>\n </dependency>\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["backend server register center config, please look:",(0,i.jsx)(n.a,{href:"../register-center/register-center-access",children:"register center access"}),"."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["add the annotation ",(0,i.jsx)(n.code,{children:"@SoulSpringCloudClient"})," in your ",(0,i.jsx)(n.code,{children:"controller"})," interface."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"you can apply the annotation to class-level in a controller.the name of the path variable is prefix and '/**' will apply proxy for entire interfaces."}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["example \uff081\uff09\uff1aboth ",(0,i.jsx)(n.code,{children:"/test/payment"})," and ",(0,i.jsx)(n.code,{children:"/test/findByUserId"})," will be handled by gateway."]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:' @RestController\n @RequestMapping("/test")\n @SoulSpringCloudClient(path = "/test/**")\n public class HttpTestController {\n     \n     @PostMapping("/payment")\n     public UserDTO post(@RequestBody final UserDTO userDTO) {\n         return userDTO;\n     }\n     \n     @GetMapping("/findByUserId")\n     public UserDTO findByUserId(@RequestParam("userId") final String userId) {\n         UserDTO userDTO = new UserDTO();\n         userDTO.setUserId(userId);\n         userDTO.setUserName("hello world");\n         return userDTO;\n     }    \n  }\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["example \uff082\uff09\uff1a",(0,i.jsx)(n.code,{children:"/order/save"})," will be handled by gateway, and ",(0,i.jsx)(n.code,{children:"/order/findById"})," won't."]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-java",children:' @RestController\n @RequestMapping("/order")\n @SoulSpringCloudClient(path = "/order")\n public class OrderController {\n \n     @PostMapping("/save")\n     @SoulSpringMvcClient(path = "/save")\n     public OrderDTO save(@RequestBody final OrderDTO orderDTO) {\n         orderDTO.setName("hello world save order");\n         return orderDTO;\n     }\n\n     @GetMapping("/findById")\n     public OrderDTO findById(@RequestParam("id") final String id) {\n         OrderDTO orderDTO = new OrderDTO();\n         orderDTO.setId(id);\n         orderDTO.setName("hello world findById");\n         return orderDTO;\n     }\n }\n'})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["start your service, get the log ",(0,i.jsx)(n.code,{children:"dubbo client register success"}),", then your interface has been added with soul gateway successfully."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"plugin-setting",children:"Plugin Setting"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["enable Spring Cloud plugin in ",(0,i.jsx)(n.code,{children:"soul-admin"}),"."]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"user-request",children:"User Request"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"Send the request as before, only two points need to notice."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsx)(n.p,{children:"firstly\uff0cthe domain name that requested before in your service, now need to replace with gateway's domain name."}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:["secondly\uff0csoul gateway needs a route prefix which comes from ",(0,i.jsx)(n.code,{children:"contextPath"}),", it configured during the integration with gateway, you can change it freely in divide plugin of ",(0,i.jsx)(n.code,{children:"soul-admin"}),", if your familiar with it."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"\n# for example, your have an order service and it has a interface, the request url: http://localhost:8080/test/save\n\n# now need to change to\uff1ahttp://localhost:9195/order/test/save\n\n# we can see localhost:9195 is the gateway's ip port, default port number is 9195 \uff0c/order is the contextPath in your config yaml file. \n\n# the request of other parameters don't change.\n\n# Any questions, pls join the group and we can talk about it.\n\n"})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"Then you can visit, very easy and simple."}),"\n"]})]})}function u(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);