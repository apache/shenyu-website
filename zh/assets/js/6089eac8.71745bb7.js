"use strict";(self.webpackChunkshenyu_website=self.webpackChunkshenyu_website||[]).push([[20939],{3995:(e,t,n)=>{n.r(t),n.d(t,{contentTitle:()=>o,default:()=>c,frontMatter:()=>a,metadata:()=>l,toc:()=>p});var r=n(58168),i=(n(96540),n(15680));const a={title:"AiProxy Plugin",keywords:["AiProxy"],description:"AiProxy plugin"},o=void 0,l={unversionedId:"plugin-center/ai/ai-proxy",id:"plugin-center/ai/ai-proxy",isDocsHomePage:!1,title:"AiProxy Plugin",description:"AiProxy plugin",source:"@site/docs/plugin-center/ai/ai-proxy.md",sourceDirName:"plugin-center/ai",slug:"/plugin-center/ai/ai-proxy",permalink:"/zh/docs/next/plugin-center/ai/ai-proxy",editUrl:"https://github.com/apache/shenyu-website/edit/main/docs/plugin-center/ai/ai-proxy.md",version:"current",frontMatter:{title:"AiProxy Plugin",keywords:["AiProxy"],description:"AiProxy plugin"},sidebar:"tutorialSidebar",previous:{title:"AiPrompt Plugin",permalink:"/zh/docs/next/plugin-center/ai/ai-prompt"},next:{title:"AiTokenLimiter Plugin",permalink:"/zh/docs/next/plugin-center/ai/ai-token-limiter"}},p=[{value:"Description",id:"description",children:[]},{value:"Plugin Configuration",id:"plugin-configuration",children:[]},{value:"API Usage",id:"api-usage",children:[]}],s={toc:p},u="wrapper";function c({components:e,...t}){return(0,i.yg)(u,(0,r.A)({},s,t,{components:e,mdxType:"MDXLayout"}),(0,i.yg)("h2",{id:"description"},"Description"),(0,i.yg)("p",null,"The ",(0,i.yg)("strong",{parentName:"p"},"aiProxy")," plugin acts as a forwarding proxy for LLM requests, supporting major large-model services. Users send requests through ShenYu to a route configured with aiProxy; aiProxy then uses the plugin settings\u2014such as provider (e.g., OpenAI, Alibaba Cloud), model name, API key, etc.\u2014to call the corresponding LLM API and return the result. Typical use cases include forwarding chat requests to OpenAI\u2019s ChatGPT endpoint or using domestic AI services for intelligent Q&A. Similar to previous plugin usage patterns, you can think of the LLM as taking on the role of your original application service. If you have a local model compatible with the OpenAI protocol or other mainstream protocols, you can also proxy it via the shenyu-aiProxy plugin."),(0,i.yg)("h2",{id:"plugin-configuration"},"Plugin Configuration"),(0,i.yg)("p",null,"When configuring the plugin in the ShenYu admin interface, you first create a ",(0,i.yg)("strong",{parentName:"p"},"Selector"),", then create a ",(0,i.yg)("strong",{parentName:"p"},"Rule"),". A Selector is typically used to match request conditions (e.g., path, headers), while a Rule is used to configure plugin parameters or forwarding targets. For details on Selector and Rule configuration, see ",(0,i.yg)("a",{parentName:"p",href:"../../user-guide/admin-usage/selector-and-rule.md"},"Selector and Rule Management"),"."),(0,i.yg)("p",null,"When using the aiProxy plugin, pay attention to the following fields:"),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Selector"),": Defines the paths or request characteristics to match. For example, set ",(0,i.yg)("inlineCode",{parentName:"li"},"Pattern")," to ",(0,i.yg)("inlineCode",{parentName:"li"},"/**")," to match all requests, or specify a particular route path."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("strong",{parentName:"li"},"Rule"),": Specify plugin parameters at the rule level. Common fields include:",(0,i.yg)("ul",{parentName:"li"},(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"provider"),": The name of the provider, e.g., ",(0,i.yg)("inlineCode",{parentName:"li"},"OpenAI"),"."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"baseUrl"),": The API endpoint for the LLM provider."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"model"),": The model name."),(0,i.yg)("li",{parentName:"ul"},(0,i.yg)("inlineCode",{parentName:"li"},"apiKey"),": The authorization key.")))),(0,i.yg)("p",null,"Below are example screenshots of the aiProxy plugin configuration in the admin UI:"),(0,i.yg)("p",null,"Selector matching the incoming path, followed by Rule settings for provider, model, API key, upstream address, etc."),(0,i.yg)("p",null,(0,i.yg)("img",{src:n(69554).A})),(0,i.yg)("p",null,(0,i.yg)("img",{src:n(85753).A})),(0,i.yg)("blockquote",null,(0,i.yg)("p",{parentName:"blockquote"},(0,i.yg)("strong",{parentName:"p"},"Note:")," With this setup, you also need to configure the ",(0,i.yg)("inlineCode",{parentName:"p"},"contextPath")," plugin to remove the matched prefix and assemble the correct call URL. See ",(0,i.yg)("a",{parentName:"p",href:"../http-process/contextPath-plugin.md"},"contextPath Plugin Configuration")," for details.")),(0,i.yg)("h2",{id:"api-usage"},"API Usage"),(0,i.yg)("p",null,"After enabling the aiProxy plugin, you can send requests to the ShenYu gateway (e.g., via Postman) and obtain LLM responses through the proxy:"),(0,i.yg)("pre",null,(0,i.yg)("code",{parentName:"pre",className:"language-bash"},'curl --location --request POST \'http://localhost:9195/ai/proxy/v1/chat/completions\' \\\n  --header \'Content-Type: application/json\' \\\n  --data-raw \'{\n    "model": "gpt-4o-mini",\n    "messages": [\n      {\n        "role": "system",\n        "content": "You are a translation assistant. Please translate the input content into English."\n      },\n      {\n        "role": "user",\n        "content": "I bloom amidst slaughter, like a flower at dawn."\n      }\n    ]\n  }\'\n')),(0,i.yg)("p",null,(0,i.yg)("img",{src:n(74307).A})))}c.isMDXComponent=!0},15680:(e,t,n)=>{n.d(t,{xA:()=>u,yg:()=>d});var r=n(96540);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach(function(t){i(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},a=Object.keys(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(r=0;r<a.length;r++)n=a[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var p=r.createContext({}),s=function(e){var t=r.useContext(p),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=s(e.components);return r.createElement(p.Provider,{value:t},e.children)},c="mdxType",g={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},y=r.forwardRef(function(e,t){var n=e.components,i=e.mdxType,a=e.originalType,p=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=s(n),y=i,d=c["".concat(p,".").concat(y)]||c[y]||g[y]||a;return n?r.createElement(d,o(o({ref:t},u),{},{components:n})):r.createElement(d,o({ref:t},u))});function d(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var a=n.length,o=new Array(a);o[0]=y;var l={};for(var p in t)hasOwnProperty.call(t,p)&&(l[p]=t[p]);l.originalType=e,l[c]="string"==typeof e?e:i,o[1]=l;for(var s=2;s<a;s++)o[s]=n[s];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}y.displayName="MDXCreateElement"},69554:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ai-proxy-selector-en-230480625466a1dfa9c425afc223aaa1.png"},74307:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ai-proxy-api-ef5e61fe03ccef55196fedd4b5e80797.png"},85753:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/ai-proxy-rule-en-2960454f8b38246d7730e40784ee795d.png"}}]);