"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[60618],{39(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>a,frontMatter:()=>o,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"plugin-center/http-handle/websocket-plugin","title":"WebSocket Plugin","description":"websocket plugin","source":"@site/versioned_docs/version-2.4.0/plugin-center/http-handle/websocket-plugin.md","sourceDirName":"plugin-center/http-handle","slug":"/plugin-center/http-handle/websocket-plugin","permalink":"/docs/2.4.0/plugin-center/http-handle/websocket-plugin","draft":false,"unlisted":false,"editUrl":"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.4.0/plugin-center/http-handle/websocket-plugin.md","tags":[],"version":"2.4.0","frontMatter":{"title":"WebSocket Plugin","keywords":["WebSocket"],"description":"websocket plugin"},"sidebar":"tutorialSidebar","previous":{"title":"Rewrite Plugin","permalink":"/docs/2.4.0/plugin-center/http-handle/rewrite-plugin"},"next":{"title":"Dubbo Plugin","permalink":"/docs/2.4.0/plugin-center/rpc-proxy/dubbo-plugin"}}');var i=t(74848),r=t(28453);const o={title:"WebSocket Plugin",keywords:["WebSocket"],description:"websocket plugin"},c=void 0,l={},d=[{value:"Environment to prepare",id:"environment-to-prepare",level:2},{value:"Request Path",id:"request-path",level:2},{value:"Selector And Rule",id:"selector-and-rule",level:2}];function h(e){const n={a:"a",code:"code",h2:"h2",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(n.p,{children:["The Apache ShenYu gateway implements support for the WebSocket proxy through the ",(0,i.jsx)(n.code,{children:"Divide"})," plugin."]}),"\n",(0,i.jsx)(n.h2,{id:"environment-to-prepare",children:"Environment to prepare"}),"\n",(0,i.jsxs)(n.p,{children:["Please refer to the deployment to select a way to start shenyu-admin. For example, start the Apache ShenYu gateway management system through ",(0,i.jsx)(n.a,{href:"../../deployment/deployment-local",children:"local deployment"})," ."]}),"\n",(0,i.jsxs)(n.p,{children:["After successful startup, you need to open the Divide plugin on in the BasicConfig ",(0,i.jsx)(n.code,{children:"->"})," Plugin. For ",(0,i.jsx)(n.code,{children:"Divide"})," plugin details, please refer to: ",(0,i.jsx)(n.a,{href:"./divide-plugin",children:"Divide Plugin"})," ."]}),"\n",(0,i.jsx)("img",{src:"/img/shenyu/quick-start/http/http_open_en.png",width:"60%",height:"50%"}),"\n",(0,i.jsxs)(n.p,{children:["Add the following dependencies to the gateway's ",(0,i.jsx)(n.code,{children:"pom.xml"})," file:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-xml",children:"  \x3c!--if you use http proxy start this--\x3e\n<dependency>\n  <groupId>org.apache.shenyu</groupId>\n  <artifactId>shenyu-spring-boot-starter-plugin-divide</artifactId>\n  <version>${project.version}</version>\n</dependency>\n\n<dependency>\n  <groupId>org.apache.shenyu</groupId>\n  <artifactId>shenyu-spring-boot-starter-plugin-httpclient</artifactId>\n  <version>${project.version}</version>\n</dependency>\n"})}),"\n",(0,i.jsx)(n.h2,{id:"request-path",children:"Request Path"}),"\n",(0,i.jsx)(n.p,{children:"When using Apache ShenYu proxy websocket, assume that the request path is:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"ws://localhost:9195/?module=ws&method=/websocket&rpcType=websocket\n"})}),"\n",(0,i.jsx)(n.p,{children:"details\uff1a"}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"localhost:9195"}),": ",(0,i.jsx)(n.code,{children:"ip"})," and port of gateway."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"module"}),": filter conditions for selector."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"method"}),": websocket paths are also used for rule matching."]}),"\n"]}),"\n",(0,i.jsxs)(n.li,{children:["\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.code,{children:"rpcType"})," \uff1adefault is websocket."]}),"\n"]}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"selector-and-rule",children:"Selector And Rule"}),"\n",(0,i.jsxs)(n.p,{children:["Add a selector configuration to the ",(0,i.jsx)(n.code,{children:"Divide"})," plugin:"]}),"\n",(0,i.jsx)("img",{src:"/img/shenyu/plugin/websocket/websocket_selector_en.png",width:"80%"}),"\n",(0,i.jsxs)(n.p,{children:["Select the type ",(0,i.jsx)(n.code,{children:"query"})," in the condition, and fill in the matching field and value (",(0,i.jsx)(n.code,{children:"module"}),", ",(0,i.jsx)(n.code,{children:"ws"}),"). You can customize the fields and the values, as long as they match the request."]}),"\n",(0,i.jsxs)(n.p,{children:["For Handle, enter the address of the ",(0,i.jsx)(n.code,{children:"webSocket"})," service."]}),"\n",(0,i.jsx)(n.p,{children:"Add a new rule under this selector:"}),"\n",(0,i.jsx)("img",{src:"/img/shenyu/plugin/websocket/websocket_rule_en.png",width:"80%"}),"\n",(0,i.jsxs)(n.p,{children:["Select the type ",(0,i.jsx)(n.code,{children:"query"})," in the condition, and fill in the matching field and value, which are ",(0,i.jsx)(n.code,{children:"method"})," and ",(0,i.jsx)(n.code,{children:"/websocket"})," respectively. You can also customize the fields and the values, as long as they match the request."]}),"\n",(0,i.jsxs)(n.p,{children:["With the above selector and rule configuration, your request will be matched and then request the real ",(0,i.jsx)(n.code,{children:"WebSocket"})," address of the proxy: ",(0,i.jsx)(n.code,{children:"127.0.0.1:8080/websocket"}),", thus the Apache ShenYu gateway will complete the proxy for ",(0,i.jsx)(n.code,{children:"websocket"}),"."]})]})}function a(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(h,{...e})}):h(e)}},28453(e,n,t){t.d(n,{R:()=>o,x:()=>c});var s=t(96540);const i={},r=s.createContext(i);function o(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),s.createElement(r.Provider,{value:n},e.children)}}}]);