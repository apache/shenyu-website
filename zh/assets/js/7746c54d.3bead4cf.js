"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[68259],{6113:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/Mcp-server-execute-zh-9cf2daaf68b9189ce0d70536f72f73b8.png"},15680:(e,n,r)=>{r.d(n,{xA:()=>g,yg:()=>d});var a=r(96540);function t(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function o(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),r.push.apply(r,a)}return r}function l(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?o(Object(r),!0).forEach(function(n){t(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function i(e,n){if(null==e)return{};var r,a,t=function(e,n){if(null==e)return{};var r,a,t={},o=Object.keys(e);for(a=0;a<o.length;a++)r=o[a],n.indexOf(r)>=0||(t[r]=e[r]);return t}(e,n);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(t[r]=e[r])}return t}var s=a.createContext({}),p=function(e){var n=a.useContext(s),r=n;return e&&(r="function"==typeof e?e(n):l(l({},n),e)),r},g=function(e){var n=p(e.components);return a.createElement(s.Provider,{value:n},e.children)},c="mdxType",u={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},A=a.forwardRef(function(e,n){var r=e.components,t=e.mdxType,o=e.originalType,s=e.parentName,g=i(e,["components","mdxType","originalType","parentName"]),c=p(r),A=t,d=c["".concat(s,".").concat(A)]||c[A]||u[A]||o;return r?a.createElement(d,l(l({ref:n},g),{},{components:r})):a.createElement(d,l({ref:n},g))});function d(e,n){var r=arguments,t=n&&n.mdxType;if("string"==typeof e||t){var o=r.length,l=new Array(o);l[0]=A;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i[c]="string"==typeof e?e:t,l[1]=i;for(var p=2;p<o;p++)l[p]=r[p];return a.createElement.apply(null,l)}return a.createElement.apply(null,r)}A.displayName="MDXCreateElement"},19696:(e,n,r)=>{r.r(n),r.d(n,{contentTitle:()=>l,default:()=>c,frontMatter:()=>o,metadata:()=>i,toc:()=>s});var a=r(58168),t=(r(96540),r(15680));const o={title:"McpServer \u63d2\u4ef6\u6e90\u7801\u5206\u6790",author:"yusiheng",author_title:"Apache ShenYu Contributor",author_url:"https://github.com/478320",tags:["plugin","mcp","Apache ShenYu"]},l=void 0,i={permalink:"/zh/blog/Plugin-SourceCode-Analysis-Mcp-Server-Plugin",editUrl:"https://github.com/apache/shenyu-website/edit/main/i18n/zh/docusaurus-plugin-content-blog/Plugin-SourceCode-Analysis-Mcp-Server-Plugin.md",source:"@site/i18n/zh/docusaurus-plugin-content-blog/Plugin-SourceCode-Analysis-Mcp-Server-Plugin.md",title:"McpServer \u63d2\u4ef6\u6e90\u7801\u5206\u6790",description:"\u5728 shenyu \u7f51\u5173\u4e2d\uff0c\u542f\u52a8\u8be5\u63d2\u4ef6\uff0cshenyu \u5c06\u6210\u4e3a\u4e00\u4e2a\u529f\u80fd\u4e30\u5bcc\u7684 mcpServer,",date:"2025-10-22T15:13:22.463Z",formattedDate:"2025\u5e7410\u670822\u65e5",tags:[{label:"plugin",permalink:"/zh/blog/tags/plugin"},{label:"mcp",permalink:"/zh/blog/tags/mcp"},{label:"Apache ShenYu",permalink:"/zh/blog/tags/apache-shen-yu"}],readingTime:14.86,truncated:!1,prevItem:{title:"Param-Mapping\u63d2\u4ef6\u6e90\u7801\u5206\u6790",permalink:"/zh/blog/Plugin-SourceCode-Analysis-Param-Mapping-Plugin"},nextItem:{title:"Dubbo\u63d2\u4ef6\u6e90\u7801\u5206\u6790",permalink:"/zh/blog/Plugin-SourceCode-Analysis-Dubbo-Plugin"}},s=[{value:"\u524d\u8a00",id:"\u524d\u8a00",children:[]},{value:"1. \u670d\u52a1\u6ce8\u518c",id:"1-\u670d\u52a1\u6ce8\u518c",children:[]},{value:"2. \u63d2\u4ef6\u8c03\u7528",id:"2-\u63d2\u4ef6\u8c03\u7528",children:[]},{value:"3. \u5de5\u5177\u8c03\u7528",id:"3-\u5de5\u5177\u8c03\u7528",children:[]},{value:"4. \u5c0f\u7ed3",id:"4-\u5c0f\u7ed3",children:[]}],p={toc:s},g="wrapper";function c({components:e,...n}){return(0,t.yg)(g,(0,a.A)({},p,n,{components:e,mdxType:"MDXLayout"}),(0,t.yg)("p",null,"\u5728 shenyu \u7f51\u5173\u4e2d\uff0c\u542f\u52a8\u8be5\u63d2\u4ef6\uff0cshenyu \u5c06\u6210\u4e3a\u4e00\u4e2a\u529f\u80fd\u4e30\u5bcc\u7684 mcpServer,\n\u4f60\u53ef\u4ee5\u901a\u8fc7\u7b80\u5355\u914d\u7f6e\u6765\u5c06\u4e00\u4e2a\u670d\u52a1\u4f5c\u4e3a tool \u6ce8\u518c\u5230 shenyu \u7f51\u5173\u4e2d\uff0c\u5e76\u4f7f\u7528\u7f51\u5173\u63d0\u4f9b\u7684\u6269\u5c55\u529f\u80fd\u3002"),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u672c\u6587\u57fa\u4e8e",(0,t.yg)("inlineCode",{parentName:"p"},"shenyu-2.7.0.2"),"\u7248\u672c\u8fdb\u884c\u6e90\u7801\u5206\u6790\uff0c \u5728\u672c\u7bc7\u4e2d\u6211\u5c06\u8ffd\u8e2a Shenyu Mcp \u63d2\u4ef6\u94fe\u8def\uff0c\u5bf9 Mcp \u63d2\u4ef6\u7684 sse \u901a\u4fe1\u65b9\u5f0f\u8fdb\u884c\u6e90\u7801\u5206\u6790")),(0,t.yg)("h3",{id:"\u524d\u8a00"},"\u524d\u8a00"),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"shenyu \u7f51\u5173\u7684 mcp \u63d2\u4ef6\u57fa\u4e8e spring-ai-mcp \u6269\u5c55\u800c\u6765\uff0c\u4e3a\u4e86\u66f4\u597d\u7684\u4e86\u89e3 mcp \u63d2\u4ef6\u7684\u5de5\u4f5c\u539f\u7406\n\uff0c\u6211\u5c06\u7b80\u5355\u4ecb\u7ecd mcp \u5b98\u65b9\u63d0\u4f9b\u7684 jdk \u4e2d\u5404\u4e2a java \u7c7b\u662f\u5982\u4f55\u534f\u540c\u8fd0\u4f5c\u7684")),(0,t.yg)("p",null,"\u6211\u60f3\u5148\u7b80\u5355\u4ecb\u7ecd\u4e09\u4e2a Mcp \u5b98\u65b9\u63d0\u4f9b\u7684 java \u7c7b"),(0,t.yg)("blockquote",null,(0,t.yg)("ol",{parentName:"blockquote"},(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("inlineCode",{parentName:"li"},"McpServer"))),(0,t.yg)("p",{parentName:"blockquote"},"\u8be5\u7c7b\u8d1f\u8d23\u7ba1\u7406\uff0ctool\uff0cResource\uff0cpromote \u7b49\u8d44\u6e90"),(0,t.yg)("ol",{parentName:"blockquote",start:2},(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("inlineCode",{parentName:"li"},"TransportProvider"))),(0,t.yg)("p",{parentName:"blockquote"},"\u6839\u636e\u5ba2\u6237\u7aef\u548c\u670d\u52a1\u7aef\u4e4b\u95f4\u901a\u4fe1\u534f\u8bae\uff0c\u63d0\u4f9b\u4e4b\u76f8\u5bf9\u5e94\u7684\u901a\u8baf\u65b9\u6cd5"),(0,t.yg)("ol",{parentName:"blockquote",start:3},(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("inlineCode",{parentName:"li"},"Session"))),(0,t.yg)("p",{parentName:"blockquote"},"\u5904\u7406\u8bf7\u6c42\u6570\u636e\u3001\u54cd\u5e94\u6570\u636e\u548c\u901a\u77e5\u6570\u636e\uff0c\u63d0\u4f9b\u4e00\u4e9b\u57fa\u672c\u65b9\u6cd5\u548c\u5176\u5bf9\u5e94\u7684\u5904\u7406\u5668\uff0c\u67e5\u8be2\u5de5\u5177\uff0c\u8c03\u7528\u5de5\u5177\u90fd\u5728\u6b64\u5904\u6267\u884c")),(0,t.yg)("h3",{id:"1-\u670d\u52a1\u6ce8\u518c"},"1. \u670d\u52a1\u6ce8\u518c"),(0,t.yg)("p",null,"\u5728 shenyu admin \u7684 McpServer \u4e2d\u63d2\u4ef6\u586b\u5199 endpoint \u548c tool \u4fe1\u606f\u540e\uff0c\u8fd9\u4e9b\u4fe1\u606f\u5c06\u81ea\u52a8\u6ce8\u518c\u5230 shenyu bootstrap \u4e2d\uff0c\n\u6570\u636e\u540c\u6b65\u6e90\u7801\u53ef\u4ee5\u53c2\u8003\u5b98\u7f51",(0,t.yg)("a",{parentName:"p",href:"https://shenyu.incubator.apache.org/zh/blog/DataSync-SourceCode-Analysis-WebSocket-Data-Sync"},"websocket\u6570\u636e\u540c\u6b65")),(0,t.yg)("p",null,"shenyu bootstrap \u5c06\u5728 ",(0,t.yg)("inlineCode",{parentName:"p"},"McpServerPluginDataHandler")," \u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"handler()")," \u65b9\u6cd5\u4e2d\u63a5\u6536\u5230 admin \u540c\u6b65\u6765\u7684\u6570\u636e\u3002"),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"handlerSelector()")," \u65b9\u6cd5\u63a5\u6536 url \u6570\u636e\u521b\u5efa McpServer"),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"handlerRule()")," \u65b9\u6cd5\u63a5\u6536 tool \u4fe1\u606f\uff0c\u6ce8\u518c tool"),(0,t.yg)("p",null,"\u8fd9\u4e24\u4e2a\u65b9\u6cd5\u5171\u540c\u7ec4\u6210\u4e86 Shenyu Mcp \u63d2\u4ef6\u7684\u670d\u52a1\u6ce8\u518c\u90e8\u5206\uff0c\u4e0b\u9762\u6211\u5c06\u5bf9\u8fd9\u4e2a\u4e24\u4e2a\u65b9\u6cd5\uff0c\u8be6\u7ec6\u5c55\u5f00\u5206\u6790"),(0,t.yg)("h4",{id:"11-transportmcpserver\u6ce8\u518c"},"1.1 Transport\uff0cMcpServer\u6ce8\u518c"),(0,t.yg)("p",null,"\u6211\u4eec\u5148\u6765\u5206\u6790 ",(0,t.yg)("inlineCode",{parentName:"p"},"handlerSelector()")," \u65b9\u6cd5\uff0c\u4e5f\u5c31\u662f McpServer \u7684\u6ce8\u518c"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"handlerSelector()")," \u65b9\u6cd5 \u5de5\u4f5c\u5185\u5bb9\u5982\u4e0b")),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"\u6355\u6349\u7528\u6237\u5728 Selector \u4e0a\u7684\u586b\u5199\u7684 url\uff0c\u8fd9\u4e2a url \u5c06\u4f5c\u4e3a\u4e00\u4e2a key \u5b58\u50a8 McpServer TransportProvider \u7b49\u4fe1\u606f"),(0,t.yg)("li",{parentName:"ol"},"\u5e8f\u5217\u5316\u521b\u5efa ",(0,t.yg)("inlineCode",{parentName:"li"},"ShenyuMcpServer"),"\uff0c",(0,t.yg)("inlineCode",{parentName:"li"},"ShenyuMcpServer")," \u5c06 SelectorId \u548c\u8fd9\u4e9b url \u4e5f\u5c31\u662f\u8fd9\u4e9b key \u7ed1\u5b9a\uff0c\u4ee5\u6b64\u6765\u5b9e\u73b0 selectorId \u548c key \u7684\u7ed1\u5b9a\u3002")),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u6ce8\u610f ",(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuMcpServer")," \u662f Shenyu \u7528\u4e8e\u7ed1\u5b9a SelectorId \u548c url \u7684\u5bf9\u8c61\uff0c\u548c ",(0,t.yg)("inlineCode",{parentName:"p"},"McpServer")," \u6ca1\u6709\u7ee7\u627f\u5173\u7cfb\uff0c\u529f\u80fd\u4e5f\u5b8c\u5168\u4e0d\u540c")),(0,t.yg)("ol",{start:3},(0,t.yg)("li",{parentName:"ol"},"\u8c03\u7528 ",(0,t.yg)("inlineCode",{parentName:"li"},"ShenyuMcpServerManager")," \u7684 ",(0,t.yg)("inlineCode",{parentName:"li"},"getOrCreateMcpServerTransport()")," \u65b9\u6cd5\u6ce8\u518c McpServer TransportProvider")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class McpServerPluginDataHandler implements PluginDataHandler {\n    @Override\n    public void handlerSelector(final SelectorData selectorData) {\n        // \u83b7\u53d6URI\n        String uri = selectorData.getConditionList().stream()\n                .filter(condition -> Constants.URI.equals(condition.getParamType()))\n                .map(ConditionData::getParamValue)\n                .findFirst()\n                .orElse(null);\n        \n        // \u6784\u5efaMcpServer\n        ShenyuMcpServer shenyuMcpServer = GsonUtils.getInstance().fromJson(Objects.isNull(selectorData.getHandle()) ? DEFAULT_MESSAGE_ENDPOINT : selectorData.getHandle(), ShenyuMcpServer.class);\n        shenyuMcpServer.setPath(path);\n        // \u7f13\u5b58shenyuMcpServer\n        CACHED_SERVER.get().cachedHandle(\n                selectorData.getId(),\n                shenyuMcpServer);\n        String messageEndpoint = shenyuMcpServer.getMessageEndpoint();\n        // \u5c1d\u8bd5\u83b7\u53d6\u6216\u8005\u6ce8\u518ctransportProvider\n        shenyuMcpServerManager.getOrCreateMcpServerTransport(uri, messageEndpoint);\n    }\n    \n}\n")),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuMcpServerManager")," \u8be5\u7c7b\u662f ShenYu \u4e2d McpServer \u7684\u7ba1\u7406\u4e2d\u5fc3\uff0c\u4e0d\u4ec5\u50a8\u5b58\u4e86 ",(0,t.yg)("inlineCode",{parentName:"p"},"McpAsyncServer")," ",(0,t.yg)("inlineCode",{parentName:"p"},"CompositeTransportProvider")," \u7b49\u5185\u5bb9\uff0c\u6ce8\u518c Transport \u548c McpServer\n\u7684\u65b9\u6cd5\u4e5f\u5728\u5176\u4e2d"),(0,t.yg)("ul",{parentName:"blockquote"},(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"getOrCreateMcpServerTransport()")," \u65b9\u6cd5\u5de5\u4f5c\u5185\u5bb9\u5177\u4f53\u5982\u4e0b"))),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"\u5904\u7406\u4f20\u9012\u6765\u7684 url \u53bb\u9664/streamablehttp \u4ee5\u53ca /message\u540e\u7f00 \u4f7f\u5176\u6062\u590d\u4e3a\u539f\u59cb\u7684 url"),(0,t.yg)("li",{parentName:"ol"},"\u5c1d\u8bd5\u83b7\u53d6 ",(0,t.yg)("inlineCode",{parentName:"li"},"CompositeTransportProvider")," \u5bf9\u8c61\uff0c\u8be5\u5bf9\u8c61\u662f Transport \u7684\u590d\u5408\u5bf9\u8c61\uff0c\u5305\u542b\u4e86\u591a\u79cd\u534f\u8bae\u5bf9\u5e94\u7684 Transport"),(0,t.yg)("li",{parentName:"ol"},"\u5982\u679c\u6ca1\u6709\u83b7\u53d6\u5230\uff0c\u5219\u8c03\u7528 ",(0,t.yg)("inlineCode",{parentName:"li"},"createSseTransport()")," \u65b9\u6cd5\u521b\u5efa ",(0,t.yg)("inlineCode",{parentName:"li"},"CompositeTransportProvider")," \u5bf9\u8c61"),(0,t.yg)("li",{parentName:"ol"},"\u521b\u5efa ",(0,t.yg)("inlineCode",{parentName:"li"},"McpAsyncServer")," \u5bf9\u8c61\uff0c\u4fdd\u5b58 Transport \u5bf9\u8c61\u5230 Map \u4e2d\uff0c\u5c06 Transport \u6ce8\u518c\u5230 ",(0,t.yg)("inlineCode",{parentName:"li"},"McpAsyncServer")," \u4e2d")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"@Component\npublic class ShenyuMcpServerManager {\n    public ShenyuSseServerTransportProvider getOrCreateMcpServerTransport(final String uri, final String messageEndPoint) {\n        // \u53bb\u9664/streamablehttp \u4ee5\u53ca /message\u540e\u7f00\n        String normalizedPath = processPath(uri);\n        return getOrCreateTransport(normalizedPath, SSE_PROTOCOL,\n                () -> createSseTransport(normalizedPath, messageEndPoint));\n    }\n    \n    private <T> T getOrCreateTransport(final String normalizedPath, final String protocol,\n                                       final java.util.function.Supplier<T> transportFactory) {\n        // \u83b7\u53d6\u590d\u5408Transport\u5b9e\u4f8b\n        CompositeTransportProvider compositeTransport = getOrCreateCompositeTransport(normalizedPath);\n\n        T transport = switch (protocol) {\n            case SSE_PROTOCOL -> (T) compositeTransport.getSseTransport();\n            case STREAMABLE_HTTP_PROTOCOL -> (T) compositeTransport.getStreamableHttpTransport();\n            default -> null;\n        };\n        // \u5982\u679c\u7f13\u5b58\u4e2d\u6ca1\u6709\u8be5\u5b9e\u4f8b\uff0c\u5219\u9700\u8981\u91cd\u65b0\u521b\u5efa\n        if (Objects.isNull(transport)) {\n            // \u8c03\u7528createSseTransport()\u65b9\u6cd5\uff0c\u521b\u5efa\u4e00\u4e2a\u65b0\u7684transport\u5e76\u5b58\u50a8\n            transport = transportFactory.get();\n            // \u521b\u5efaMcpAsyncServer\uff0c\u5e76\u6ce8\u518ctransport\n            addTransportToSharedServer(normalizedPath, protocol, transport);\n        }\n\n        return transport;\n    }\n}\n")),(0,t.yg)("h5",{id:"111-transport\u6ce8\u518c"},"1.1.1 Transport\u6ce8\u518c"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"createSseTransport()")," \u65b9\u6cd5",(0,t.yg)("blockquote",{parentName:"li"},(0,t.yg)("p",{parentName:"blockquote"},"\u8be5\u65b9\u6cd5\u5728 ",(0,t.yg)("inlineCode",{parentName:"p"},"getOrCreateMcpServerTransport()")," \u65b9\u6cd5\u88ab\u8c03\u7528\uff0c\u7528\u4e8e\u521b\u5efa Transport")))),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"\n@Component\npublic class ShenyuMcpServerManager {\n    private ShenyuSseServerTransportProvider createSseTransport(final String normalizedPath, final String messageEndPoint) {\n        String messageEndpoint = normalizedPath + messageEndPoint;\n        ShenyuSseServerTransportProvider transportProvider = ShenyuSseServerTransportProvider.builder()\n                .objectMapper(objectMapper)\n                .sseEndpoint(normalizedPath)\n                .messageEndpoint(messageEndpoint)\n                .build();\n        // \u5411Manager\u7684routeMap\u4e2d\u6ce8\u518ctransportProvider\u7684\u4e24\u4e2a\u51fd\u6570\n        registerRoutes(normalizedPath, messageEndpoint, transportProvider::handleSseConnection, transportProvider::handleMessage);\n        return transportProvider;\n    }\n}\n")),(0,t.yg)("h5",{id:"112-mcpserver\u6ce8\u518c"},"1.1.2 mcpServer\u6ce8\u518c"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"addTransportToSharedServer()")," \u65b9\u6cd5",(0,t.yg)("blockquote",{parentName:"li"},(0,t.yg)("p",{parentName:"blockquote"},"\u8be5\u65b9\u6cd5\u5728 ",(0,t.yg)("inlineCode",{parentName:"p"},"getOrCreateMcpServerTransport()")," \u65b9\u6cd5\u88ab\u8c03\u7528\uff0c\u7528\u4e8e\u521b\u5efa McpServer \u5e76\u4fdd\u5b58")))),(0,t.yg)("p",null,"\u8be5\u65b9\u6cd5\u521b\u5efa\u4e86\u4e00\u4e2a\u65b0\u7684 McpServer\u5e76\u5b58\u50a8\u5230 ",(0,t.yg)("inlineCode",{parentName:"p"},"sharedServerMap")," \u4e2d\uff0c\u5e76\u5c06\u4e0a\u4e00\u6b65\u5f97\u5230\u7684 TransportProvider \u5b58\u5165 ",(0,t.yg)("inlineCode",{parentName:"p"},"compositeTransportMap")," \u4e2d"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},'@Component\npublic class ShenyuMcpServerManager {\n    private void addTransportToSharedServer(final String normalizedPath, final String protocol, final Object transportProvider) {\n        // \u83b7\u53d6\u6216\u8005\u521b\u5efa\u5e76\u6ce8\u518c McpServer\n        getOrCreateSharedServer(normalizedPath);\n\n        // \u5c06\u65b0\u589e\u7684\u4f20\u8f93\u534f\u8bae\u5b58\u8fdbcompositeTransportMap\u4e2d\n        compositeTransport.addTransport(protocol, transportProvider);\n        \n    }\n\n    private McpAsyncServer getOrCreateSharedServer(final String normalizedPath) {\n        return sharedServerMap.computeIfAbsent(normalizedPath, path -> {\n            // \u83b7\u53d6\u4f20\u8f93\u534f\u8bae\n            CompositeTransportProvider compositeTransport = getOrCreateCompositeTransport(path);\n\n            // \u9009\u62e9Server\u62e5\u6709\u7684\u80fd\u529b\n            var capabilities = McpSchema.ServerCapabilities.builder()\n                    .tools(true)\n                    .logging()\n                    .build();\n\n            // \u521b\u5efaMcpServer\u5e76\u5b58\u50a8\n            McpAsyncServer server = McpServer\n                    .async(compositeTransport)\n                    .serverInfo("MCP Shenyu Server (Multi-Protocol)", "1.0.0")\n                    .capabilities(capabilities)\n                    .tools(Lists.newArrayList())\n                    .build();\n            \n            return server;\n        });\n    }\n}\n')),(0,t.yg)("h4",{id:"12-tools\u6ce8\u518c"},"1.2 Tools\u6ce8\u518c"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"handlerRule()")," \u65b9\u6cd5 \u5de5\u4f5c\u5185\u5bb9\u5982\u4e0b")),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"\u6355\u6349\u7528\u6237\u5728 Tool \u4e0a\u7684\u586b\u5199\u7684 tool \u914d\u7f6e\u4fe1\u606f\uff0c\u8fd9\u4e9b\u4fe1\u606f\u5c06\u5168\u90e8\u7528\u4e8e tool \u7684\u6784\u5efa"),(0,t.yg)("li",{parentName:"ol"},"\u5e8f\u5217\u5316\u521b\u5efa ",(0,t.yg)("inlineCode",{parentName:"li"},"ShenyuMcpServerTool")," \u83b7\u53d6 tool \u4fe1\u606f")),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u6ce8\u610f ",(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuMcpServerTool")," \u4e5f\u662f Shenyu \u5b58\u50a8 tool \u4fe1\u606f\u7684\u5de5\u5177\uff0c\u548c ",(0,t.yg)("inlineCode",{parentName:"p"},"McpServerTool")," \u6ca1\u6709\u7ee7\u627f\u5173\u7cfb")),(0,t.yg)("ol",{start:3},(0,t.yg)("li",{parentName:"ol"},"\u8c03\u7528 ",(0,t.yg)("inlineCode",{parentName:"li"},"addTool()")," \u65b9\u6cd5\uff0c \u5229\u7528\u8be5 tool \u4fe1\u606f\u521b\u5efa tool\uff0c\u5e76\u6839\u636e SelectorId \u5c06 tool \u6ce8\u518c\u5230\u4e0e\u4e4b\u5339\u914d\u7684 McpServer \u4e2d")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class McpServerPluginDataHandler implements PluginDataHandler {\n    @Override\n    public void handlerRule(final RuleData ruleData) {\n        Optional.ofNullable(ruleData.getHandle()).ifPresent(s -> {\n            // \u5e8f\u5217\u5316\u4e00\u4e2a\u65b0\u7684 ShenyuMcpServerTool\n            ShenyuMcpServerTool mcpServerTool = GsonUtils.getInstance().fromJson(s, ShenyuMcpServerTool.class);\n            // \u7f13\u5b58mcpServerTool\n            CACHED_TOOL.get().cachedHandle(CacheKeyUtils.INST.getKey(ruleData), mcpServerTool);\n            // \u83b7\u53d6\u5e76\u6784\u5efa mcp schema\n            List<McpServerToolParameter> parameters = mcpServerTool.getParameters();\n            String inputSchema = JsonSchemaUtil.createParameterSchema(parameters);\n            ShenyuMcpServer server = CACHED_SERVER.get().obtainHandle(ruleData.getSelectorId());\n            if (Objects.nonNull(server)) {\n                // \u5411Manager\u7684sharedServerMap\u4e2d\u5b58\u50a8Tool\u4fe1\u606f\n                shenyuMcpServerManager.addTool(server.getPath(),\n                        StringUtils.isBlank(mcpServerTool.getName()) ? ruleData.getName()\n                                : mcpServerTool.getName(),\n                        mcpServerTool.getDescription(),\n                        mcpServerTool.getRequestConfig(),\n                        inputSchema);\n            }\n        });\n    }\n}\n")),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"addTool()"),"\u65b9\u6cd5",(0,t.yg)("blockquote",{parentName:"li"},(0,t.yg)("p",{parentName:"blockquote"},"\u8be5\u65b9\u6cd5\u88ab ",(0,t.yg)("inlineCode",{parentName:"p"},"handlerRule()")," \u65b9\u6cd5\u8c03\u7528\uff0c\u7528\u4e8e\u65b0\u589e\u5de5\u5177")))),(0,t.yg)("p",null,"\u8be5\u65b9\u6cd5\u505a\u4e86\u4e0b\u8ff0\u5de5\u4f5c"),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},"\u5c06\u4e0a\u4e00\u6b65\u4f20\u6765\u7684 tool \u4fe1\u606f\u8f6c\u6362\u4e3a ",(0,t.yg)("inlineCode",{parentName:"p"},"shenyuToolDefinition")," \u5bf9\u8c61")),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},"\u5229\u7528\u8f6c\u6362\u6765\u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"shenyuToolDefinition")," \u5bf9\u8c61\u521b\u5efa ",(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuToolCallback")," \u5bf9\u8c61"),(0,t.yg)("blockquote",{parentName:"li"},(0,t.yg)("p",{parentName:"blockquote"},(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuToolCallback")," \u91cd\u5199\u4e86 ",(0,t.yg)("inlineCode",{parentName:"p"},"ToolCallBack")," \u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"call()")," \u65b9\u6cd5\uff0c\u5e76\u5c06\u8be5 ",(0,t.yg)("inlineCode",{parentName:"p"},"call()")," \u65b9\u6cd5\u6ce8\u518c\u5230\u4e86 ",(0,t.yg)("inlineCode",{parentName:"p"},"AsyncToolSpecification")," \u4e2d\uff0c\n\u6b64\u540e\u8c03\u7528 tool \u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"call()")," \u65b9\u6cd5\uff0c\u5219\u5b9e\u9645\u4f1a\u8c03\u7528\u8fd9\u4e2a\u91cd\u5199\u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"call()")," \u65b9\u6cd5"))),(0,t.yg)("li",{parentName:"ol"},(0,t.yg)("p",{parentName:"li"},"\u5c06 ",(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuToolCallback")," \u8f6c\u6362\u4e3a ",(0,t.yg)("inlineCode",{parentName:"p"},"AsyncToolSpecification")," \u5e76\u6ce8\u518c\u5230\u76f8\u5173\u7684 mcpServer \u4e2d"))),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class McpServerPluginDataHandler implements PluginDataHandler {\n    public void addTool(final String serverPath, final String name, final String description,\n                        final String requestTemplate, final String inputSchema) {\n        String normalizedPath = normalizeServerPath(serverPath);\n        // \u6784\u5efaDefinition\u5bf9\u8c61\n        ToolDefinition shenyuToolDefinition = ShenyuToolDefinition.builder()\n                .name(name)\n                .description(description)\n                .requestConfig(requestTemplate)\n                .inputSchema(inputSchema)\n                .build();\n        \n        ShenyuToolCallback shenyuToolCallback = new ShenyuToolCallback(shenyuToolDefinition);\n\n        // \u83b7\u53d6\u5230\u5148\u524d\u6ce8\u518c\u7684 McpServer\uff0c \u5e76\u5411\u5176\u4e2d\u6ce8\u518cTool\n        McpAsyncServer sharedServer = sharedServerMap.get(normalizedPath);\n        for (AsyncToolSpecification asyncToolSpecification : McpToolUtils.toAsyncToolSpecifications(shenyuToolCallback)) {\n            sharedServer.addTool(asyncToolSpecification).block();\n        }        \n    }\n}\n")),(0,t.yg)("p",null,"\u5230\u6b64\u4e3a\u6b62\uff0c\u670d\u52a1\u6ce8\u518c\u5206\u6790\u5b8c\u6bd5"),(0,t.yg)("p",null,"\u670d\u52a1\u6ce8\u518c\u4e00\u56fe\u89c8\n",(0,t.yg)("img",{src:r(81555).A})),(0,t.yg)("h3",{id:"2-\u63d2\u4ef6\u8c03\u7528"},"2. \u63d2\u4ef6\u8c03\u7528"),(0,t.yg)("p",null,"\u5ba2\u6237\u7aef\u5148\u540e\u4f1a\u53d1\u9001\u540e\u7f00\u4e3a ",(0,t.yg)("inlineCode",{parentName:"p"},"/sse")," \u548c ",(0,t.yg)("inlineCode",{parentName:"p"},"/message")," \u7684\u4e24\u79cd\u6d88\u606f\uff0c\u8fd9\u4e24\u79cd\u6d88\u606f\u90fd\u4f1a\u88ab ",(0,t.yg)("inlineCode",{parentName:"p"},"Shenyu McpServer plugin")," \u6355\u6349\uff0c",(0,t.yg)("inlineCode",{parentName:"p"},"Shenyu McpServer plugin"),"\n\u4f1a\u5bf9 ",(0,t.yg)("inlineCode",{parentName:"p"},"/sse")," \u6d88\u606f\u548c ",(0,t.yg)("inlineCode",{parentName:"p"},"/message")," \u6d88\u606f\u505a\u4e0d\u540c\u5904\u7406\u3002\u6536\u5230 ",(0,t.yg)("inlineCode",{parentName:"p"},"/sse")," \u6d88\u606f\u65f6 plugin \u4f1a\u521b\u5efa session \u5bf9\u8c61\u5e76\u4fdd\u5b58\uff0c\u6700\u540e\u8fd4\u56de session id\n\u4f9b message \u6d88\u606f\u4f7f\u7528\u3002\u6536\u5230 ",(0,t.yg)("inlineCode",{parentName:"p"},"/message")," \u6d88\u606f\u65f6\uff0c\u4f1a\u6839\u636e ",(0,t.yg)("inlineCode",{parentName:"p"},"/message")," \u6d88\u606f\u643a\u5e26\u7684 method \u4fe1\u606f\uff0c\u9009\u62e9\u6267\u884c\u7684\u65b9\u6cd5\n\u5982\uff1a\u83b7\u53d6\u5de5\u4f5c\u5217\u8868\uff0c\u5de5\u5177\u8c03\u7528\uff0c\u83b7\u53d6\u8d44\u6e90\u5217\u8868\u7b49\u7b49"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"doExecute()")," \u65b9\u6cd5 \u5de5\u4f5c\u5185\u5bb9\u5982\u4e0b")),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"\u8def\u5f84\u5339\u914d\uff0c\u5224\u65ad mcp plugin \u662f\u5426\u6ce8\u518c\u8be5\u8def\u5f84"),(0,t.yg)("li",{parentName:"ol"},"\u8c03\u7528 ",(0,t.yg)("inlineCode",{parentName:"li"},"routeByProtocol()")," \u65b9\u6cd5\uff0c\u6839\u636e\u8bf7\u6c42\u534f\u8bae\u9009\u62e9\u5408\u9002\u7684\u5904\u7406\u65b9\u6848")),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u672c\u7bc7\u662f\u5bf9 sse \u8bf7\u6c42\u65b9\u5f0f\u7684\u89e3\u6790\uff0c\u56e0\u6b64\u63a5\u7740\u8fdb\u5165 ",(0,t.yg)("inlineCode",{parentName:"p"},"handleSseRequest()")," \u65b9\u6cd5")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class McpServerPlugin extends AbstractShenyuPlugin {\n    @Override\n    protected Mono<Void> doExecute(final ServerWebExchange exchange,\n                                   final ShenyuPluginChain chain,\n                                   final SelectorData selector,\n                                   final RuleData rule) {\n        final String uri = exchange.getRequest().getURI().getRawPath();\n        // \u5224\u65ad Mcp \u63d2\u4ef6\u662f\u5426\u6ce8\u518c\u4e86\u8be5\u8def\u7531\u89c4\u5219\uff0c\u6ca1\u6709\u5219\u4e0d\u6267\u884c\n        if (!shenyuMcpServerManager.canRoute(uri)) {\n            return chain.execute(exchange);\n        }\n        final ServerRequest request = ServerRequest.create(exchange, messageReaders);\n        // \u6839\u636e uri \u5224\u65ad\u8def\u7531\u534f\u8bae\uff0c\u9009\u62e9\u5bf9\u5e94\u7684\u5904\u7406\u65b9\u6848\n        return routeByProtocol(exchange, chain, request, selector, uri);\n    }\n\n    private Mono<Void> routeByProtocol(final ServerWebExchange exchange,\n                                       final ShenyuPluginChain chain,\n                                       final ServerRequest request,\n                                       final SelectorData selector,\n                                       final String uri) {\n\n        if (isStreamableHttpProtocol(uri)) {\n            return handleStreamableHttpRequest(exchange, chain, request, uri);\n        } else if (isSseProtocol(uri)) {\n            // \u5904\u7406sse\u8bf7\u6c42\n            return handleSseRequest(exchange, chain, request, selector, uri);\n        } \n    }\n}\n")),(0,t.yg)("p",null,(0,t.yg)("inlineCode",{parentName:"p"},"handlerSseRequest()")," \u65b9\u6cd5"),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u8be5\u65b9\u6cd5\u7531 ",(0,t.yg)("inlineCode",{parentName:"p"},"routeByProtocol()")," \u65b9\u6cd5\u8c03\u7528\uff0c\u6839\u636e\u8bf7\u6c42\u540e\u7f00\u5224\u65ad\u5ba2\u6237\u7aef\u662f\u8981\u521b\u5efa session \u8fd8\u662f\u8c03\u7528\u5de5\u5177")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class McpServerPlugin extends AbstractShenyuPlugin {\n    private Mono<Void> handleSseRequest(final ServerWebExchange exchange,\n                                        final ShenyuPluginChain chain,\n                                        final ServerRequest request,\n                                        final SelectorData selector,\n                                        final String uri) {\n        ShenyuMcpServer server = McpServerPluginDataHandler.CACHED_SERVER.get().obtainHandle(selector.getId());\n        String messageEndpoint = server.getMessageEndpoint();\n        // \u83b7\u53d6\u4f20\u8f93\u8005\n        ShenyuSseServerTransportProvider transportProvider\n                = shenyuMcpServerManager.getOrCreateMcpServerTransport(uri, messageEndpoint);\n        // \u6839\u636e\u8bf7\u6c42\u7684\u540e\u7f00\u5224\u65ad\u662f sse \u8fde\u63a5\u8bf7\u6c42\u8fd8\u662f message \u8c03\u7528\u8bf7\u6c42\n        if (uri.endsWith(messageEndpoint)) {\n            setupSessionContext(exchange, chain);\n            return handleMessageEndpoint(exchange, transportProvider, request);\n        } else {\n            return handleSseEndpoint(exchange, transportProvider, request);\n        }\n    }\n}\n")),(0,t.yg)("h4",{id:"21-\u5ba2\u6237\u7aef\u53d1\u9001-sse-\u8bf7\u6c42"},"2.1 \u5ba2\u6237\u7aef\u53d1\u9001 sse \u8bf7\u6c42"),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u5982\u679c\u6211\u4eec\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u662f\u540e\u7f00\u4e3a ",(0,t.yg)("inlineCode",{parentName:"p"},"/sse")," \u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u5c06\u4f1a\u6267\u884c ",(0,t.yg)("inlineCode",{parentName:"p"},"handleSseEndpoint()")," \u65b9\u6cd5")),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"handleSseEndpoint()")," \u65b9\u6cd5\u4e3b\u8981\u505a\u4e86\u5982\u4e0b\u5de5\u4f5c")),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"\u914d\u7f6e sse \u8bf7\u6c42\u5934"),(0,t.yg)("li",{parentName:"ol"},"\u8c03\u7528 ",(0,t.yg)("inlineCode",{parentName:"li"},"ShenyuSseServerTransportProvider")," \u7684 ",(0,t.yg)("inlineCode",{parentName:"li"},"createSseFlux()")," \u521b\u5efa sse \u6d41")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class McpServerPlugin extends AbstractShenyuPlugin {\n    private Mono<Void> handleSseEndpoint(final ServerWebExchange exchange,\n                                         final ShenyuSseServerTransportProvider transportProvider,\n                                         final ServerRequest request) {\n        // \u914d\u7f6e sse \u8bf7\u6c42\u5934\n        configureSseHeaders(exchange);\n\n        // \u521b\u5efa sse \u6d41\n        return exchange.getResponse()\n                .writeWith(transportProvider\n                        .createSseFlux(request));\n    }\n}\n")),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"createSseFlux()")," \u65b9\u6cd5",(0,t.yg)("blockquote",{parentName:"li"},(0,t.yg)("p",{parentName:"blockquote"},"\u8be5\u65b9\u6cd5\u88ab ",(0,t.yg)("inlineCode",{parentName:"p"},"handleSseEndpoint()"),"\u8c03\u7528 \u4e3b\u8981\u7528\u4e8e\u521b\u5efa\u5e76\u4fdd\u5b58 session")))),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"\u521b\u5efa session \uff0c\u521b\u5efa session \u7684\u5de5\u5382\u5728\u521b\u5efa session \u65f6\u4f1a\u5c06\u4e00\u7cfb\u5217 handler \u6ce8\u518c\u5230 session \u4e2d\uff0c\u8fd9\u4e9b handler \u662f\u771f\u6b63\u6267\u884c\ncallTool \u7684\u5bf9\u8c61"),(0,t.yg)("li",{parentName:"ol"},"\u5c06 session \u4fdd\u5b58\uff0csession\u590d\u7528"),(0,t.yg)("li",{parentName:"ol"},"\u5c06 session id \u4f5c\u4e3a endpoint \u7684\u8bf7\u6c42\u53c2\u6570\u8fd4\u56de\u7ed9\u5ba2\u6237\u7aef\uff0c\u5728\u8c03\u7528 message \u65b9\u6cd5\u65f6\u4f1a\u4f7f\u7528\u8be5 endpoint")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},'public class ShenyuSseServerTransportProvider implements McpServerTransportProvider {\n    public Flux<ServerSentEvent<?>> createSseFlux(final ServerRequest request) {\n        return Flux.<ServerSentEvent<?>>create(sink -> {\n                    WebFluxMcpSessionTransport sessionTransport = new WebFluxMcpSessionTransport(sink);\n                    // \u521b\u5efa McpServerSession \u5e76\u6682\u5b58\u63d2\u4ef6\u94fe\u4fe1\u606f\n                    McpServerSession session = sessionFactory.create(sessionTransport);\n                    String sessionId = session.getId();\n                    sessions.put(sessionId, session);\n\n                    // \u5c06 session id\u7b49\u4fe1\u606f\u4f20\u9012\u56de\u5ba2\u6237\u7aef\n                    String endpointUrl = this.baseUrl + this.messageEndpoint + "?sessionId=" + sessionId;\n                    ServerSentEvent<String> endpointEvent = ServerSentEvent.<String>builder()\n                            .event(ENDPOINT_EVENT_TYPE)\n                            .data(endpointUrl)\n                            .build();\n                }).doOnSubscribe(subscription -> LOGGER.info("SSE Flux subscribed"))\n                .doOnRequest(n -> LOGGER.debug("SSE Flux requested {} items", n));\n    }\n}\n')),(0,t.yg)("h4",{id:"22-\u5ba2\u6237\u7aef\u53d1\u9001-message-\u8bf7\u6c42"},"2.2 \u5ba2\u6237\u7aef\u53d1\u9001 message \u8bf7\u6c42"),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u5982\u679c\u6211\u4eec\u5ba2\u6237\u7aef\u53d1\u9001\u7684\u662f\u540e\u7f00\u4e3a ",(0,t.yg)("inlineCode",{parentName:"p"},"/message")," \u7684\u8bf7\u6c42\uff0c\u90a3\u4e48\u5c06\u4f1a\u6267\u884c \u628a\u5f53\u524d ",(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuPluginChain")," \u4fe1\u606f\u5b58\u5165 session \u4e2d\uff0c\u5e76\u8c03\u7528 ",(0,t.yg)("inlineCode",{parentName:"p"},"handleMessageEndpoint()")," \u65b9\u6cd5\uff0c\n\u540e\u7eed\u5de5\u5177\u8c03\u7528\u65f6\u4f1a\u7ee7\u7eed\u6267\u884c\u8be5\u63d2\u4ef6\u94fe\uff0c\u56e0\u6b64 mcp plugin \u540e\u7684\u63d2\u4ef6\u4f1a\u5bf9\u8fdb\u5165 tool \u7684\u8bf7\u6c42\u9020\u6210\u5f71\u54cd")),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"handleMessageEndpoint()")," \u65b9\u6cd5\uff0c\u8c03\u7528 ",(0,t.yg)("inlineCode",{parentName:"li"},"ShenyuSseServerTransportProvider")," \u7684 ",(0,t.yg)("inlineCode",{parentName:"li"},"handleMessageEndpoint()")," \u65b9\u6cd5")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre"},"if (uri.endsWith(messageEndpoint)) {\n       setupSessionContext(exchange, chain);\n       return handleMessageEndpoint(exchange, transportProvider, request);\n} \n")),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class McpServerPlugin extends AbstractShenyuPlugin {\n    private Mono<Void> handleMessageEndpoint(final ServerWebExchange exchange,\n                                             final ShenyuSseServerTransportProvider transportProvider,\n                                             final ServerRequest request) {\n        // \u5904\u7406message\u8bf7\u6c42\n        return transportProvider.handleMessageEndpoint(request)\n                .flatMap(result -> {\n                    return exchange.getResponse()\n                            .writeWith(Mono.just(exchange.getResponse().bufferFactory().wrap(responseBody.getBytes())));\n                });\n    }\n}\n")),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"handleMessageEndpoint()")," \u65b9\u6cd5",(0,t.yg)("blockquote",{parentName:"li"},(0,t.yg)("p",{parentName:"blockquote"},"\u8be5\u65b9\u6cd5\u7531 ",(0,t.yg)("inlineCode",{parentName:"p"},"McpServerPlugin.handleMessageEndpoint()")," \u8c03\u7528\uff0c\u5c06\u8bf7\u6c42\u4ea4\u7ed9 session \u5904\u7406")))),(0,t.yg)("p",null,"session \u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"handler()"),' \u65b9\u6cd5\u4f1a\u5bf9 message \u7684\u4e0d\u540c\uff0c\u800c\u8fdb\u884c\u5bf9\u5e94\u7684\u64cd\u4f5c\n\u4f8b\u5982 \uff1a \u5f53 message \u4e2d method \u662f "tools/call" \u65f6\uff0c\u5219\u4f1a\u4f7f\u7528\u5de5\u5177\u8c03\u7528\u7684 handler() \u6267\u884c ',(0,t.yg)("inlineCode",{parentName:"p"},"call()")," \u65b9\u6cd5\u8c03\u7528\u5de5\u5177\n\u76f8\u5173\u6e90\u7801\u5728\u6b64\u4e0d\u8fc7\u591a\u8d58\u8ff0"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},'public class ShenyuSseServerTransportProvider implements McpServerTransportProvider {\n    public Mono<MessageHandlingResult> handleMessageEndpoint(final ServerRequest request) {\n        // \u83b7\u53d6\u5230session\n        String sessionId = request.queryParam("sessionId").get();\n        McpServerSession session = sessions.get(sessionId);\n        return request.bodyToMono(String.class)\n                .flatMap(body -> {\n                    McpSchema.JSONRPCMessage message = McpSchema.deserializeJsonRpcMessage(objectMapper, body);\n                    return session.handle(message);\n                });\n    }\n}\n')),(0,t.yg)("p",null,"\u81f3\u6b64 ",(0,t.yg)("inlineCode",{parentName:"p"},"Shenyu Mcp Plugin")," \u670d\u52a1\u8c03\u7528\u6e90\u7801\u5206\u6790\u5b8c\u6bd5"),(0,t.yg)("p",null,"\u6d41\u7a0b\u56fe\u4e00\u89c8\n",(0,t.yg)("img",{src:r(6113).A})),(0,t.yg)("h3",{id:"3-\u5de5\u5177\u8c03\u7528"},"3. \u5de5\u5177\u8c03\u7528"),(0,t.yg)("blockquote",null,(0,t.yg)("p",{parentName:"blockquote"},"\u5982\u679c\u5ba2\u6237\u7aef\u4f20\u9012\u7684\u6d88\u606f\u662f\u8c03\u7528\u5de5\u5177\u7684\u6d88\u606f\uff0c\u90a3\u4e48 session \u5c06\u4f7f\u7528\u5de5\u5177\u8c03\u7528\u7684 handler() \u5e76\u6267\u884c tool \u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"call()")," \u65b9\u6cd5\uff0c\n\u5728\u670d\u52a1\u6ce8\u518c\u4e2d\uff0c\u6211\u4eec\u8bf4\u660e\u4e86 tool \u5728\u88ab\u8c03\u7528\u65f6\uff0c\u5b9e\u9645\u6267\u884c\u7684\u662f ",(0,t.yg)("inlineCode",{parentName:"p"},"ShenyuToolCallback()")," \u7684 ",(0,t.yg)("inlineCode",{parentName:"p"},"call()")," \u65b9\u6cd5")),(0,t.yg)("p",null,"\u56e0\u6b64\u6267\u884c\u5de5\u5177\u8c03\u7528\u65f6\u4f1a\u6267\u884c\u4ee5\u4e0b\u65b9\u6cd5"),(0,t.yg)("ul",null,(0,t.yg)("li",{parentName:"ul"},(0,t.yg)("inlineCode",{parentName:"li"},"call()")," \u4e3b\u8981\u5de5\u4f5c\u5185\u5bb9\u5982\u4e0b")),(0,t.yg)("ol",null,(0,t.yg)("li",{parentName:"ol"},"\u83b7\u53d6 session id"),(0,t.yg)("li",{parentName:"ol"},"\u83b7\u53d6 ",(0,t.yg)("inlineCode",{parentName:"li"},"requestTemplate")," \u5373 shenyu \u63d0\u4f9b\u7684\u989d\u5916\u529f\u80fd\u7684\u914d\u7f6e\u4fe1\u606f"),(0,t.yg)("li",{parentName:"ol"},"\u83b7\u53d6\u4e0a\u4e00\u6b65\u6682\u5b58\u7684 shenyu \u63d2\u4ef6\u94fe\uff0c\u5e76\u5c06\u5de5\u5177\u8c03\u7528\u7684\u4fe1\u606f\u4ea4\u7ed9\u63d2\u4ef6\u94fe\u7ee7\u7eed\u6267\u884c"),(0,t.yg)("li",{parentName:"ol"},"\u5f02\u6b65\u7b49\u5f85\u5de5\u5177\u54cd\u5e94")),(0,t.yg)("p",null,"\u63d2\u4ef6\u94fe\u6267\u884c\u5b8c\u6210\u540e\uff0c\u4f1a\u5c06\u8c03\u7528 tool \u8bf7\u6c42\u771f\u6b63\u7684\u53d1\u9001\u5230 tool \u6240\u5728\u7684\u670d\u52a1\u4e4b\u4e2d"),(0,t.yg)("pre",null,(0,t.yg)("code",{parentName:"pre",className:"language-java"},"public class ShenyuToolCallback implements ToolCallback {\n    @NonNull\n    @Override\n    public String call(@NonNull final String input, final ToolContext toolContext) {\n        // \u4ece mcp \u8bf7\u6c42\u4e2d\u63d0\u53d6 sessionId\n        final McpSyncServerExchange mcpExchange = extractMcpExchange(toolContext);\n        final String sessionId = extractSessionId(mcpExchange);\n        // \u63d0\u53d6requestTemplate\u4fe1\u606f\n        final String configStr = extractRequestConfig(shenyuTool);\n\n        // \u5229\u7528sessionId \u83b7\u53d6\u5230\u5148\u524d\u6682\u5b58\u7684\u63d2\u4ef6\u6267\u884c\u94fe\n        final ServerWebExchange originExchange = getOriginExchange(sessionId);\n        final ShenyuPluginChain chain = getPluginChain(originExchange);\n\n        // \u6267\u884c\u5de5\u5177\u8c03\u7528\n        return executeToolCall(originExchange, chain, sessionId, configStr, input);\n\n    }\n\n    private String executeToolCall(final ServerWebExchange originExchange,\n                                   final ShenyuPluginChain chain,\n                                   final String sessionId,\n                                   final String configStr,\n                                   final String input) {\n\n        final CompletableFuture<String> responseFuture = new CompletableFuture<>();\n        final ServerWebExchange decoratedExchange = buildDecoratedExchange(\n                originExchange, responseFuture, sessionId, configStr, input);\n        // \u6267\u884c\u63d2\u4ef6\u94fe\uff0c\u8c03\u7528\u5b9e\u9645\u5de5\u5177\n        chain.execute(decoratedExchange)\n                .subscribe();\n\n        // \u7b49\u5f85\u54cd\u5e94\n        final String result = responseFuture.get(DEFAULT_TIMEOUT_SECONDS, TimeUnit.SECONDS);\n        return result;\n\n    }\n}\n")),(0,t.yg)("p",null,"\u81f3\u6b64Shenyu MCP Plugin \u5de5\u5177\u8c03\u7528\u5206\u6790\u5b8c\u6bd5"),(0,t.yg)("p",null,(0,t.yg)("img",{src:r(71115).A})),(0,t.yg)("hr",null),(0,t.yg)("h3",{id:"4-\u5c0f\u7ed3"},"4. \u5c0f\u7ed3"),(0,t.yg)("p",null,"\u672c\u6587\u6e90\u7801\u5206\u6790\u4ece mcp \u670d\u52a1\u6ce8\u518c\u5f00\u59cb\uff0c\u5230 mcp \u63d2\u4ef6\u7684\u670d\u52a1\u8c03\u7528\uff0c\u518d\u5230 tool \u7684\u8c03\u7528\u3002\nmcpServer \u63d2\u4ef6\u8ba9 shenyu \u6210\u4e3a\u4e00\u4e2a\u529f\u80fd\u5f3a\u5927\uff0c\u96c6\u4e2d\u7ba1\u7406\u7684 mcpServer\u3002"),(0,t.yg)("hr",null))}c.isMDXComponent=!0},71115:(e,n,r)=>{r.d(n,{A:()=>a});const a="data:image/png;base64,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"},81555:(e,n,r)=>{r.d(n,{A:()=>a});const a=r.p+"assets/images/Mcp-server-register-zh-87a3e3bf2133de216e36e9609dcd5aad.png"}}]);