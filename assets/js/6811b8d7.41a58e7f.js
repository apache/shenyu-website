"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[21934],{25277:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/plugin_config_en-bdb93d3db24b39ce654594ab25e41d0e.png"},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var s=i(96540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}},38743:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/metadata_config_en-55b4de23e1b38626a9b401003ae6c018.png"},39725:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var s=i(74848),l=i(28453);const r={title:"Tars Plugin",keywords:["Tars"],description:"Tars Plugin"},t="1. Overview",c={id:"plugin-center/proxy/tars-plugin",title:"Tars Plugin",description:"Tars Plugin",source:"@site/docs/plugin-center/proxy/tars-plugin.md",sourceDirName:"plugin-center/proxy",slug:"/plugin-center/proxy/tars-plugin",permalink:"/docs/next/plugin-center/proxy/tars-plugin",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/shenyu-website/edit/main/docs/plugin-center/proxy/tars-plugin.md",tags:[],version:"current",frontMatter:{title:"Tars Plugin",keywords:["Tars"],description:"Tars Plugin"},sidebar:"tutorialSidebar",previous:{title:"Spring Cloud Plugin",permalink:"/docs/next/plugin-center/proxy/spring-cloud-plugin"},next:{title:"Tcp Plugin",permalink:"/docs/next/plugin-center/proxy/tcp-plugin"}},a={},o=[{value:"1.1 Plugin name",id:"11-plugin-name",level:2},{value:"1.2 Appropriate scenario",id:"12-appropriate-scenario",level:2},{value:"1.3 Plugin functionality",id:"13-plugin-functionality",level:2},{value:"1.4 Plugin code",id:"14-plugin-code",level:2},{value:"1.5 Added since which shenyu version",id:"15-added-since-which-shenyu-version",level:2},{value:"2.1 Plugin-use procedure chart",id:"21-plugin-use-procedure-chart",level:2},{value:"2.2 Import pom",id:"22-import-pom",level:2},{value:"2.3 Configure in the client project",id:"23-configure-in-the-client-project",level:2},{value:"2.4 Enable plugin",id:"24-enable-plugin",level:2},{value:"2.5 Config plugin",id:"25-config-plugin",level:2},{value:"2.5.1 Config plugin",id:"251-config-plugin",level:3},{value:"2.5.2 Selector config",id:"252-selector-config",level:3},{value:"2.5.3 Rule Config",id:"253-rule-config",level:3},{value:"2.5.4 Metadata config",id:"254-metadata-config",level:3},{value:"2.6 Examples",id:"26-examples",level:2},{value:"2.6.1 Using ShenYu to access the Tars service",id:"261-using-shenyu-to-access-the-tars-service",level:3},{value:"2.6.1.1 Preparation",id:"2611-preparation",level:4},{value:"2.6.1.2 Plugin Config",id:"2612-plugin-config",level:4},{value:"2.6.2.6 Request service and check result",id:"2626-request-service-and-check-result",level:4}];function d(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"1-overview",children:"1. Overview"}),"\n",(0,s.jsx)(n.h2,{id:"11-plugin-name",children:"1.1 Plugin name"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Tars plugin"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"12-appropriate-scenario",children:"1.2 Appropriate scenario"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Protocol conversion, a plugin that converts http protocol requests into the Tars framework protocol"}),"\n",(0,s.jsx)(n.li,{children:"Service Load Balancing."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"13-plugin-functionality",children:"1.3 Plugin functionality"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Converting http protocol requests to Tars framework protocol."}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"14-plugin-code",children:"1.4 Plugin code"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Core Module ",(0,s.jsx)(n.code,{children:"shenyu-plugin-tars"})]}),"\n",(0,s.jsxs)(n.li,{children:["Core Class ",(0,s.jsx)(n.code,{children:"org.apache.shenyu.plugin.tars.TarsPlugin"})]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"15-added-since-which-shenyu-version",children:"1.5 Added since which shenyu version"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"2.3.0"}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"2-how-to-use-plugin",children:"2. How to use plugin"}),"\n",(0,s.jsx)(n.h2,{id:"21-plugin-use-procedure-chart",children:"2.1 Plugin-use procedure chart"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"image-20221206221707914",src:i(85196).A+"",width:"166",height:"426"})}),"\n",(0,s.jsx)(n.h2,{id:"22-import-pom",children:"2.2 Import pom"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"        <dependency>\n            <groupId>org.apache.shenyu</groupId>\n            <artifactId>shenyu-spring-boot-starter-client-tars</artifactId>\n            <version>${shenyu.version}</version>\n        </dependency>\n"})}),"\n",(0,s.jsx)(n.h2,{id:"23-configure-in-the-client-project",children:"2.3 Configure in the client project"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsx)(n.li,{children:"Configure the Tars configuration in application.yml."}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"shenyu:\n  register:\n    registerType: http #zookeeper #etcd #nacos #consul\n    serverLists: http://localhost:9095 #localhost:2181 #http://localhost:2379 #localhost:8848\n    props:\n      username: admin\n      password: 123456\n  client:\n    tars:\n      props:\n        contextPath: /tars\n        appName: tars\n        port: 21715\n        host: 192.168.41.103 # client IP\n"})}),"\n",(0,s.jsxs)(n.ol,{start:"2",children:["\n",(0,s.jsxs)(n.li,{children:["Add the ",(0,s.jsx)(n.code,{children:"@ShenyuTarsService"})," and ",(0,s.jsx)(n.code,{children:"@ShenyuTarsClient"})," and  annotation to the interface."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@TarsServant("HelloObj")\n@ShenyuTarsService(serviceName = "ShenyuExampleServer.ShenyuExampleApp.HelloObj")\npublic class HelloServantImpl implements HelloServant {\n  \n    @Override\n    @ShenyuTarsClient("/hello")\n    public String hello(final int no, final String name) {\n        return String.format("hello no=%s, name=%s, time=%s", no, name, System.currentTimeMillis());\n    }\n}\n'})}),"\n",(0,s.jsx)(n.h2,{id:"24-enable-plugin",children:"2.4 Enable plugin"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In shenyu-admin --\x3e BasicConfig --\x3e Plugin --\x3e ",(0,s.jsx)(n.code,{children:"tars"})," set Status enabled."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"enable_tars_en",src:i(57583).A+"",width:"1914",height:"972"})}),"\n",(0,s.jsx)(n.h2,{id:"25-config-plugin",children:"2.5 Config plugin"}),"\n",(0,s.jsx)(n.h3,{id:"251-config-plugin",children:"2.5.1 Config plugin"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"plugin_config_en",src:i(25277).A+"",width:"1917",height:"973"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"multiSelectorHandle"}),"\uff1aSet to enable multiple selector processing, multiple selector processing services can be configured in the selector list."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"multiRuleHandle"}),"\uff1aSet to multiple rules processing, configure multiple processing rules in the rule list, it is recommended to configure as single rule."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"threadpool"}),"\uff1aThere are five types of business thread pools: ",(0,s.jsx)(n.code,{children:"fixed"}),", ",(0,s.jsx)(n.code,{children:"eager"}),", ",(0,s.jsx)(n.code,{children:"cached"}),", ",(0,s.jsx)(n.code,{children:"limited"})," and ",(0,s.jsx)(n.code,{children:"shared"}),". The first 4 types correspond to the thread pools officially provided by dubbo. Let's talk about ",(0,s.jsx)(n.code,{children:"shared"}),", as its name implies, ",(0,s.jsx)(n.code,{children:"all proxy plugins"})," share a ",(0,s.jsx)(n.code,{children:"shared"})," thread pool, the advantage of this is that it can reduce the number of thread pools, thereby reducing memory and improving resource utilization."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"corethreads"}),"\uff1aThe number of core threads in the business thread pool."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"threads"}),"\uff1aThe maximum number of threads in the business thread pool."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"queues"}),"\uff1aThe length of the blocking queue of the business thread pool, 0 means ",(0,s.jsx)(n.code,{children:"unbounded blocking queue"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"252-selector-config",children:"2.5.2 Selector config"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"Flow needs to be matched by selector."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"selector_config_en",src:i(68087).A+"",width:"1913",height:"969"})}),"\n",(0,s.jsxs)(n.p,{children:["Automatically configure the selectors with the ",(0,s.jsx)(n.code,{children:"@ShenyuTarsClient"})," annotation."]}),"\n",(0,s.jsx)(n.h3,{id:"253-rule-config",children:"2.5.3 Rule Config"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsx)(n.p,{children:"After the traffic has been successfully matched by the selector, it will enter the rules for the final traffic matching."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"rule_config_en",src:i(83526).A+"",width:"1917",height:"975"})}),"\n",(0,s.jsxs)(n.p,{children:["Automatically configure the rules with the ",(0,s.jsx)(n.code,{children:"@ShenyuTarsClient"})," annotation."]}),"\n",(0,s.jsx)(n.h3,{id:"254-metadata-config",children:"2.5.4 Metadata config"}),"\n",(0,s.jsxs)(n.blockquote,{children:["\n",(0,s.jsxs)(n.p,{children:["When the ",(0,s.jsx)(n.code,{children:"Tars"})," application client accesses the ",(0,s.jsx)(n.code,{children:"Apache ShenYu"})," gateway, it will be automatically registered, and can be viewed in the ",(0,s.jsx)(n.code,{children:"shenyu-admin"})," backend management system's basic configuration ",(0,s.jsx)(n.code,{children:"--\x3e"})," metadata management, each ",(0,s.jsx)(n.code,{children:"Tars"})," interface method, will correspond to a metadata."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"metadata_config_en",src:i(38743).A+"",width:"1917",height:"974"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"AppName: specifies the name of the application to which the metadata belongs."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"MethodName: the name of the method to call."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Path: http request path."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"PathDescribe: the description of the path is easy to view."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"ParamsType: the parameters are separated by commas (,) in the order of interface parameter types."}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["RpcExpand: other configurations of the ",(0,s.jsx)(n.code,{children:"Tars"})," interface, which support the ",(0,s.jsx)(n.code,{children:"JSON"})," format."]}),"\n",(0,s.jsxs)(n.p,{children:["examples\uff1a",(0,s.jsx)(n.code,{children:'{"loadbalance":"hash","retries":3,"timeout":-1}'})]}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"loadbalance"}),"\uff1aLoad balancing policy, currently supports roundRobin, random and hash."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"retries"}),"\uff1aNumber of retries to call client timeout failures."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"timeout"}),"\uff1aCalling the client's timeout time."]}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Interface: The fully qualified class name of the ",(0,s.jsx)(n.code,{children:"Tars"})," interface."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["RpcType\uff1aAuto-registration defaults to ",(0,s.jsx)(n.code,{children:"Tars"}),"."]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"26-examples",children:"2.6 Examples"}),"\n",(0,s.jsx)(n.h3,{id:"261-using-shenyu-to-access-the-tars-service",children:"2.6.1 Using ShenYu to access the Tars service"}),"\n",(0,s.jsx)(n.h4,{id:"2611-preparation",children:"2.6.1.1 Preparation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Start ",(0,s.jsx)(n.code,{children:"ShenYu Admin"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Start ",(0,s.jsx)(n.code,{children:"Shenyu Bootstrap"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"2612-plugin-config",children:"2.6.1.2 Plugin Config"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In shenyu-admin --\x3e BasicConfig --\x3e Plugin --\x3e ",(0,s.jsx)(n.code,{children:"tars"})," set Status enabled, And adjust the registry configuration as needed."]}),"\n",(0,s.jsxs)(n.li,{children:["Adjust to the actual situation ",(0,s.jsx)(n.a,{href:"https://github.com/apache/shenyu/tree/master/shenyu-examples/shenyu-examples-tars",children:"shenyu-examples-tars"})," application.yml configuration in the project and start it."]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"2626-request-service-and-check-result",children:"2.6.2.6 Request service and check result"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"check_request_zh",src:i(92254).A+"",width:"2590",height:"1526"})}),"\n",(0,s.jsx)(n.h1,{id:"3-how-to-disable-plugin",children:"3. How to disable plugin"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In ",(0,s.jsx)(n.code,{children:"shenyu-admin"})," --\x3e BasicConfig --\x3e Plugin --\x3e ",(0,s.jsx)(n.code,{children:"tars"})," set Status disable."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{alt:"close_tars_en",src:i(81150).A+"",width:"1917",height:"975"})})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},57583:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/enable_tars_en-adbf5589ad2bbb3d15136b87ddc0398c.png"},68087:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/selector_config_en-480ebdaf7d31b5e65c74225ba58424a3.png"},81150:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/close_tars_en-17311011e6bc29d7156f65ec9073e859.png"},83526:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/rule_config_en-f235fadf861a283cb385c641139ab56a.png"},85196:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/produce_chart_en-2efaa216b9aca95860902c4e62dac10e.png"},92254:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/check_request_zh-bbfa76e720e865629981ab1e65739eeb.png"}}]);