"use strict";(globalThis.webpackChunkshenyu_website=globalThis.webpackChunkshenyu_website||[]).push([[17715],{26956:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>d,contentTitle:()=>t,default:()=>a,frontMatter:()=>r,metadata:()=>c,toc:()=>o});var s=i(74848),l=i(28453);const r={title:"Hystrix Plugin",keywords:["Hystrix"],description:"hystrix plugin"},t="1. Overview",c={id:"plugin-center/fault-tolerance/hystrix-plugin",title:"Hystrix Plugin",description:"hystrix plugin",source:"@site/versioned_docs/version-2.5.1/plugin-center/fault-tolerance/hystrix-plugin.md",sourceDirName:"plugin-center/fault-tolerance",slug:"/plugin-center/fault-tolerance/hystrix-plugin",permalink:"/docs/2.5.1/plugin-center/fault-tolerance/hystrix-plugin",draft:!1,unlisted:!1,editUrl:"https://github.com/apache/shenyu-website/edit/main/versioned_docs/version-2.5.1/plugin-center/fault-tolerance/hystrix-plugin.md",tags:[],version:"2.5.1",frontMatter:{title:"Hystrix Plugin",keywords:["Hystrix"],description:"hystrix plugin"},sidebar:"tutorialSidebar",previous:{title:"Websocket Plugin",permalink:"/docs/2.5.1/plugin-center/proxy/websocket-plugin"},next:{title:"RateLimiter Plugin",permalink:"/docs/2.5.1/plugin-center/fault-tolerance/rate-limiter-plugin"}},d={},o=[{value:"1.1 Plugin Name",id:"11-plugin-name",level:2},{value:"1.2 Appropriate Scenario",id:"12-appropriate-scenario",level:2},{value:"1.3 Plugin functionality",id:"13-plugin-functionality",level:2},{value:"1.4 Plugin code",id:"14-plugin-code",level:2},{value:"1.5 Added Since Which shenyu version",id:"15-added-since-which-shenyu-version",level:2},{value:"2.1 Plugin-use procedure chart",id:"21-plugin-use-procedure-chart",level:2},{value:"2.2 Import pom",id:"22-import-pom",level:2},{value:"2.3 Enable plugin",id:"23-enable-plugin",level:2},{value:"2.4 Config plugin",id:"24-config-plugin",level:2},{value:"2.4.1 Plugin Config",id:"241-plugin-config",level:3},{value:"2.4.2 Selector Config",id:"242-selector-config",level:3},{value:"2.4.3 Rule Config",id:"243-rule-config",level:3},{value:"2.5 Examples",id:"25-examples",level:2},{value:"2.5.1 use hystrix protect application",id:"251-use-hystrix-protect-application",level:3},{value:"2.5.1.1 Preparation",id:"2511-preparation",level:4},{value:"2.5.1.2 Selector Config",id:"2512-selector-config",level:4},{value:"2.5.1.3 Rule Config",id:"2513-rule-config",level:4},{value:"2.5.1.4 Send Request With <code>Apache Jmeter</code>",id:"2514-send-request-with-apache-jmeter",level:4},{value:"2.5.1.5 Check Result",id:"2515-check-result",level:4}];function h(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",img:"img",li:"li",p:"p",pre:"pre",ul:"ul",...(0,l.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.h1,{id:"1-overview",children:"1. Overview"}),"\n",(0,s.jsx)(n.h2,{id:"11-plugin-name",children:"1.1 Plugin Name"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Hystrix Plugin"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"12-appropriate-scenario",children:"1.2 Appropriate Scenario"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The backend service is unstable, use hystrix for protection"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"13-plugin-functionality",children:"1.3 Plugin functionality"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Fusing the flow"}),"\n",(0,s.jsx)(n.li,{children:"Protect the application behind ShenYu Gateway"}),"\n",(0,s.jsxs)(n.li,{children:["Isolation mode supports ",(0,s.jsx)(n.code,{children:"thread"})," and ",(0,s.jsx)(n.code,{children:"semaphore"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"14-plugin-code",children:"1.4 Plugin code"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Core Module: ",(0,s.jsx)(n.code,{children:"shenyu-plugin-hystrix"})]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:["Core Class: ",(0,s.jsx)(n.code,{children:"org.apache.shenyu.plugin.hystrix.HystrixPlugin"})]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"15-added-since-which-shenyu-version",children:"1.5 Added Since Which shenyu version"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Since ShenYu 2.4.0"}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"2-how-to-use-plugin",children:"2. How to use plugin"}),"\n",(0,s.jsx)(n.h2,{id:"21-plugin-use-procedure-chart",children:"2.1 Plugin-use procedure chart"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(36867).A+"",width:"343",height:"964"})}),"\n",(0,s.jsx)(n.h2,{id:"22-import-pom",children:"2.2 Import pom"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Add ",(0,s.jsx)(n.code,{children:"hystrix"})," dependency in the ",(0,s.jsx)(n.code,{children:"pom.xml"})," file of the gateway."]}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-xml",children:"\x3c!-- apache shenyu hystrix plugin start--\x3e\n<dependency>\n  <groupId>org.apache.shenyu</groupId>\n  <artifactId>shenyu-spring-boot-starter-plugin-hystrix</artifactId>\n  <version>${project.version}</version>\n</dependency>\n\x3c!-- apache shenyu hystrix plugin end--\x3e\n"})}),"\n",(0,s.jsx)(n.h2,{id:"23-enable-plugin",children:"2.3 Enable plugin"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In ",(0,s.jsx)(n.code,{children:"shenyu-admin"}),"--\x3e BasicConfig --\x3e Plugin --\x3e ",(0,s.jsx)(n.code,{children:"hystrix"})," set to enable."]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"24-config-plugin",children:"2.4 Config plugin"}),"\n",(0,s.jsx)(n.h3,{id:"241-plugin-config",children:"2.4.1 Plugin Config"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"No Config, but you should open hystrix plugin."}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"242-selector-config",children:"2.4.2 Selector Config"}),"\n",(0,s.jsx)(n.p,{children:"It is used to filter traffic for the first time and does not require handle fields."}),"\n",(0,s.jsxs)(n.p,{children:["For more information on selectors and rules configuration, see ",(0,s.jsx)(n.a,{href:"../../user-guide/admin-usage/selector-and-rule",children:"Selector And Rule Config"})," , only some of the fields are covered here."]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(88273).A+"",width:"2169",height:"1080"})}),"\n",(0,s.jsx)(n.h3,{id:"243-rule-config",children:"2.4.3 Rule Config"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["For the final filtering of traffic, there is a rule handler logic, isolation mode supports ",(0,s.jsx)(n.code,{children:"thread"})," and ",(0,s.jsx)(n.code,{children:"semaphore"}),"."]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(91318).A+"",width:"1511",height:"797"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"Hystrix handler details:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"MinimumRequests"}),": the minimum number of requests required to trigger a circuit breaker."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"ErrorThresholdPercentage"}),": percentage of exception occurring during that time."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"MaxConcurrentRequests"}),": max concurrent requests."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"Sleep"}),"(ms): The recovery time after the circuit breaker."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"GroupKey"}),": It is generally set to: ",(0,s.jsx)(n.code,{children:"contextPath"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"CallBackUrl"}),": default url ",(0,s.jsx)(n.code,{children:"/fallback/hystrix"}),"."]}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.code,{children:"CommandKey"}),": generally, it is set to a specific path interface."]}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"25-examples",children:"2.5 Examples"}),"\n",(0,s.jsx)(n.h3,{id:"251-use-hystrix-protect-application",children:"2.5.1 use hystrix protect application"}),"\n",(0,s.jsx)(n.h4,{id:"2511-preparation",children:"2.5.1.1 Preparation"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Start ShenYu Admin"}),"\n",(0,s.jsx)(n.li,{children:"Start ShenYu Bootstrap"}),"\n",(0,s.jsx)(n.li,{children:"Start a backend service"}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"2512-selector-config",children:"2.5.1.2 Selector Config"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(88273).A+"",width:"2169",height:"1080"})}),"\n",(0,s.jsx)(n.h4,{id:"2513-rule-config",children:"2.5.1.3 Rule Config"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"The rules in the pictures below are test examples, actual environment depends on the specific situation."}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(89367).A+"",width:"2256",height:"1195"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"test example"}),"\n"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-java",children:'@RestController\n@RequestMapping("/test")\n@ShenyuSpringMvcClient("/test/**")\npublic class HttpTestController {\n    @PostMapping("/testHystrix")\n    public ResultBean ok() {\n        Random random = new Random();\n        int num = random.nextInt(100);\n        if (num > 20) {\n            throw new RuntimeException();\n        }\n        return new ResultBean(200, "ok", null);\n    }\n}\n'})}),"\n",(0,s.jsxs)(n.h4,{id:"2514-send-request-with-apache-jmeter",children:["2.5.1.4 Send Request With ",(0,s.jsx)(n.code,{children:"Apache Jmeter"})]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(48984).A+"",width:"1767",height:"1167"})}),"\n",(0,s.jsx)(n.h4,{id:"2515-check-result",children:"2.5.1.5 Check Result"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.img,{src:i(54133).A+"",width:"1775",height:"1169"})}),"\n",(0,s.jsx)(n.h1,{id:"3-how-to-disable-plugin",children:"3. How to disable plugin"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["In ",(0,s.jsx)(n.code,{children:"shenyu-admin"})," --\x3e BasicConfig --\x3e Plugin --\x3e ",(0,s.jsx)(n.code,{children:"hystrix"})," set Status disable."]}),"\n"]})]})}function a(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},28453:(e,n,i)=>{i.d(n,{R:()=>t,x:()=>c});var s=i(96540);const l={},r=s.createContext(l);function t(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:t(e.components),s.createElement(r.Provider,{value:n},e.children)}},36867:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/plugin_use_en-8b5661551cdf92fdabc9cb2e7947cffc.jpg"},48984:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/hystrix-send-request-bdd87396a153240c2408c12f3e39d5f1.png"},54133:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/hystrix-result-008924e1e83b1489d3f0aaac4e4761df.png"},88273:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/selector_en-b44d5128003f1f2cc5f9cc6d0aee9a5f.png"},89367:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/hystrix-example-rule-en-061686d393c8d34e9cc3f61973513eda.png"},91318:(e,n,i)=>{i.d(n,{A:()=>s});const s=i.p+"assets/images/rule_en-e4b2b2b83e12da05d99784fd35e0d590.png"}}]);